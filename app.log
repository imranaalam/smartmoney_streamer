2024-10-12 23:21:05,707 - INFO - Initializing in-memory database for testing...
2024-10-12 23:21:05,710 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-12 23:21:05,710 - INFO - ---- Portfolio Management ----
2024-10-12 23:21:05,711 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-12 23:21:05,711 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-12 23:21:05,711 - INFO - Retrieved 1 portfolios from the database.
2024-10-12 23:21:05,711 - INFO - Existing Portfolios:
2024-10-12 23:21:05,711 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-12 23:21:05,712 - INFO - Portfolio ID '1' updated successfully.
2024-10-12 23:21:05,712 - INFO - Portfolio ID '1' updated successfully.
2024-10-12 23:21:05,712 - INFO - Portfolio ID '1' deleted successfully.
2024-10-12 23:21:05,712 - INFO - Portfolio ID '1' deleted successfully.
2024-10-12 23:21:05,712 - INFO - Retrieved 0 portfolios from the database.
2024-10-12 23:21:05,712 - INFO - Portfolios after deletion:
2024-10-12 23:21:05,715 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-12 23:21:06,652 - INFO - CSV data fetched successfully.
2024-10-12 23:21:06,674 - INFO - Inserting transaction data for 2024-10-11 into the database...
2024-10-12 23:21:06,674 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-12 23:21:06,680 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-12 23:21:06,680 - INFO - Fetching table structure for 'Transactions'...
2024-10-12 23:21:06,680 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-12 23:21:06,680 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-12 23:21:06,680 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-12 23:21:06,681 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-12 23:21:06,681 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-12 23:21:06,682 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-12 23:21:06,683 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-12 23:21:06,683 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-12 23:21:06,683 - INFO - Fetching transaction data from 2024-10-11 to 2024-10-11 from the database...
2024-10-12 23:21:06,684 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-12 23:21:06,684 - INFO - Fetching transactions for date: 2024-10-11
2024-10-12 23:21:06,684 - INFO - Retrieved 33 records from Transactions table.
2024-10-12 23:21:06,705 - INFO - Fetched Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-12 23:21:06,706 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12 from the database...
2024-10-12 23:21:06,706 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-12 23:21:06,706 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-12 23:21:06,707 - INFO - Retrieved 33 records from Transactions table.
2024-10-12 23:21:06,733 - INFO - Fetched Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-12 23:21:06,733 - INFO - Fetching market watch data...
2024-10-12 23:21:08,545 - INFO - Retrieved 960 records from market watch.
2024-10-12 23:21:08,547 - INFO - Fetched 960 market watch records.
2024-10-12 23:21:08,547 - INFO - Inserting market watch data into the database...
2024-10-12 23:21:08,558 - INFO - Prepared 960 valid records for market watch insertion.
2024-10-12 23:21:08,559 - INFO - Inserting batch 1 with 100 records.
2024-10-12 23:21:08,606 - INFO - Batch 1 inserted 100 records (may include updates).
2024-10-12 23:21:08,607 - INFO - Inserting batch 2 with 100 records.
2024-10-12 23:21:08,610 - INFO - Batch 2 inserted 100 records (may include updates).
2024-10-12 23:21:08,610 - INFO - Inserting batch 3 with 100 records.
2024-10-12 23:21:08,614 - INFO - Batch 3 inserted 100 records (may include updates).
2024-10-12 23:21:08,615 - INFO - Inserting batch 4 with 100 records.
2024-10-12 23:21:08,615 - INFO - Batch 4 inserted 100 records (may include updates).
2024-10-12 23:21:08,616 - INFO - Inserting batch 5 with 100 records.
2024-10-12 23:21:08,616 - INFO - Batch 5 inserted 100 records (may include updates).
2024-10-12 23:21:08,617 - INFO - Inserting batch 6 with 100 records.
2024-10-12 23:21:08,617 - INFO - Batch 6 inserted 100 records (may include updates).
2024-10-12 23:21:08,617 - INFO - Inserting batch 7 with 100 records.
2024-10-12 23:21:08,618 - INFO - Batch 7 inserted 100 records (may include updates).
2024-10-12 23:21:08,618 - INFO - Inserting batch 8 with 100 records.
2024-10-12 23:21:08,619 - INFO - Batch 8 inserted 100 records (may include updates).
2024-10-12 23:21:08,619 - INFO - Inserting batch 9 with 100 records.
2024-10-12 23:21:08,623 - INFO - Batch 9 inserted 100 records (may include updates).
2024-10-12 23:21:08,623 - INFO - Inserting batch 10 with 60 records.
2024-10-12 23:21:08,624 - INFO - Batch 10 inserted 60 records (may include updates).
2024-10-12 23:21:08,624 - INFO - Added 960 records for market watch data.
2024-10-12 23:21:08,625 - INFO - Total records in the MarketWatch table: 960
2024-10-12 23:21:08,625 - INFO - Successfully inserted 960 market watch records into the database.
2024-10-12 23:21:08,625 - INFO - Fetching top 10 advancers...
2024-10-12 23:21:08,626 - INFO - Top 10 Advancers:
2024-10-12 23:21:08,626 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-12 23:21:08,626 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-12 23:21:08,628 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-12 23:21:08,629 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-12 23:21:08,629 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-12 23:21:08,629 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-12 23:21:08,629 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-12 23:21:08,630 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 23:21:08,630 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 23:21:08,630 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 23:21:08,630 - INFO - --------------------------------------------------
2024-10-12 23:21:08,630 - INFO - Fetching top 10 decliners...
2024-10-12 23:21:08,631 - INFO - Top 10 Decliners:
2024-10-12 23:21:08,631 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 23:21:08,631 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 23:21:08,631 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 23:21:08,632 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-12 23:21:08,632 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-12 23:21:08,632 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 23:21:08,668 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 23:21:08,669 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 23:21:08,671 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-12 23:21:08,673 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-12 23:21:08,674 - INFO - --------------------------------------------------
2024-10-12 23:21:08,677 - INFO - Fetching top 10 most active stocks...
2024-10-12 23:21:08,678 - INFO - Top 10 Most Active Stocks:
2024-10-12 23:21:08,678 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,678 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,678 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,678 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,708 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,708 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,708 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,708 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,709 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,709 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,709 - INFO - --------------------------------------------------
2024-10-12 23:21:08,709 - INFO - Fetching listings data...
2024-10-12 23:21:10,750 - INFO - Retrieved 453 records from listings data.
2024-10-12 23:21:10,750 - INFO - Successfully retrieved 453 listings records.
2024-10-12 23:21:10,750 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-12 23:21:10,751 - INFO - --------------------------------------------------
2024-10-12 23:21:10,751 - INFO - Fetching defaulters data...
2024-10-12 23:21:11,988 - INFO - Retrieved 96 records from defaulters list.
2024-10-12 23:21:11,988 - INFO - Successfully retrieved 96 defaulters records.
2024-10-12 23:21:11,988 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-12 23:21:11,988 - INFO - --------------------------------------------------
2024-10-12 23:21:11,989 - INFO - Merging market watch, listings, and defaulters data...
2024-10-12 23:21:11,990 - INFO - Successfully merged data into 551 records.
2024-10-12 23:21:11,990 - INFO - Sample Merged Data (Defaulter Info Included): [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'UPP9', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761, 'NAME': 'The Hub Power Company Limited', 'SHARES': 1297154400, 'FREE FLOAT': 972865790, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'PTC', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'KSE100', 'LDCP': 14.52, 'OPEN': 14.75, 'HIGH': 15.97, 'LOW': 13.96, 'CURRENT': 15.7, 'CHANGE': 1.18, 'CHANGE (%)': 8.13, 'VOLUME': 51351566, 'NAME': 'Pakistan Telecommunication Company Ltd', 'SHARES': 3774000000, 'FREE FLOAT': 593190667, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'WTL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 1.2, 'OPEN': 1.21, 'HIGH': 1.21, 'LOW': 1.18, 'CURRENT': 1.18, 'CHANGE': -0.02, 'CHANGE (%)': -1.67, 'VOLUME': 45693545, 'NAME': 'Worldcall Telecom Limited', 'SHARES': 4982289186, 'FREE FLOAT': 3736716890, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'HUMNL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 12.33, 'OPEN': 12.5, 'HIGH': 13.56, 'LOW': 12.02, 'CURRENT': 13.56, 'CHANGE': 1.23, 'CHANGE (%)': 9.98, 'VOLUME': 32955417, 'NAME': 'Hum Network Limited', 'SHARES': 1134000000, 'FREE FLOAT': 567000000, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'KOSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'KSE100', 'LDCP': 8.02, 'OPEN': 8.0, 'HIGH': 8.0, 'LOW': 7.02, 'CURRENT': 7.07, 'CHANGE': -0.95, 'CHANGE (%)': -11.85, 'VOLUME': 25957843, 'NAME': 'Kohinoor Spinning Mills Limited', 'SHARES': 412106785, 'FREE FLOAT': 226658732, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}]
2024-10-12 23:21:11,990 - INFO - --------------------------------------------------
2024-10-12 23:21:11,991 - INFO - In-memory database closed after testing.
2024-10-12 23:32:05,146 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 00:12:57,530 - INFO - --------------------------------------------------
2024-10-13 00:12:57,530 - INFO - Fetching PSX constituent data for 2024-10-11...
2024-10-13 00:12:57,531 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:12:59,034 - ERROR - Error fetching PSX data: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
2024-10-13 00:12:59,035 - ERROR - Failed to fetch PSX constituent data or no data available.
2024-10-13 00:16:47,233 - INFO - --------------------------------------------------
2024-10-13 00:16:47,233 - INFO - Fetching PSX constituent data for 2024-10-11...
2024-10-13 00:16:47,233 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:16:48,727 - INFO - Fetched 544 rows of PSX constituent data.
2024-10-13 00:16:48,727 - INFO - Sample PSX Constituent Data:
[{'ISIN': 'PK0061101017', 'SYMBOL': '786', 'COMPANY': '786 Investments Limited', 'PRICE': 6.0, 'IDX WT %': 0.0008053619738181293, 'FF BASED SHARES': 5240813, 'FF BASED MCAP': 31444878.0, 'ORD SHARES': 14973750, 'ORD SHARES MCAP': 89842500.0, 'VOLUME': 26}, {'ISIN': 'PK0050501011', 'SYMBOL': 'AABS', 'COMPANY': 'Al-Abbas Sugar Mills Limited', 'PRICE': 610.67, 'IDX WT %': 0.09504365582042357, 'FF BASED SHARES': 1736230, 'FF BASED MCAP': 1060263574.1, 'ORD SHARES': 17362300, 'ORD SHARES MCAP': 10602635741.0, 'VOLUME': 468}, {'ISIN': 'PK0015401018', 'SYMBOL': 'AAL', 'COMPANY': 'Agro Allianz Limited', 'PRICE': 16.0, 'IDX WT %': 0.00016970218547731608, 'FF BASED SHARES': 0, 'FF BASED MCAP': 0.0, 'ORD SHARES': 1183200, 'ORD SHARES MCAP': 18931200.0, 'VOLUME': 0}, {'ISIN': 'PK0036101019', 'SYMBOL': 'AASM', 'COMPANY': 'Al-Abid Silk Mills Limited', 'PRICE': 3.49, 'IDX WT %': 0.0004195163801039042, 'FF BASED SHARES': 2681910, 'FF BASED MCAP': 9359865.9, 'ORD SHARES': 13409550, 'ORD SHARES MCAP': 46799329.5, 'VOLUME': 0}, {'ISIN': 'PK0011501019', 'SYMBOL': 'AATM', 'COMPANY': 'Ali Asghar Textile Mills Limited', 'PRICE': 57.77, 'IDX WT %': 0.023006770260956922, 'FF BASED SHARES': 926222, 'FF BASED MCAP': 53507844.94, 'ORD SHARES': 44426694, 'ORD SHARES MCAP': 2566530112.38, 'VOLUME': 1214}]
2024-10-13 00:16:48,727 - INFO - --------------------------------------------------
2024-10-13 00:16:48,727 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-13 00:16:49,548 - INFO - CSV data fetched successfully.
2024-10-13 00:16:49,568 - INFO - Fetched 39 rows of transaction data.
2024-10-13 00:16:49,582 - INFO - Sample Transaction Data:
         Date Settlement Date  ... Buyer Code Seller Code
0  2024-10-11      2024-10-15  ...       None        None
1  2024-10-11      2024-10-15  ...       None        None
2  2024-10-11      2024-10-14  ...       None        None
3  2024-10-11      2024-10-15  ...       None        None
4  2024-10-11      2024-10-14  ...       None        None

[5 rows x 11 columns]
2024-10-13 00:16:49,582 - INFO - Fetching stock data...
2024-10-13 00:16:50,475 - INFO - Retrieved 248 records for ticker 'MCB'.
2024-10-13 00:16:50,476 - INFO - Successfully retrieved stock data for 'MCB' from 01 Jan 2022 to 31 Dec 2022
2024-10-13 00:16:50,476 - INFO - Sample Stock Data: [{'Date_': '2022-01-03T00:00:00', 'Open': 152.8, 'High': 154.2, 'Low': 152.4, 'Close': 154.06, 'Change': 0.7099915, 'change_valueP': 0.46298758437956006, 'ChangeP': 0.46298758437956006, 'Volume': 502411.0}, {'Date_': '2022-01-04T00:00:00', 'Open': 154.0, 'High': 154.49, 'Low': 153.5, 'Close': 153.69, 'Change': -0.3699951, 'change_valueP': -0.2401629960846338, 'ChangeP': -0.2401629960846338, 'Volume': 233074.0}, {'Date_': '2022-01-05T00:00:00', 'Open': 153.7, 'High': 154.45, 'Low': 153.0, 'Close': 153.91, 'Change': 0.2200012, 'change_valueP': 0.14314607438203716, 'ChangeP': 0.14314607438203716, 'Volume': 345748.0}, {'Date_': '2022-01-06T00:00:00', 'Open': 154.4, 'High': 154.4, 'Low': 153.07, 'Close': 154.13, 'Change': 0.2200012, 'change_valueP': 0.14294146040887373, 'ChangeP': 0.14294146040887373, 'Volume': 301734.0}, {'Date_': '2022-01-07T00:00:00', 'Open': 154.5, 'High': 155.7, 'Low': 154.0, 'Close': 154.94, 'Change': 0.8099976, 'change_valueP': 0.5255288311083554, 'ChangeP': 0.5255288311083554, 'Volume': 296075.0}]
2024-10-13 00:16:50,476 - INFO - --------------------------------------------------
2024-10-13 00:16:50,476 - INFO - Fetching KSE symbols...
2024-10-13 00:16:51,331 - INFO - Retrieved 0 index symbols.
2024-10-13 00:16:51,332 - ERROR - Failed to retrieve KSE symbols.
2024-10-13 00:16:51,332 - INFO - --------------------------------------------------
2024-10-13 00:16:51,332 - INFO - Fetching market watch data...
2024-10-13 00:16:53,252 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:16:53,254 - INFO - Successfully retrieved market watch data.
2024-10-13 00:16:53,256 - INFO - Sample Market Watch Data: [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}]
2024-10-13 00:16:53,258 - INFO - --------------------------------------------------
2024-10-13 00:16:53,258 - INFO - Fetching ticker market details...
2024-10-13 00:16:54,223 - INFO - Retrieved 6 constituents for index 'JSGBKTI'.
2024-10-13 00:16:54,223 - INFO - Successfully retrieved market details for index 'JSGBKTI'
2024-10-13 00:16:54,223 - INFO - Sample Market Details: [{'SYMBOL': 'BAFL', 'NAME': 'Bank Alfalah Limited', 'LDCP': 66.98, 'CURRENT': 67.86, 'CHANGE': 0.88, 'CHANGE (%)': 1.314, 'IDX WTG (%)': '15.66%', 'IDX POINT': 48.5466, 'VOLUME': 278476, 'FREEFLOAT (M)': 1311284881.0, 'MARKET CAP (M)': 88983792024.66}, {'SYMBOL': 'BAHL', 'NAME': 'Bank AL Habib Limited', 'LDCP': 108.56, 'CURRENT': 108.61, 'CHANGE': 0.05, 'CHANGE (%)': 0.046, 'IDX WTG (%)': '15.19%', 'IDX POINT': 1.6725, 'VOLUME': 228606, 'FREEFLOAT (M)': 795093578.0, 'MARKET CAP (M)': 86355113506.58}, {'SYMBOL': 'HBL', 'NAME': 'Habib Bank Limited', 'LDCP': 137.64, 'CURRENT': 136.05, 'CHANGE': -1.59, 'CHANGE (%)': -1.155, 'IDX WTG (%)': '17.22%', 'IDX POINT': -48.1043, 'VOLUME': 4278696, 'FREEFLOAT (M)': 719129224.0, 'MARKET CAP (M)': 97837530925.20001}, {'SYMBOL': 'MCB', 'NAME': 'MCB Bank Limited', 'LDCP': 255.18, 'CURRENT': 257.42, 'CHANGE': 2.24, 'CHANGE (%)': 0.878, 'IDX WTG (%)': '17.80%', 'IDX POINT': 37.0251, 'VOLUME': 111653, 'FREEFLOAT (M)': 392888722.0, 'MARKET CAP (M)': 101137414817.24}, {'SYMBOL': 'MEBL', 'NAME': 'Meezan Bank Limited', 'LDCP': 240.95, 'CURRENT': 240.62, 'CHANGE': -0.33, 'CHANGE (%)': -0.13699999999999998, 'IDX WTG (%)': '15.77%', 'IDX POINT': -5.1728, 'VOLUME': 431871, 'FREEFLOAT (M)': 372586982.0, 'MARKET CAP (M)': 89651879608.84}]
2024-10-13 00:16:54,223 - INFO - --------------------------------------------------
2024-10-13 00:16:54,223 - INFO - Fetching index historical data...
2024-10-13 00:16:55,397 - INFO - Retrieved 268 historical data points for index 'JSGBKTI'.
2024-10-13 00:16:55,398 - INFO - Successfully retrieved historical data for index 'JSGBKTI'
2024-10-13 00:16:55,398 - INFO - Sample Historical Data: [[1728644400, 23910.2946, 6295789, 23834.4742], [1728558000, 23847.6234, 4476378, 24008.3819], [1728471600, 23988.239, 9972756, 23865.3907], [1728385200, 23804.1322, 16575084, 23058.9327], [1728298800, 23059.2174, 16509979, 22818.46]]
2024-10-13 00:16:55,398 - INFO - --------------------------------------------------
2024-10-13 00:16:55,398 - INFO - Fetching listings data...
2024-10-13 00:16:57,453 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:16:57,454 - INFO - Successfully retrieved listings data.
2024-10-13 00:16:57,456 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-13 00:16:57,458 - INFO - --------------------------------------------------
2024-10-13 00:16:57,460 - INFO - Fetching defaulters data...
2024-10-13 00:16:58,484 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:16:58,485 - INFO - Successfully retrieved defaulters list.
2024-10-13 00:16:58,485 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-13 00:16:58,485 - INFO - --------------------------------------------------
2024-10-13 00:16:58,485 - INFO - Merging market watch, listings, and defaulters data...
2024-10-13 00:16:58,486 - INFO - Successfully merged data.
2024-10-13 00:16:58,486 - INFO - Sample Merged Data (with Defaulter flag): [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'UPP9', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761, 'NAME': 'The Hub Power Company Limited', 'SHARES': 1297154400, 'FREE FLOAT': 972865790, 'DEFAULTER': False}, {'SYMBOL': 'PTC', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'KSE100', 'LDCP': 14.52, 'OPEN': 14.75, 'HIGH': 15.97, 'LOW': 13.96, 'CURRENT': 15.7, 'CHANGE': 1.18, 'CHANGE (%)': 8.13, 'VOLUME': 51351566, 'NAME': 'Pakistan Telecommunication Company Ltd', 'SHARES': 3774000000, 'FREE FLOAT': 593190667, 'DEFAULTER': False}, {'SYMBOL': 'WTL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 1.2, 'OPEN': 1.21, 'HIGH': 1.21, 'LOW': 1.18, 'CURRENT': 1.18, 'CHANGE': -0.02, 'CHANGE (%)': -1.67, 'VOLUME': 45693545, 'NAME': 'Worldcall Telecom Limited', 'SHARES': 4982289186, 'FREE FLOAT': 3736716890, 'DEFAULTER': False}, {'SYMBOL': 'HUMNL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 12.33, 'OPEN': 12.5, 'HIGH': 13.56, 'LOW': 12.02, 'CURRENT': 13.56, 'CHANGE': 1.23, 'CHANGE (%)': 9.98, 'VOLUME': 32955417, 'NAME': 'Hum Network Limited', 'SHARES': 1134000000, 'FREE FLOAT': 567000000, 'DEFAULTER': False}, {'SYMBOL': 'KOSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'KSE100', 'LDCP': 8.02, 'OPEN': 8.0, 'HIGH': 8.0, 'LOW': 7.02, 'CURRENT': 7.07, 'CHANGE': -0.95, 'CHANGE (%)': -11.85, 'VOLUME': 25957843, 'NAME': 'Kohinoor Spinning Mills Limited', 'SHARES': 412106785, 'FREE FLOAT': 226658732, 'DEFAULTER': False}]
2024-10-13 00:16:58,487 - INFO - --------------------------------------------------
2024-10-13 00:16:58,487 - INFO - 001: Altaf Adam Securities (Pvt.) Ltd.
2024-10-13 00:16:58,487 - INFO - 006: Sherman Securities (Pvt.) Ltd.
2024-10-13 00:16:58,487 - INFO - 008: Optimus Capital Management (Pvt.) Ltd.
2024-10-13 00:16:58,488 - INFO - 010: Sakarwala Capital Securities (Pvt.) Ltd.
2024-10-13 00:16:58,488 - INFO - 017: Summit Capital (Pvt.) Ltd.
2024-10-13 00:16:58,488 - INFO - 018: Ismail Iqbal Securities (Pvt.) Ltd.
2024-10-13 00:16:58,488 - INFO - 019: AKD Securities Ltd.
2024-10-13 00:16:58,489 - INFO - 021: Alpha Capital (Pvt.) Ltd.
2024-10-13 00:16:58,489 - INFO - 022: BMA Capital Management Ltd.
2024-10-13 00:16:58,489 - INFO - 025: Vector Securities (Pvt.) Ltd.
2024-10-13 00:16:58,489 - INFO - 027: Habib Metropolitan Financial Services
2024-10-13 00:16:58,489 - INFO - 037: H.H. Misbah Securities (Pvt.) Ltd.
2024-10-13 00:16:58,489 - INFO - 038: A.H.M. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,489 - INFO - 044: IGI Finex Securities Ltd.
2024-10-13 00:16:58,491 - INFO - 046: Fortune Securities Ltd.
2024-10-13 00:16:58,491 - INFO - 047: Zillion Capital Securities (Pvt.) Ltd.
2024-10-13 00:16:58,491 - INFO - 048: Next Capital Ltd.
2024-10-13 00:16:58,492 - INFO - 049: Multiline Securities Ltd.
2024-10-13 00:16:58,492 - INFO - 050: Arif Habib Ltd.
2024-10-13 00:16:58,492 - INFO - 058: Dawood Equities Ltd.
2024-10-13 00:16:58,492 - INFO - 062: WE Financial Services Ltd.
2024-10-13 00:16:58,492 - INFO - 063: Al-Habib Capital Markets (Pvt.) Ltd.
2024-10-13 00:16:58,492 - INFO - 068: Zafar Securities (Pvt.) Ltd.
2024-10-13 00:16:58,492 - INFO - 077: Bawany Securities (Pvt.) Ltd.
2024-10-13 00:16:58,492 - INFO - 084: Munir Khanani Securities Ltd.
2024-10-13 00:16:58,492 - INFO - 088: Fawad Yusuf Securities (Pvt.) Ltd.
2024-10-13 00:16:58,492 - INFO - 090: Darson Securities Private Limited.
2024-10-13 00:16:58,492 - INFO - 091: Intermarket Securities Ltd.
2024-10-13 00:16:58,493 - INFO - 092: Memon Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 094: FDM Capital Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 096: Msmaniar Financials (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 102: Growth Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 107: Seven Star Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 108: AZEE Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 112: Standard Capital Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 119: Axis Global Ltd.
2024-10-13 00:16:58,494 - INFO - 120: Alfalah Securities (Pvt.) Ltd.
2024-10-13 00:16:58,494 - INFO - 124: EFG Hermes Pakistan Ltd.
2024-10-13 00:16:58,494 - INFO - 129: Taurus Securities Ltd.
2024-10-13 00:16:58,494 - INFO - 140: M.M. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,494 - INFO - 142: Foundation Securities (Pvt.) Ltd.
2024-10-13 00:16:58,494 - INFO - 145: Adam Securities Ltd.
2024-10-13 00:16:58,494 - INFO - 149: JS Global Capital Ltd.
2024-10-13 00:16:58,495 - INFO - 159: Rafi Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 162: Aba Ali Habib Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 163: Friendly Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 164: Interactive Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 166: Topline Securities Ltd.
2024-10-13 00:16:58,495 - INFO - 169: Pearl Securities Ltd.
2024-10-13 00:16:58,495 - INFO - 173: Spectrum Securities Ltd.
2024-10-13 00:16:58,495 - INFO - 175: First National Equities Ltd.
2024-10-13 00:16:58,495 - INFO - 183: R.T. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 194: MRA Securities Ltd.
2024-10-13 00:16:58,495 - INFO - 199: Insight Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 248: Ktrade Securites Ltd.
2024-10-13 00:16:58,495 - INFO - 254: ShajarPak Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 275: Rahat Securities Ltd.
2024-10-13 00:16:58,496 - INFO - 293: Integrated Equities Ltd.
2024-10-13 00:16:58,496 - INFO - 311: Abbasi & Company (Pvt.) Ltd.
2024-10-13 00:16:58,496 - INFO - 332: Trust Securities & Brokerage Ltd.
2024-10-13 00:16:58,496 - INFO - 410: Zahid Latif Khan Securities (Pvt.) Ltd.
2024-10-13 00:16:58,496 - INFO - 524: Akik Capital (Pvt.) Ltd.
2024-10-13 00:16:58,496 - INFO - 525: Adam Usman Securities (Pvt.) Ltd.
2024-10-13 00:16:58,496 - INFO - 526: Chase Securities Pakistan (Pvt.) Ltd.
2024-10-13 00:16:58,497 - INFO - 528: H.G Markets (Private) Limited
2024-10-13 00:16:58,497 - INFO - 529: Orbit Securities (Pvt.) Ltd.
2024-10-13 00:16:58,497 - INFO - 531: T&G Securities Private Limited.
2024-10-13 00:16:58,497 - INFO - 601: JSK Securities Limited
2024-10-13 00:16:58,497 - INFO - 602: ZLK Islamic Financial Services Pvt.Ltd.
2024-10-13 00:16:58,497 - INFO - 603: Enrichers Securities (Pvt) Ltd.
2024-10-13 00:16:58,497 - INFO - 932: Ahsam Securities (Pvt.) Ltd.
2024-10-13 00:16:58,497 - INFO - 934: Falki Capital (Pvt.) Ltd.
2024-10-13 00:16:58,497 - INFO - 935: Salim Sozer Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 936: Saya Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 937: ASA Stocks (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 938: Margalla Financial (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 941: A.I. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 942: M. Salim Kasmani Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 943: Z.A. Ghaffar Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 951: K.H.S. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 957: 128 Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 961: KP Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 963: Yasir Mahmood Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 967: High Land Securities (Pvt.) Ltd.
2024-10-13 00:16:58,499 - INFO - 972: Pasha Securities (Pvt.) Ltd.
2024-10-13 00:16:58,499 - INFO - 973: Stocxinvest Securities (Pvt) Ltd
2024-10-13 00:16:58,500 - INFO - 975: Adeel Nadeem Securities Ltd.
2024-10-13 00:16:58,500 - INFO - 977: Gul Dhami Securities Pvt Ltd
2024-10-13 00:16:58,500 - INFO - 978: Dosslani's Securities Private Limited
2024-10-13 00:16:58,500 - INFO - 986: Progressive Securities Pvt Ltd.
2024-10-13 00:16:58,500 - INFO - 987: CMA Securities Pvt Ltd.
2024-10-13 00:16:58,500 - INFO - 988: Javed Iqbal Securities Pvt Ltd.
2024-10-13 00:16:58,500 - INFO - 992: Vector Securities Private Limited
2024-10-13 00:16:58,500 - INFO - 994: Unex Securities (Private) Limited
2024-10-13 00:16:58,501 - INFO - 995: Syed Faraz Equities (Private) Limited
2024-10-13 00:19:15,694 - INFO - Initializing in-memory database for testing...
2024-10-13 00:19:15,695 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-13 00:19:15,695 - INFO - ---- Portfolio Management ----
2024-10-13 00:19:15,696 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:19:17,217 - INFO - Inserted or updated 544 records in the database.
2024-10-13 00:19:17,219 - INFO - Search results for company 'Al-Abbas': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:19:17,219 - INFO - Search results for symbol 'AABS': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:19:17,220 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-13 00:19:17,220 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-13 00:19:17,220 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 00:19:17,222 - INFO - Existing Portfolios:
2024-10-13 00:19:17,223 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-13 00:19:17,223 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:19:17,223 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:19:17,228 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:19:17,229 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:19:17,229 - INFO - Retrieved 0 portfolios from the database.
2024-10-13 00:19:17,229 - INFO - Portfolios after deletion:
2024-10-13 00:19:17,229 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-13 00:19:18,083 - INFO - CSV data fetched successfully.
2024-10-13 00:19:18,106 - INFO - Inserting transaction data for 2024-10-11 into the database...
2024-10-13 00:19:18,106 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-13 00:19:18,113 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-13 00:19:18,113 - INFO - Fetching table structure for 'Transactions'...
2024-10-13 00:19:18,114 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-13 00:19:18,114 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-13 00:19:18,114 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-13 00:19:18,115 - INFO - Fetching transaction data from 2024-10-11 to 2024-10-11 from the database...
2024-10-13 00:19:18,115 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-13 00:19:18,115 - INFO - Fetching transactions for date: 2024-10-11
2024-10-13 00:19:18,115 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:19:18,134 - INFO - Fetched Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:19:18,135 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12 from the database...
2024-10-13 00:19:18,135 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-13 00:19:18,135 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-13 00:19:18,135 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:19:18,192 - INFO - Fetched Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:19:18,192 - INFO - Inserting market watch data into the database...
2024-10-13 00:19:18,192 - INFO - Fetching market watch data...
2024-10-13 00:19:20,304 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:19:20,305 - INFO - Fetched 960 market watch records.
2024-10-13 00:19:20,320 - INFO - Inserting batch 1 with 100 records.
2024-10-13 00:19:20,324 - INFO - Inserting batch 2 with 100 records.
2024-10-13 00:19:20,326 - INFO - Inserting batch 3 with 100 records.
2024-10-13 00:19:20,329 - INFO - Inserting batch 4 with 100 records.
2024-10-13 00:19:20,330 - INFO - Inserting batch 5 with 100 records.
2024-10-13 00:19:20,331 - INFO - Inserting batch 6 with 100 records.
2024-10-13 00:19:20,346 - INFO - Inserting batch 7 with 100 records.
2024-10-13 00:19:20,346 - INFO - Inserting batch 8 with 100 records.
2024-10-13 00:19:20,366 - INFO - Inserting batch 9 with 100 records.
2024-10-13 00:19:20,367 - INFO - Inserting batch 10 with 60 records.
2024-10-13 00:19:20,368 - INFO - Successfully inserted/updated 960 records for market watch data.
2024-10-13 00:19:20,368 - INFO - Total records in the MarketWatch table: 960
2024-10-13 00:19:20,370 - INFO - Successfully inserted 960 market watch records into the database.
2024-10-13 00:19:20,373 - INFO - Fetching top 10 advancers...
2024-10-13 00:19:20,377 - INFO - Top 10 Advancers:
2024-10-13 00:19:20,377 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-13 00:19:20,378 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-13 00:19:20,378 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:19:20,378 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:19:20,378 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-13 00:19:20,378 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-13 00:19:20,379 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-13 00:19:20,379 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:19:20,379 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:19:20,379 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:19:20,379 - INFO - --------------------------------------------------
2024-10-13 00:19:20,380 - INFO - Fetching top 10 decliners...
2024-10-13 00:19:20,380 - INFO - Top 10 Decliners:
2024-10-13 00:19:20,380 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:19:20,380 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:19:20,380 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:19:20,381 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-13 00:19:20,381 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-13 00:19:20,381 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:19:20,381 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:19:20,381 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:19:20,381 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:19:20,381 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:19:20,382 - INFO - --------------------------------------------------
2024-10-13 00:19:20,382 - INFO - Fetching top 10 most active stocks...
2024-10-13 00:19:20,386 - INFO - Top 10 Most Active Stocks:
2024-10-13 00:19:20,387 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,387 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,387 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,388 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,388 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,388 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,389 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,389 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,389 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,390 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,390 - INFO - --------------------------------------------------
2024-10-13 00:19:20,390 - INFO - Fetching listings data...
2024-10-13 00:19:21,578 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:19:21,579 - INFO - Successfully retrieved 453 listings records.
2024-10-13 00:19:21,579 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-13 00:19:21,581 - INFO - --------------------------------------------------
2024-10-13 00:19:21,581 - INFO - Fetching defaulters data...
2024-10-13 00:19:22,598 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:19:22,599 - INFO - Successfully retrieved 96 defaulters records.
2024-10-13 00:19:22,599 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-13 00:19:22,599 - INFO - --------------------------------------------------
2024-10-13 00:19:22,599 - INFO - Merging market watch, listings, and defaulters data...
2024-10-13 00:20:21,838 - INFO - --------------------------------------------------
2024-10-13 00:20:21,838 - INFO - Fetching PSX constituent data for 2024-10-11...
2024-10-13 00:20:21,838 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:20:23,348 - INFO - Fetched 544 rows of PSX constituent data.
2024-10-13 00:20:23,349 - INFO - Sample PSX Constituent Data:
[{'ISIN': 'PK0061101017', 'SYMBOL': '786', 'COMPANY': '786 Investments Limited', 'PRICE': 6.0, 'IDX WT %': 0.0008053619738181293, 'FF BASED SHARES': 5240813, 'FF BASED MCAP': 31444878.0, 'ORD SHARES': 14973750, 'ORD SHARES MCAP': 89842500.0, 'VOLUME': 26}, {'ISIN': 'PK0050501011', 'SYMBOL': 'AABS', 'COMPANY': 'Al-Abbas Sugar Mills Limited', 'PRICE': 610.67, 'IDX WT %': 0.09504365582042357, 'FF BASED SHARES': 1736230, 'FF BASED MCAP': 1060263574.1, 'ORD SHARES': 17362300, 'ORD SHARES MCAP': 10602635741.0, 'VOLUME': 468}, {'ISIN': 'PK0015401018', 'SYMBOL': 'AAL', 'COMPANY': 'Agro Allianz Limited', 'PRICE': 16.0, 'IDX WT %': 0.00016970218547731608, 'FF BASED SHARES': 0, 'FF BASED MCAP': 0.0, 'ORD SHARES': 1183200, 'ORD SHARES MCAP': 18931200.0, 'VOLUME': 0}, {'ISIN': 'PK0036101019', 'SYMBOL': 'AASM', 'COMPANY': 'Al-Abid Silk Mills Limited', 'PRICE': 3.49, 'IDX WT %': 0.0004195163801039042, 'FF BASED SHARES': 2681910, 'FF BASED MCAP': 9359865.9, 'ORD SHARES': 13409550, 'ORD SHARES MCAP': 46799329.5, 'VOLUME': 0}, {'ISIN': 'PK0011501019', 'SYMBOL': 'AATM', 'COMPANY': 'Ali Asghar Textile Mills Limited', 'PRICE': 57.77, 'IDX WT %': 0.023006770260956922, 'FF BASED SHARES': 926222, 'FF BASED MCAP': 53507844.94, 'ORD SHARES': 44426694, 'ORD SHARES MCAP': 2566530112.38, 'VOLUME': 1214}]
2024-10-13 00:20:23,349 - INFO - --------------------------------------------------
2024-10-13 00:20:23,349 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-13 00:20:24,214 - INFO - CSV data fetched successfully.
2024-10-13 00:20:24,235 - INFO - Fetched 39 rows of transaction data.
2024-10-13 00:20:24,258 - INFO - Sample Transaction Data:
         Date Settlement Date  ... Buyer Code Seller Code
0  2024-10-11      2024-10-15  ...       None        None
1  2024-10-11      2024-10-15  ...       None        None
2  2024-10-11      2024-10-14  ...       None        None
3  2024-10-11      2024-10-15  ...       None        None
4  2024-10-11      2024-10-14  ...       None        None

[5 rows x 11 columns]
2024-10-13 00:20:24,258 - INFO - Fetching stock data...
2024-10-13 00:20:25,156 - INFO - Retrieved 248 records for ticker 'MCB'.
2024-10-13 00:20:25,156 - INFO - Successfully retrieved stock data for 'MCB' from 01 Jan 2022 to 31 Dec 2022
2024-10-13 00:20:25,156 - INFO - Sample Stock Data: [{'Date_': '2022-01-03T00:00:00', 'Open': 152.8, 'High': 154.2, 'Low': 152.4, 'Close': 154.06, 'Change': 0.7099915, 'change_valueP': 0.46298758437956006, 'ChangeP': 0.46298758437956006, 'Volume': 502411.0}, {'Date_': '2022-01-04T00:00:00', 'Open': 154.0, 'High': 154.49, 'Low': 153.5, 'Close': 153.69, 'Change': -0.3699951, 'change_valueP': -0.2401629960846338, 'ChangeP': -0.2401629960846338, 'Volume': 233074.0}, {'Date_': '2022-01-05T00:00:00', 'Open': 153.7, 'High': 154.45, 'Low': 153.0, 'Close': 153.91, 'Change': 0.2200012, 'change_valueP': 0.14314607438203716, 'ChangeP': 0.14314607438203716, 'Volume': 345748.0}, {'Date_': '2022-01-06T00:00:00', 'Open': 154.4, 'High': 154.4, 'Low': 153.07, 'Close': 154.13, 'Change': 0.2200012, 'change_valueP': 0.14294146040887373, 'ChangeP': 0.14294146040887373, 'Volume': 301734.0}, {'Date_': '2022-01-07T00:00:00', 'Open': 154.5, 'High': 155.7, 'Low': 154.0, 'Close': 154.94, 'Change': 0.8099976, 'change_valueP': 0.5255288311083554, 'ChangeP': 0.5255288311083554, 'Volume': 296075.0}]
2024-10-13 00:20:25,156 - INFO - --------------------------------------------------
2024-10-13 00:20:25,156 - INFO - Fetching KSE symbols...
2024-10-13 00:20:26,538 - INFO - Retrieved 855 index symbols.
2024-10-13 00:20:26,539 - INFO - Successfully retrieved 855 KSE symbols.
2024-10-13 00:20:26,539 - INFO - Sample KSE Symbols: [{'symbol': 'AKBLTFC6', 'name': 'Askari Bank(TFC6)', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}, {'symbol': 'AKBLTFC7', 'name': 'Askari Bank(TFC7)', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}, {'symbol': 'BAFLTFC6', 'name': 'Bank Al-Falah(TFC6', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}, {'symbol': 'BAFLTFC8', 'name': 'Bank Alfalah(TFC8)', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}, {'symbol': 'BAHLTFC10', 'name': 'BANK AL HABIB LTD. (10TH ISSUE)', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}]
2024-10-13 00:20:26,539 - INFO - --------------------------------------------------
2024-10-13 00:20:26,539 - INFO - Fetching market watch data...
2024-10-13 00:20:28,031 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:20:28,032 - INFO - Successfully retrieved market watch data.
2024-10-13 00:20:28,032 - INFO - Sample Market Watch Data: [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}]
2024-10-13 00:20:28,032 - INFO - --------------------------------------------------
2024-10-13 00:20:28,034 - INFO - Fetching ticker market details...
2024-10-13 00:20:29,271 - INFO - Retrieved 6 constituents for index 'JSGBKTI'.
2024-10-13 00:20:29,272 - INFO - Successfully retrieved market details for index 'JSGBKTI'
2024-10-13 00:20:29,272 - INFO - Sample Market Details: [{'SYMBOL': 'BAFL', 'NAME': 'Bank Alfalah Limited', 'LDCP': 66.98, 'CURRENT': 67.86, 'CHANGE': 0.88, 'CHANGE (%)': 1.314, 'IDX WTG (%)': '15.66%', 'IDX POINT': 48.5466, 'VOLUME': 278476, 'FREEFLOAT (M)': 1311284881.0, 'MARKET CAP (M)': 88983792024.66}, {'SYMBOL': 'BAHL', 'NAME': 'Bank AL Habib Limited', 'LDCP': 108.56, 'CURRENT': 108.61, 'CHANGE': 0.05, 'CHANGE (%)': 0.046, 'IDX WTG (%)': '15.19%', 'IDX POINT': 1.6725, 'VOLUME': 228606, 'FREEFLOAT (M)': 795093578.0, 'MARKET CAP (M)': 86355113506.58}, {'SYMBOL': 'HBL', 'NAME': 'Habib Bank Limited', 'LDCP': 137.64, 'CURRENT': 136.05, 'CHANGE': -1.59, 'CHANGE (%)': -1.155, 'IDX WTG (%)': '17.22%', 'IDX POINT': -48.1043, 'VOLUME': 4278696, 'FREEFLOAT (M)': 719129224.0, 'MARKET CAP (M)': 97837530925.20001}, {'SYMBOL': 'MCB', 'NAME': 'MCB Bank Limited', 'LDCP': 255.18, 'CURRENT': 257.42, 'CHANGE': 2.24, 'CHANGE (%)': 0.878, 'IDX WTG (%)': '17.80%', 'IDX POINT': 37.0251, 'VOLUME': 111653, 'FREEFLOAT (M)': 392888722.0, 'MARKET CAP (M)': 101137414817.24}, {'SYMBOL': 'MEBL', 'NAME': 'Meezan Bank Limited', 'LDCP': 240.95, 'CURRENT': 240.62, 'CHANGE': -0.33, 'CHANGE (%)': -0.13699999999999998, 'IDX WTG (%)': '15.77%', 'IDX POINT': -5.1728, 'VOLUME': 431871, 'FREEFLOAT (M)': 372586982.0, 'MARKET CAP (M)': 89651879608.84}]
2024-10-13 00:20:29,272 - INFO - --------------------------------------------------
2024-10-13 00:20:29,272 - INFO - Fetching index historical data...
2024-10-13 00:20:31,587 - INFO - Retrieved 268 historical data points for index 'JSGBKTI'.
2024-10-13 00:20:31,588 - INFO - Successfully retrieved historical data for index 'JSGBKTI'
2024-10-13 00:20:31,588 - INFO - Sample Historical Data: [[1728644400, 23910.2946, 6295789, 23834.4742], [1728558000, 23847.6234, 4476378, 24008.3819], [1728471600, 23988.239, 9972756, 23865.3907], [1728385200, 23804.1322, 16575084, 23058.9327], [1728298800, 23059.2174, 16509979, 22818.46]]
2024-10-13 00:20:31,588 - INFO - --------------------------------------------------
2024-10-13 00:20:31,588 - INFO - Fetching listings data...
2024-10-13 00:20:32,992 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:20:32,993 - INFO - Successfully retrieved listings data.
2024-10-13 00:20:32,993 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-13 00:20:32,999 - INFO - --------------------------------------------------
2024-10-13 00:20:33,003 - INFO - Fetching defaulters data...
2024-10-13 00:20:34,017 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:20:34,021 - INFO - Successfully retrieved defaulters list.
2024-10-13 00:20:34,021 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-13 00:20:34,021 - INFO - --------------------------------------------------
2024-10-13 00:20:34,022 - INFO - Merging market watch, listings, and defaulters data...
2024-10-13 00:20:34,022 - INFO - Successfully merged data.
2024-10-13 00:20:34,023 - INFO - Sample Merged Data (with Defaulter flag): [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'UPP9', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761, 'NAME': 'The Hub Power Company Limited', 'SHARES': 1297154400, 'FREE FLOAT': 972865790, 'DEFAULTER': False}, {'SYMBOL': 'PTC', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'KSE100', 'LDCP': 14.52, 'OPEN': 14.75, 'HIGH': 15.97, 'LOW': 13.96, 'CURRENT': 15.7, 'CHANGE': 1.18, 'CHANGE (%)': 8.13, 'VOLUME': 51351566, 'NAME': 'Pakistan Telecommunication Company Ltd', 'SHARES': 3774000000, 'FREE FLOAT': 593190667, 'DEFAULTER': False}, {'SYMBOL': 'WTL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 1.2, 'OPEN': 1.21, 'HIGH': 1.21, 'LOW': 1.18, 'CURRENT': 1.18, 'CHANGE': -0.02, 'CHANGE (%)': -1.67, 'VOLUME': 45693545, 'NAME': 'Worldcall Telecom Limited', 'SHARES': 4982289186, 'FREE FLOAT': 3736716890, 'DEFAULTER': False}, {'SYMBOL': 'HUMNL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 12.33, 'OPEN': 12.5, 'HIGH': 13.56, 'LOW': 12.02, 'CURRENT': 13.56, 'CHANGE': 1.23, 'CHANGE (%)': 9.98, 'VOLUME': 32955417, 'NAME': 'Hum Network Limited', 'SHARES': 1134000000, 'FREE FLOAT': 567000000, 'DEFAULTER': False}, {'SYMBOL': 'KOSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'KSE100', 'LDCP': 8.02, 'OPEN': 8.0, 'HIGH': 8.0, 'LOW': 7.02, 'CURRENT': 7.07, 'CHANGE': -0.95, 'CHANGE (%)': -11.85, 'VOLUME': 25957843, 'NAME': 'Kohinoor Spinning Mills Limited', 'SHARES': 412106785, 'FREE FLOAT': 226658732, 'DEFAULTER': False}]
2024-10-13 00:20:34,023 - INFO - --------------------------------------------------
2024-10-13 00:20:34,023 - INFO - 001: Altaf Adam Securities (Pvt.) Ltd.
2024-10-13 00:20:34,023 - INFO - 006: Sherman Securities (Pvt.) Ltd.
2024-10-13 00:20:34,023 - INFO - 008: Optimus Capital Management (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 010: Sakarwala Capital Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 017: Summit Capital (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 018: Ismail Iqbal Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 019: AKD Securities Ltd.
2024-10-13 00:20:34,024 - INFO - 021: Alpha Capital (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 022: BMA Capital Management Ltd.
2024-10-13 00:20:34,024 - INFO - 025: Vector Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 027: Habib Metropolitan Financial Services
2024-10-13 00:20:34,024 - INFO - 037: H.H. Misbah Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 038: A.H.M. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 044: IGI Finex Securities Ltd.
2024-10-13 00:20:34,024 - INFO - 046: Fortune Securities Ltd.
2024-10-13 00:20:34,024 - INFO - 047: Zillion Capital Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 048: Next Capital Ltd.
2024-10-13 00:20:34,025 - INFO - 049: Multiline Securities Ltd.
2024-10-13 00:20:34,025 - INFO - 050: Arif Habib Ltd.
2024-10-13 00:20:34,025 - INFO - 058: Dawood Equities Ltd.
2024-10-13 00:20:34,025 - INFO - 062: WE Financial Services Ltd.
2024-10-13 00:20:34,025 - INFO - 063: Al-Habib Capital Markets (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 068: Zafar Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 077: Bawany Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 084: Munir Khanani Securities Ltd.
2024-10-13 00:20:34,025 - INFO - 088: Fawad Yusuf Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 090: Darson Securities Private Limited.
2024-10-13 00:20:34,025 - INFO - 091: Intermarket Securities Ltd.
2024-10-13 00:20:34,025 - INFO - 092: Memon Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 094: FDM Capital Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 096: Msmaniar Financials (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 102: Growth Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 107: Seven Star Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 108: AZEE Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 112: Standard Capital Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 119: Axis Global Ltd.
2024-10-13 00:20:34,026 - INFO - 120: Alfalah Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 124: EFG Hermes Pakistan Ltd.
2024-10-13 00:20:34,026 - INFO - 129: Taurus Securities Ltd.
2024-10-13 00:20:34,026 - INFO - 140: M.M. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 142: Foundation Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 145: Adam Securities Ltd.
2024-10-13 00:20:34,026 - INFO - 149: JS Global Capital Ltd.
2024-10-13 00:20:34,026 - INFO - 159: Rafi Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 162: Aba Ali Habib Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 163: Friendly Securities (Pvt.) Ltd.
2024-10-13 00:20:34,027 - INFO - 164: Interactive Securities (Pvt.) Ltd.
2024-10-13 00:20:34,027 - INFO - 166: Topline Securities Ltd.
2024-10-13 00:20:34,027 - INFO - 169: Pearl Securities Ltd.
2024-10-13 00:20:34,027 - INFO - 173: Spectrum Securities Ltd.
2024-10-13 00:20:34,027 - INFO - 175: First National Equities Ltd.
2024-10-13 00:20:34,027 - INFO - 183: R.T. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,027 - INFO - 194: MRA Securities Ltd.
2024-10-13 00:20:34,027 - INFO - 199: Insight Securities (Pvt.) Ltd.
2024-10-13 00:20:34,027 - INFO - 248: Ktrade Securites Ltd.
2024-10-13 00:20:34,027 - INFO - 254: ShajarPak Securities (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 275: Rahat Securities Ltd.
2024-10-13 00:20:34,028 - INFO - 293: Integrated Equities Ltd.
2024-10-13 00:20:34,028 - INFO - 311: Abbasi & Company (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 332: Trust Securities & Brokerage Ltd.
2024-10-13 00:20:34,028 - INFO - 410: Zahid Latif Khan Securities (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 524: Akik Capital (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 525: Adam Usman Securities (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 526: Chase Securities Pakistan (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 528: H.G Markets (Private) Limited
2024-10-13 00:20:34,028 - INFO - 529: Orbit Securities (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 531: T&G Securities Private Limited.
2024-10-13 00:20:34,028 - INFO - 601: JSK Securities Limited
2024-10-13 00:20:34,028 - INFO - 602: ZLK Islamic Financial Services Pvt.Ltd.
2024-10-13 00:20:34,029 - INFO - 603: Enrichers Securities (Pvt) Ltd.
2024-10-13 00:20:34,029 - INFO - 932: Ahsam Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 934: Falki Capital (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 935: Salim Sozer Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 936: Saya Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 937: ASA Stocks (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 938: Margalla Financial (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 941: A.I. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 942: M. Salim Kasmani Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 943: Z.A. Ghaffar Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 951: K.H.S. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 957: 128 Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 961: KP Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 963: Yasir Mahmood Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 967: High Land Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 972: Pasha Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 973: Stocxinvest Securities (Pvt) Ltd
2024-10-13 00:20:34,030 - INFO - 975: Adeel Nadeem Securities Ltd.
2024-10-13 00:20:34,031 - INFO - 977: Gul Dhami Securities Pvt Ltd
2024-10-13 00:20:34,031 - INFO - 978: Dosslani's Securities Private Limited
2024-10-13 00:20:34,031 - INFO - 986: Progressive Securities Pvt Ltd.
2024-10-13 00:20:34,031 - INFO - 987: CMA Securities Pvt Ltd.
2024-10-13 00:20:34,031 - INFO - 988: Javed Iqbal Securities Pvt Ltd.
2024-10-13 00:20:34,031 - INFO - 992: Vector Securities Private Limited
2024-10-13 00:20:34,032 - INFO - 994: Unex Securities (Private) Limited
2024-10-13 00:20:34,032 - INFO - 995: Syed Faraz Equities (Private) Limited
2024-10-13 00:20:51,320 - INFO - Initializing in-memory database for testing...
2024-10-13 00:20:51,321 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-13 00:20:51,322 - INFO - ---- Portfolio Management ----
2024-10-13 00:20:51,322 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:20:53,257 - INFO - Inserted or updated 544 records in the database.
2024-10-13 00:20:53,257 - INFO - Search results for company 'Al-Abbas': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:20:53,257 - INFO - Search results for symbol 'AABS': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:20:53,258 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-13 00:20:53,258 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-13 00:20:53,259 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 00:20:53,259 - INFO - Existing Portfolios:
2024-10-13 00:20:53,259 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-13 00:20:53,259 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:20:53,260 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:20:53,260 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:20:53,260 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:20:53,260 - INFO - Retrieved 0 portfolios from the database.
2024-10-13 00:20:53,260 - INFO - Portfolios after deletion:
2024-10-13 00:20:53,260 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-13 00:20:54,165 - INFO - CSV data fetched successfully.
2024-10-13 00:20:54,189 - INFO - Inserting transaction data for 2024-10-11 into the database...
2024-10-13 00:20:54,189 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-13 00:20:54,192 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-13 00:20:54,192 - INFO - Fetching table structure for 'Transactions'...
2024-10-13 00:20:54,193 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-13 00:20:54,193 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-13 00:20:54,193 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-13 00:20:54,193 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:20:54,193 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:20:54,194 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-13 00:20:54,194 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-13 00:20:54,194 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-13 00:20:54,194 - INFO - Fetching transaction data from 2024-10-11 to 2024-10-11 from the database...
2024-10-13 00:20:54,195 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-13 00:20:54,195 - INFO - Fetching transactions for date: 2024-10-11
2024-10-13 00:20:54,195 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:20:54,220 - INFO - Fetched Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:20:54,220 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12 from the database...
2024-10-13 00:20:54,220 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-13 00:20:54,221 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-13 00:20:54,221 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:20:54,248 - INFO - Fetched Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:20:54,248 - INFO - Inserting market watch data into the database...
2024-10-13 00:20:54,249 - INFO - Fetching market watch data...
2024-10-13 00:20:55,894 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:20:55,895 - INFO - Fetched 960 market watch records.
2024-10-13 00:20:55,908 - INFO - Inserting batch 1 with 100 records.
2024-10-13 00:20:55,911 - INFO - Inserting batch 2 with 100 records.
2024-10-13 00:20:55,911 - INFO - Inserting batch 3 with 100 records.
2024-10-13 00:20:55,913 - INFO - Inserting batch 4 with 100 records.
2024-10-13 00:20:55,916 - INFO - Inserting batch 5 with 100 records.
2024-10-13 00:20:55,922 - INFO - Inserting batch 6 with 100 records.
2024-10-13 00:20:55,923 - INFO - Inserting batch 7 with 100 records.
2024-10-13 00:20:55,923 - INFO - Inserting batch 8 with 100 records.
2024-10-13 00:20:55,924 - INFO - Inserting batch 9 with 100 records.
2024-10-13 00:20:55,925 - INFO - Inserting batch 10 with 60 records.
2024-10-13 00:20:55,926 - INFO - Successfully inserted/updated 960 records for market watch data.
2024-10-13 00:20:55,928 - INFO - Total records in the MarketWatch table: 960
2024-10-13 00:20:55,929 - INFO - Successfully inserted 960 market watch records into the database.
2024-10-13 00:20:55,929 - INFO - Fetching top 10 advancers...
2024-10-13 00:20:55,931 - INFO - Top 10 Advancers:
2024-10-13 00:20:55,931 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-13 00:20:55,932 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-13 00:20:55,932 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:20:55,934 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:20:55,934 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-13 00:20:55,938 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-13 00:20:55,938 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-13 00:20:55,938 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:20:55,938 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:20:55,940 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:20:55,940 - INFO - --------------------------------------------------
2024-10-13 00:20:55,940 - INFO - Fetching top 10 decliners...
2024-10-13 00:20:55,941 - INFO - Top 10 Decliners:
2024-10-13 00:20:55,941 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:20:55,942 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:20:55,942 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:20:55,943 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-13 00:20:55,943 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-13 00:20:55,943 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:20:55,943 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:20:55,943 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:20:55,944 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:20:55,944 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:20:55,944 - INFO - --------------------------------------------------
2024-10-13 00:20:55,944 - INFO - Fetching top 10 most active stocks...
2024-10-13 00:20:55,944 - INFO - Top 10 Most Active Stocks:
2024-10-13 00:20:55,945 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,945 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,945 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,945 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,946 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,946 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,947 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,948 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,949 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,950 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,951 - INFO - --------------------------------------------------
2024-10-13 00:20:55,951 - INFO - Fetching listings data...
2024-10-13 00:20:58,130 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:20:58,130 - INFO - Successfully retrieved 453 listings records.
2024-10-13 00:20:58,131 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-13 00:20:58,132 - INFO - --------------------------------------------------
2024-10-13 00:20:58,134 - INFO - Fetching defaulters data...
2024-10-13 00:21:00,062 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:21:00,063 - INFO - Successfully retrieved 96 defaulters records.
2024-10-13 00:21:00,066 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-13 00:21:00,067 - INFO - --------------------------------------------------
2024-10-13 00:21:00,067 - INFO - Merging market watch, listings, and defaulters data...
2024-10-13 00:26:47,330 - INFO - Initializing in-memory database for testing...
2024-10-13 00:26:47,331 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-13 00:26:47,332 - INFO - In-memory database initialized successfully.
2024-10-13 00:26:47,333 - INFO - Fetching PSX constituents data for date: 2024-10-11
2024-10-13 00:26:47,333 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:26:49,395 - INFO - Inserted or updated 544 PSX constituent records into the database.
2024-10-13 00:26:49,395 - INFO - Performing search operations on PSX constituents.
2024-10-13 00:26:49,396 - INFO - Search results for company 'Al-Abbas': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:26:49,396 - INFO - Search results for symbol 'AABS': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:26:49,397 - INFO - ---- Portfolio Management Operations ----
2024-10-13 00:26:49,397 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-13 00:26:49,397 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-13 00:26:49,397 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 00:26:49,397 - INFO - Existing Portfolios:
2024-10-13 00:26:49,398 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-13 00:26:49,398 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:26:49,398 - INFO - Portfolio ID '1' updated successfully to 'Tech Leaders'.
2024-10-13 00:26:49,398 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:26:49,398 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:26:49,398 - INFO - Retrieved 0 portfolios from the database.
2024-10-13 00:26:49,398 - INFO - No portfolios remaining after deletion.
2024-10-13 00:26:49,399 - INFO - ---- End of Portfolio Management Operations ----
2024-10-13 00:26:49,399 - INFO - Fetching PSX transaction data for date: 2024-10-11
2024-10-13 00:26:50,168 - INFO - CSV data fetched successfully.
2024-10-13 00:26:50,187 - ERROR - An unexpected error occurred: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "d:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 1079, in main
    if transaction_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\imran\AppData\Roaming\Python\Python312\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2024-10-13 00:26:50,236 - INFO - In-memory database connection closed.
2024-10-13 00:38:39,449 - INFO - Initializing in-memory database for testing...
2024-10-13 00:38:39,456 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-13 00:38:39,457 - INFO - In-memory database initialized successfully.
2024-10-13 00:38:39,457 - INFO - Fetching PSX constituents data for date: 2024-10-11
2024-10-13 00:38:39,457 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:38:40,918 - INFO - Inserted or updated 544 PSX constituent records into the database.
2024-10-13 00:38:40,918 - INFO - Performing search operations on PSX constituents.
2024-10-13 00:38:40,918 - INFO - Search results for company 'Al-Abbas': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:38:40,918 - INFO - Search results for symbol 'AABS': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:38:40,918 - INFO - ---- Portfolio Management Operations ----
2024-10-13 00:38:40,919 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-13 00:38:40,919 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-13 00:38:40,919 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 00:38:40,919 - INFO - Existing Portfolios:
2024-10-13 00:38:40,919 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-13 00:38:40,919 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:38:40,920 - INFO - Portfolio ID '1' updated successfully to 'Tech Leaders'.
2024-10-13 00:38:40,920 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:38:40,920 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:38:40,920 - INFO - Retrieved 0 portfolios from the database.
2024-10-13 00:38:40,921 - INFO - No portfolios remaining after deletion.
2024-10-13 00:38:40,921 - INFO - ---- End of Portfolio Management Operations ----
2024-10-13 00:38:40,921 - INFO - Fetching PSX transaction data for date: 2024-10-11
2024-10-13 00:38:42,183 - INFO - CSV data fetched successfully.
2024-10-13 00:38:42,201 - INFO - Inserting transaction data for 2024-10-11 into the database.
2024-10-13 00:38:42,201 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-13 00:38:42,205 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-13 00:38:42,205 - INFO - Fetching table structure for 'Transactions'...
2024-10-13 00:38:42,205 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-13 00:38:42,205 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-13 00:38:42,206 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - Inserted 39 transaction records into the database.
2024-10-13 00:38:42,207 - INFO - Retrieving transaction data for date: 2024-10-11
2024-10-13 00:38:42,207 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-13 00:38:42,207 - INFO - Fetching transactions for date: 2024-10-11
2024-10-13 00:38:42,207 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:38:42,226 - INFO - Fetched Transaction Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:38:42,227 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12.
2024-10-13 00:38:42,227 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-13 00:38:42,227 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-13 00:38:42,227 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:38:42,243 - INFO - Fetched Transaction Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:38:42,243 - INFO - Inserting market watch data into the database.
2024-10-13 00:38:42,244 - INFO - Fetching market watch data...
2024-10-13 00:38:43,924 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:38:43,925 - INFO - Fetched 960 market watch records.
2024-10-13 00:38:43,933 - INFO - Inserting batch 1 with 100 records.
2024-10-13 00:38:43,935 - INFO - Inserting batch 2 with 100 records.
2024-10-13 00:38:43,936 - INFO - Inserting batch 3 with 100 records.
2024-10-13 00:38:43,937 - INFO - Inserting batch 4 with 100 records.
2024-10-13 00:38:43,938 - INFO - Inserting batch 5 with 100 records.
2024-10-13 00:38:43,941 - INFO - Inserting batch 6 with 100 records.
2024-10-13 00:38:43,943 - INFO - Inserting batch 7 with 100 records.
2024-10-13 00:38:43,945 - INFO - Inserting batch 8 with 100 records.
2024-10-13 00:38:43,947 - INFO - Inserting batch 9 with 100 records.
2024-10-13 00:38:43,948 - INFO - Inserting batch 10 with 60 records.
2024-10-13 00:38:43,952 - INFO - Successfully inserted/updated 960 records for market watch data.
2024-10-13 00:38:43,952 - INFO - Total records in the MarketWatch table: 960
2024-10-13 00:38:43,953 - INFO - Successfully inserted/updated 960 market watch records into the database.
2024-10-13 00:38:43,953 - INFO - ---- Market Insights ----
2024-10-13 00:38:43,954 - INFO - Fetching top 10 advancers.
2024-10-13 00:38:43,954 - INFO - Top 10 Advancers:
2024-10-13 00:38:43,955 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-13 00:38:43,955 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-13 00:38:43,955 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:38:43,955 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:38:43,955 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-13 00:38:43,956 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-13 00:38:43,956 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-13 00:38:43,957 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:38:43,957 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:38:43,957 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:38:43,957 - INFO - --------------------------------------------------
2024-10-13 00:38:43,959 - INFO - Fetching top 10 decliners.
2024-10-13 00:38:43,960 - INFO - Top 10 Decliners:
2024-10-13 00:38:43,960 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:38:43,961 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:38:43,961 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:38:43,961 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-13 00:38:43,962 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-13 00:38:43,962 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:38:43,962 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:38:43,962 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:38:43,963 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:38:43,963 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:38:43,963 - INFO - --------------------------------------------------
2024-10-13 00:38:43,963 - INFO - Fetching top 10 most active stocks.
2024-10-13 00:38:43,964 - INFO - Top 10 Most Active Stocks:
2024-10-13 00:38:43,964 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,965 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,965 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,965 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,965 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,966 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,966 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,968 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,968 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,969 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,969 - INFO - --------------------------------------------------
2024-10-13 00:38:43,970 - INFO - Fetching listings data.
2024-10-13 00:38:45,315 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:38:45,315 - INFO - Successfully retrieved 453 listings records.
2024-10-13 00:38:45,316 - INFO - --------------------------------------------------
2024-10-13 00:38:45,318 - INFO - Fetching defaulters data.
2024-10-13 00:38:46,253 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:38:46,254 - INFO - Successfully retrieved 96 defaulters records.
2024-10-13 00:38:46,254 - INFO - --------------------------------------------------
2024-10-13 00:38:46,255 - INFO - Merging market watch, listings, and defaulters data.
2024-10-13 00:38:46,257 - INFO - Successfully merged data into 554 records.
2024-10-13 00:38:46,258 - INFO - --------------------------------------------------
2024-10-13 00:38:46,259 - INFO - In-memory database connection closed.
2024-10-13 00:47:12,683 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 00:47:20,648 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 00:47:20,653 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 00:47:20,655 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-13 00:47:21,383 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-13 00:47:21,384 - ERROR - Failed to retrieve data for ticker 'ABL'.
2024-10-13 00:47:21,386 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-13 00:47:21,851 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-13 00:47:21,853 - ERROR - Failed to retrieve data for ticker 'AIRLINK'.
2024-10-13 00:47:21,855 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-13 00:47:22,361 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-13 00:47:22,364 - ERROR - Failed to retrieve data for ticker 'FATIMA'.
2024-10-13 00:47:22,366 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-13 00:47:22,808 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-13 00:47:22,810 - ERROR - Failed to retrieve data for ticker 'HUBC'.
2024-10-13 00:47:22,814 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-13 00:47:23,279 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-13 00:47:23,281 - ERROR - Failed to retrieve data for ticker 'MCB'.
2024-10-13 00:47:23,283 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-13 00:47:23,773 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-13 00:47:23,774 - ERROR - Failed to retrieve data for ticker 'OGDC'.
2024-10-13 00:47:23,775 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-13 00:47:24,223 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-13 00:47:24,224 - ERROR - Failed to retrieve data for ticker 'PPL'.
2024-10-13 00:47:24,226 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-13 00:47:24,674 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-13 00:47:24,675 - ERROR - Failed to retrieve data for ticker 'PSO'.
2024-10-13 00:47:24,677 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-13 00:47:25,192 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-13 00:47:25,193 - ERROR - Failed to retrieve data for ticker 'PTC'.
2024-10-13 00:47:25,195 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-13 00:47:25,616 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-13 00:47:25,617 - ERROR - Failed to retrieve data for ticker 'SEARL'.
2024-10-13 00:47:25,619 - INFO - Database synchronization complete.
2024-10-13 00:59:05,099 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 00:59:25,415 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:04:37,132 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:04:58,542 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:05:00,296 - INFO - Retrieved 960 records from market watch.
2024-10-13 01:16:47,088 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:16:54,830 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:16:56,755 - INFO - Retrieved 855 index symbols.
2024-10-13 01:20:48,743 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:20:54,099 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:20:54,142 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:20:54,234 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-13 01:20:54,913 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-13 01:20:54,928 - ERROR - Failed to retrieve data for ticker 'ABL'.
2024-10-13 01:20:54,932 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-13 01:20:55,376 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-13 01:20:55,385 - ERROR - Failed to retrieve data for ticker 'AIRLINK'.
2024-10-13 01:20:55,402 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-13 01:20:55,925 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-13 01:20:55,982 - ERROR - Failed to retrieve data for ticker 'FATIMA'.
2024-10-13 01:20:55,994 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-13 01:20:56,425 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-13 01:20:56,466 - ERROR - Failed to retrieve data for ticker 'HUBC'.
2024-10-13 01:20:56,470 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-13 01:20:56,951 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-13 01:20:56,952 - ERROR - Failed to retrieve data for ticker 'MCB'.
2024-10-13 01:20:56,954 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-13 01:20:57,411 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-13 01:20:57,412 - ERROR - Failed to retrieve data for ticker 'OGDC'.
2024-10-13 01:20:57,414 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-13 01:20:57,886 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-13 01:20:57,899 - ERROR - Failed to retrieve data for ticker 'PPL'.
2024-10-13 01:20:57,937 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-13 01:20:58,411 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-13 01:20:58,413 - ERROR - Failed to retrieve data for ticker 'PSO'.
2024-10-13 01:20:58,417 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-13 01:20:58,879 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-13 01:20:58,888 - ERROR - Failed to retrieve data for ticker 'PTC'.
2024-10-13 01:20:58,896 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-13 01:20:59,402 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-13 01:20:59,403 - ERROR - Failed to retrieve data for ticker 'SEARL'.
2024-10-13 01:20:59,406 - INFO - Database synchronization complete.
2024-10-13 01:21:07,359 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:07,368 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:22,211 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:22,284 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:33,989 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:34,109 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:35,650 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:35,674 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:37,103 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:37,112 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:38,114 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:38,135 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:38,650 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:38,667 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:39,138 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:39,160 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:39,576 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:39,600 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:40,182 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:40,199 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:40,982 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:41,018 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:41,773 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:41,790 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:44,405 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:44,418 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:44,475 - INFO - Portfolio 'alpha' created with stocks: HUBC,FATIMA,AIRLINK,ABL,OGDC,PSO,SEARL,PTC,PPL,MCB.
2024-10-13 01:21:44,516 - INFO - Portfolio 'alpha' created with tickers: ['HUBC', 'FATIMA', 'AIRLINK', 'ABL', 'OGDC', 'PSO', 'SEARL', 'PTC', 'PPL', 'MCB'].
2024-10-13 01:21:52,445 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:52,475 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:22:04,606 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:22:13,035 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:22:13,062 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:22:18,181 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:22:18,199 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 01:37:03,978 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:15,324 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:16,743 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:16,801 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:16,974 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-13 01:37:17,667 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-13 01:37:17,668 - ERROR - Failed to retrieve data for ticker 'ABL'.
2024-10-13 01:37:17,669 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-13 01:37:18,163 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-13 01:37:18,169 - ERROR - Failed to retrieve data for ticker 'AIRLINK'.
2024-10-13 01:37:18,177 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-13 01:37:18,626 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-13 01:37:18,629 - ERROR - Failed to retrieve data for ticker 'FATIMA'.
2024-10-13 01:37:18,638 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-13 01:37:19,096 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-13 01:37:19,109 - ERROR - Failed to retrieve data for ticker 'HUBC'.
2024-10-13 01:37:19,159 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-13 01:37:19,593 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-13 01:37:19,594 - ERROR - Failed to retrieve data for ticker 'MCB'.
2024-10-13 01:37:19,598 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-13 01:37:20,038 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-13 01:37:20,038 - ERROR - Failed to retrieve data for ticker 'OGDC'.
2024-10-13 01:37:20,041 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-13 01:37:20,453 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-13 01:37:20,454 - ERROR - Failed to retrieve data for ticker 'PPL'.
2024-10-13 01:37:20,455 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-13 01:37:20,966 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-13 01:37:20,971 - ERROR - Failed to retrieve data for ticker 'PSO'.
2024-10-13 01:37:20,975 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-13 01:37:21,472 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-13 01:37:21,476 - ERROR - Failed to retrieve data for ticker 'PTC'.
2024-10-13 01:37:21,490 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-13 01:37:21,973 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-13 01:37:21,974 - ERROR - Failed to retrieve data for ticker 'SEARL'.
2024-10-13 01:37:21,976 - INFO - Database synchronization complete.
2024-10-13 01:37:25,326 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:25,340 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:31,069 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:31,077 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:32,317 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:32,348 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:32,750 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:32,758 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:33,230 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:33,241 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:35,007 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:35,017 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:35,020 - ERROR - Failed to create portfolio 'alpha': UNIQUE constraint failed: Portfolios.Name
2024-10-13 01:37:35,025 - ERROR - Failed to create portfolio 'alpha'.
2024-10-13 01:37:44,405 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:44,413 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:44,487 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:44,496 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:44,509 - INFO - Portfolio 'beta' created with stocks: FATIMA,MCB,PSO.
2024-10-13 01:37:44,525 - INFO - Portfolio 'beta' created with tickers: ['FATIMA', 'MCB', 'PSO'].
2024-10-13 01:37:57,889 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:57,895 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:38:03,044 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:38:03,048 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:38:03,056 - INFO - Retrieved 2 portfolios from the database.
2024-10-13 01:38:03,061 - INFO - Retrieved portfolio 'alpha' with ID 1.
2024-10-13 01:38:03,064 - INFO - Selected Portfolio 'alpha' with tickers: [].
2024-10-13 01:38:06,383 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:38:06,402 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:38:06,412 - INFO - Retrieved 2 portfolios from the database.
2024-10-13 01:38:06,413 - INFO - Retrieved portfolio 'beta' with ID 2.
2024-10-13 01:38:06,461 - INFO - Selected Portfolio 'beta' with tickers: [].
2024-10-13 01:38:11,734 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:38:11,747 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:38:11,850 - INFO - Retrieved 2 portfolios from the database.
2024-10-13 01:38:11,952 - INFO - Retrieved portfolio 'alpha' with ID 1.
2024-10-13 01:38:12,004 - INFO - Selected Portfolio 'alpha' with tickers: [].
2024-10-13 01:38:18,840 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:38:18,846 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:50:20,317 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:50:28,288 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:50:28,293 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:50:28,296 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-13 01:50:28,790 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-13 01:50:28,792 - ERROR - Failed to retrieve data for ticker 'ABL'.
2024-10-13 01:50:28,793 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-13 01:50:29,235 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-13 01:50:29,237 - ERROR - Failed to retrieve data for ticker 'AIRLINK'.
2024-10-13 01:50:29,238 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-13 01:50:29,680 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-13 01:50:29,681 - ERROR - Failed to retrieve data for ticker 'FATIMA'.
2024-10-13 01:50:29,682 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-13 01:50:30,113 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-13 01:50:30,114 - ERROR - Failed to retrieve data for ticker 'HUBC'.
2024-10-13 01:50:30,115 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-13 01:50:30,553 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-13 01:50:30,555 - ERROR - Failed to retrieve data for ticker 'MCB'.
2024-10-13 01:50:30,558 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-13 01:50:31,011 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-13 01:50:31,013 - ERROR - Failed to retrieve data for ticker 'OGDC'.
2024-10-13 01:50:31,015 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-13 01:50:31,500 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-13 01:50:31,502 - ERROR - Failed to retrieve data for ticker 'PPL'.
2024-10-13 01:50:31,505 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-13 01:50:31,983 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-13 01:50:31,984 - ERROR - Failed to retrieve data for ticker 'PSO'.
2024-10-13 01:50:31,988 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-13 01:50:32,771 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-13 01:50:32,772 - ERROR - Failed to retrieve data for ticker 'PTC'.
2024-10-13 01:50:32,773 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-13 01:50:33,224 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-13 01:50:33,225 - ERROR - Failed to retrieve data for ticker 'SEARL'.
2024-10-13 01:50:33,227 - INFO - Database synchronization complete.
2024-10-13 01:50:38,478 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:50:38,801 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:50:41,450 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:50:41,453 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:50:42,454 - INFO - Analysis for ticker 'ABL' completed successfully.
2024-10-13 01:50:42,501 - INFO - Analysis for ticker 'AIRLINK' completed successfully.
2024-10-13 01:50:42,552 - INFO - Analysis for ticker 'FATIMA' completed successfully.
2024-10-13 01:50:42,619 - INFO - Analysis for ticker 'HUBC' completed successfully.
2024-10-13 01:50:42,659 - INFO - Analysis for ticker 'MCB' completed successfully.
2024-10-13 01:50:42,705 - INFO - Analysis for ticker 'OGDC' completed successfully.
2024-10-13 01:50:42,752 - INFO - Analysis for ticker 'PPL' completed successfully.
2024-10-13 01:50:42,791 - INFO - Analysis for ticker 'PSO' completed successfully.
2024-10-13 01:50:42,836 - INFO - Analysis for ticker 'PTC' completed successfully.
2024-10-13 01:50:42,880 - INFO - Analysis for ticker 'SEARL' completed successfully.
2024-10-13 01:50:52,376 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:34,569 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:34,692 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:34,699 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:51:35,490 - INFO - Retrieved 1182 records for ticker 'HUMNL'.
2024-10-13 01:51:35,518 - INFO - Prepared 1182 valid records for insertion for ticker 'HUMNL'.
2024-10-13 01:51:35,518 - INFO - Inserting batch 1 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,527 - INFO - Batch 1 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,529 - INFO - Inserting batch 2 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,534 - INFO - Batch 2 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,534 - INFO - Inserting batch 3 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,538 - INFO - Batch 3 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,552 - INFO - Inserting batch 4 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,561 - INFO - Batch 4 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,565 - INFO - Inserting batch 5 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,568 - INFO - Batch 5 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,576 - INFO - Inserting batch 6 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,579 - INFO - Batch 6 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,581 - INFO - Inserting batch 7 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,584 - INFO - Batch 7 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,585 - INFO - Inserting batch 8 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,591 - INFO - Batch 8 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,598 - INFO - Inserting batch 9 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,602 - INFO - Batch 9 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,608 - INFO - Inserting batch 10 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,614 - INFO - Batch 10 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,616 - INFO - Inserting batch 11 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,620 - INFO - Batch 11 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,625 - INFO - Inserting batch 12 for ticker 'HUMNL' with 82 records.
2024-10-13 01:51:35,629 - INFO - Batch 12 inserted 82 records (may include ignored records).
2024-10-13 01:51:35,630 - INFO - Added 1182 records for ticker 'HUMNL'.
2024-10-13 01:51:35,631 - INFO - Total records in the database for ticker 'HUMNL': 1182
2024-10-13 01:51:35,633 - INFO - Added 1182 records for ticker 'HUMNL'.
2024-10-13 01:51:42,659 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:42,673 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:51:44,385 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:44,389 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:51:44,436 - INFO - Analysis for ticker 'ABL' completed successfully.
2024-10-13 01:51:44,501 - INFO - Analysis for ticker 'AIRLINK' completed successfully.
2024-10-13 01:51:44,588 - INFO - Analysis for ticker 'FATIMA' completed successfully.
2024-10-13 01:51:44,637 - INFO - Analysis for ticker 'HUBC' completed successfully.
2024-10-13 01:51:44,703 - INFO - Analysis for ticker 'HUMNL' completed successfully.
2024-10-13 01:51:44,772 - INFO - Analysis for ticker 'MCB' completed successfully.
2024-10-13 01:51:44,820 - INFO - Analysis for ticker 'OGDC' completed successfully.
2024-10-13 01:51:44,889 - INFO - Analysis for ticker 'PPL' completed successfully.
2024-10-13 01:51:44,938 - INFO - Analysis for ticker 'PSO' completed successfully.
2024-10-13 01:51:44,982 - INFO - Analysis for ticker 'PTC' completed successfully.
2024-10-13 01:51:45,033 - INFO - Analysis for ticker 'SEARL' completed successfully.
