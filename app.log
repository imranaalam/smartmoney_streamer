2024-10-12 23:21:05,707 - INFO - Initializing in-memory database for testing...
2024-10-12 23:21:05,710 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-12 23:21:05,710 - INFO - ---- Portfolio Management ----
2024-10-12 23:21:05,711 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-12 23:21:05,711 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-12 23:21:05,711 - INFO - Retrieved 1 portfolios from the database.
2024-10-12 23:21:05,711 - INFO - Existing Portfolios:
2024-10-12 23:21:05,711 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-12 23:21:05,712 - INFO - Portfolio ID '1' updated successfully.
2024-10-12 23:21:05,712 - INFO - Portfolio ID '1' updated successfully.
2024-10-12 23:21:05,712 - INFO - Portfolio ID '1' deleted successfully.
2024-10-12 23:21:05,712 - INFO - Portfolio ID '1' deleted successfully.
2024-10-12 23:21:05,712 - INFO - Retrieved 0 portfolios from the database.
2024-10-12 23:21:05,712 - INFO - Portfolios after deletion:
2024-10-12 23:21:05,715 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-12 23:21:06,652 - INFO - CSV data fetched successfully.
2024-10-12 23:21:06,674 - INFO - Inserting transaction data for 2024-10-11 into the database...
2024-10-12 23:21:06,674 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-12 23:21:06,680 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-12 23:21:06,680 - INFO - Fetching table structure for 'Transactions'...
2024-10-12 23:21:06,680 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-12 23:21:06,680 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-12 23:21:06,680 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-12 23:21:06,681 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-12 23:21:06,681 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-12 23:21:06,682 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-12 23:21:06,683 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-12 23:21:06,683 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-12 23:21:06,683 - INFO - Fetching transaction data from 2024-10-11 to 2024-10-11 from the database...
2024-10-12 23:21:06,684 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-12 23:21:06,684 - INFO - Fetching transactions for date: 2024-10-11
2024-10-12 23:21:06,684 - INFO - Retrieved 33 records from Transactions table.
2024-10-12 23:21:06,705 - INFO - Fetched Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-12 23:21:06,706 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12 from the database...
2024-10-12 23:21:06,706 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-12 23:21:06,706 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-12 23:21:06,707 - INFO - Retrieved 33 records from Transactions table.
2024-10-12 23:21:06,733 - INFO - Fetched Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-12 23:21:06,733 - INFO - Fetching market watch data...
2024-10-12 23:21:08,545 - INFO - Retrieved 960 records from market watch.
2024-10-12 23:21:08,547 - INFO - Fetched 960 market watch records.
2024-10-12 23:21:08,547 - INFO - Inserting market watch data into the database...
2024-10-12 23:21:08,558 - INFO - Prepared 960 valid records for market watch insertion.
2024-10-12 23:21:08,559 - INFO - Inserting batch 1 with 100 records.
2024-10-12 23:21:08,606 - INFO - Batch 1 inserted 100 records (may include updates).
2024-10-12 23:21:08,607 - INFO - Inserting batch 2 with 100 records.
2024-10-12 23:21:08,610 - INFO - Batch 2 inserted 100 records (may include updates).
2024-10-12 23:21:08,610 - INFO - Inserting batch 3 with 100 records.
2024-10-12 23:21:08,614 - INFO - Batch 3 inserted 100 records (may include updates).
2024-10-12 23:21:08,615 - INFO - Inserting batch 4 with 100 records.
2024-10-12 23:21:08,615 - INFO - Batch 4 inserted 100 records (may include updates).
2024-10-12 23:21:08,616 - INFO - Inserting batch 5 with 100 records.
2024-10-12 23:21:08,616 - INFO - Batch 5 inserted 100 records (may include updates).
2024-10-12 23:21:08,617 - INFO - Inserting batch 6 with 100 records.
2024-10-12 23:21:08,617 - INFO - Batch 6 inserted 100 records (may include updates).
2024-10-12 23:21:08,617 - INFO - Inserting batch 7 with 100 records.
2024-10-12 23:21:08,618 - INFO - Batch 7 inserted 100 records (may include updates).
2024-10-12 23:21:08,618 - INFO - Inserting batch 8 with 100 records.
2024-10-12 23:21:08,619 - INFO - Batch 8 inserted 100 records (may include updates).
2024-10-12 23:21:08,619 - INFO - Inserting batch 9 with 100 records.
2024-10-12 23:21:08,623 - INFO - Batch 9 inserted 100 records (may include updates).
2024-10-12 23:21:08,623 - INFO - Inserting batch 10 with 60 records.
2024-10-12 23:21:08,624 - INFO - Batch 10 inserted 60 records (may include updates).
2024-10-12 23:21:08,624 - INFO - Added 960 records for market watch data.
2024-10-12 23:21:08,625 - INFO - Total records in the MarketWatch table: 960
2024-10-12 23:21:08,625 - INFO - Successfully inserted 960 market watch records into the database.
2024-10-12 23:21:08,625 - INFO - Fetching top 10 advancers...
2024-10-12 23:21:08,626 - INFO - Top 10 Advancers:
2024-10-12 23:21:08,626 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-12 23:21:08,626 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-12 23:21:08,628 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-12 23:21:08,629 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-12 23:21:08,629 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-12 23:21:08,629 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-12 23:21:08,629 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-12 23:21:08,630 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 23:21:08,630 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 23:21:08,630 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 23:21:08,630 - INFO - --------------------------------------------------
2024-10-12 23:21:08,630 - INFO - Fetching top 10 decliners...
2024-10-12 23:21:08,631 - INFO - Top 10 Decliners:
2024-10-12 23:21:08,631 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 23:21:08,631 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 23:21:08,631 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 23:21:08,632 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-12 23:21:08,632 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-12 23:21:08,632 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 23:21:08,668 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 23:21:08,669 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 23:21:08,671 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-12 23:21:08,673 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-12 23:21:08,674 - INFO - --------------------------------------------------
2024-10-12 23:21:08,677 - INFO - Fetching top 10 most active stocks...
2024-10-12 23:21:08,678 - INFO - Top 10 Most Active Stocks:
2024-10-12 23:21:08,678 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,678 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,678 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,678 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,708 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,708 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,708 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,708 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,709 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,709 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 23:21:08,709 - INFO - --------------------------------------------------
2024-10-12 23:21:08,709 - INFO - Fetching listings data...
2024-10-12 23:21:10,750 - INFO - Retrieved 453 records from listings data.
2024-10-12 23:21:10,750 - INFO - Successfully retrieved 453 listings records.
2024-10-12 23:21:10,750 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-12 23:21:10,751 - INFO - --------------------------------------------------
2024-10-12 23:21:10,751 - INFO - Fetching defaulters data...
2024-10-12 23:21:11,988 - INFO - Retrieved 96 records from defaulters list.
2024-10-12 23:21:11,988 - INFO - Successfully retrieved 96 defaulters records.
2024-10-12 23:21:11,988 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-12 23:21:11,988 - INFO - --------------------------------------------------
2024-10-12 23:21:11,989 - INFO - Merging market watch, listings, and defaulters data...
2024-10-12 23:21:11,990 - INFO - Successfully merged data into 551 records.
2024-10-12 23:21:11,990 - INFO - Sample Merged Data (Defaulter Info Included): [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'UPP9', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761, 'NAME': 'The Hub Power Company Limited', 'SHARES': 1297154400, 'FREE FLOAT': 972865790, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'PTC', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'KSE100', 'LDCP': 14.52, 'OPEN': 14.75, 'HIGH': 15.97, 'LOW': 13.96, 'CURRENT': 15.7, 'CHANGE': 1.18, 'CHANGE (%)': 8.13, 'VOLUME': 51351566, 'NAME': 'Pakistan Telecommunication Company Ltd', 'SHARES': 3774000000, 'FREE FLOAT': 593190667, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'WTL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 1.2, 'OPEN': 1.21, 'HIGH': 1.21, 'LOW': 1.18, 'CURRENT': 1.18, 'CHANGE': -0.02, 'CHANGE (%)': -1.67, 'VOLUME': 45693545, 'NAME': 'Worldcall Telecom Limited', 'SHARES': 4982289186, 'FREE FLOAT': 3736716890, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'HUMNL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 12.33, 'OPEN': 12.5, 'HIGH': 13.56, 'LOW': 12.02, 'CURRENT': 13.56, 'CHANGE': 1.23, 'CHANGE (%)': 9.98, 'VOLUME': 32955417, 'NAME': 'Hum Network Limited', 'SHARES': 1134000000, 'FREE FLOAT': 567000000, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'KOSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'KSE100', 'LDCP': 8.02, 'OPEN': 8.0, 'HIGH': 8.0, 'LOW': 7.02, 'CURRENT': 7.07, 'CHANGE': -0.95, 'CHANGE (%)': -11.85, 'VOLUME': 25957843, 'NAME': 'Kohinoor Spinning Mills Limited', 'SHARES': 412106785, 'FREE FLOAT': 226658732, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}]
2024-10-12 23:21:11,990 - INFO - --------------------------------------------------
2024-10-12 23:21:11,991 - INFO - In-memory database closed after testing.
2024-10-12 23:32:05,146 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 00:12:57,530 - INFO - --------------------------------------------------
2024-10-13 00:12:57,530 - INFO - Fetching PSX constituent data for 2024-10-11...
2024-10-13 00:12:57,531 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:12:59,034 - ERROR - Error fetching PSX data: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
2024-10-13 00:12:59,035 - ERROR - Failed to fetch PSX constituent data or no data available.
2024-10-13 00:16:47,233 - INFO - --------------------------------------------------
2024-10-13 00:16:47,233 - INFO - Fetching PSX constituent data for 2024-10-11...
2024-10-13 00:16:47,233 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:16:48,727 - INFO - Fetched 544 rows of PSX constituent data.
2024-10-13 00:16:48,727 - INFO - Sample PSX Constituent Data:
[{'ISIN': 'PK0061101017', 'SYMBOL': '786', 'COMPANY': '786 Investments Limited', 'PRICE': 6.0, 'IDX WT %': 0.0008053619738181293, 'FF BASED SHARES': 5240813, 'FF BASED MCAP': 31444878.0, 'ORD SHARES': 14973750, 'ORD SHARES MCAP': 89842500.0, 'VOLUME': 26}, {'ISIN': 'PK0050501011', 'SYMBOL': 'AABS', 'COMPANY': 'Al-Abbas Sugar Mills Limited', 'PRICE': 610.67, 'IDX WT %': 0.09504365582042357, 'FF BASED SHARES': 1736230, 'FF BASED MCAP': 1060263574.1, 'ORD SHARES': 17362300, 'ORD SHARES MCAP': 10602635741.0, 'VOLUME': 468}, {'ISIN': 'PK0015401018', 'SYMBOL': 'AAL', 'COMPANY': 'Agro Allianz Limited', 'PRICE': 16.0, 'IDX WT %': 0.00016970218547731608, 'FF BASED SHARES': 0, 'FF BASED MCAP': 0.0, 'ORD SHARES': 1183200, 'ORD SHARES MCAP': 18931200.0, 'VOLUME': 0}, {'ISIN': 'PK0036101019', 'SYMBOL': 'AASM', 'COMPANY': 'Al-Abid Silk Mills Limited', 'PRICE': 3.49, 'IDX WT %': 0.0004195163801039042, 'FF BASED SHARES': 2681910, 'FF BASED MCAP': 9359865.9, 'ORD SHARES': 13409550, 'ORD SHARES MCAP': 46799329.5, 'VOLUME': 0}, {'ISIN': 'PK0011501019', 'SYMBOL': 'AATM', 'COMPANY': 'Ali Asghar Textile Mills Limited', 'PRICE': 57.77, 'IDX WT %': 0.023006770260956922, 'FF BASED SHARES': 926222, 'FF BASED MCAP': 53507844.94, 'ORD SHARES': 44426694, 'ORD SHARES MCAP': 2566530112.38, 'VOLUME': 1214}]
2024-10-13 00:16:48,727 - INFO - --------------------------------------------------
2024-10-13 00:16:48,727 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-13 00:16:49,548 - INFO - CSV data fetched successfully.
2024-10-13 00:16:49,568 - INFO - Fetched 39 rows of transaction data.
2024-10-13 00:16:49,582 - INFO - Sample Transaction Data:
         Date Settlement Date  ... Buyer Code Seller Code
0  2024-10-11      2024-10-15  ...       None        None
1  2024-10-11      2024-10-15  ...       None        None
2  2024-10-11      2024-10-14  ...       None        None
3  2024-10-11      2024-10-15  ...       None        None
4  2024-10-11      2024-10-14  ...       None        None

[5 rows x 11 columns]
2024-10-13 00:16:49,582 - INFO - Fetching stock data...
2024-10-13 00:16:50,475 - INFO - Retrieved 248 records for ticker 'MCB'.
2024-10-13 00:16:50,476 - INFO - Successfully retrieved stock data for 'MCB' from 01 Jan 2022 to 31 Dec 2022
2024-10-13 00:16:50,476 - INFO - Sample Stock Data: [{'Date_': '2022-01-03T00:00:00', 'Open': 152.8, 'High': 154.2, 'Low': 152.4, 'Close': 154.06, 'Change': 0.7099915, 'change_valueP': 0.46298758437956006, 'ChangeP': 0.46298758437956006, 'Volume': 502411.0}, {'Date_': '2022-01-04T00:00:00', 'Open': 154.0, 'High': 154.49, 'Low': 153.5, 'Close': 153.69, 'Change': -0.3699951, 'change_valueP': -0.2401629960846338, 'ChangeP': -0.2401629960846338, 'Volume': 233074.0}, {'Date_': '2022-01-05T00:00:00', 'Open': 153.7, 'High': 154.45, 'Low': 153.0, 'Close': 153.91, 'Change': 0.2200012, 'change_valueP': 0.14314607438203716, 'ChangeP': 0.14314607438203716, 'Volume': 345748.0}, {'Date_': '2022-01-06T00:00:00', 'Open': 154.4, 'High': 154.4, 'Low': 153.07, 'Close': 154.13, 'Change': 0.2200012, 'change_valueP': 0.14294146040887373, 'ChangeP': 0.14294146040887373, 'Volume': 301734.0}, {'Date_': '2022-01-07T00:00:00', 'Open': 154.5, 'High': 155.7, 'Low': 154.0, 'Close': 154.94, 'Change': 0.8099976, 'change_valueP': 0.5255288311083554, 'ChangeP': 0.5255288311083554, 'Volume': 296075.0}]
2024-10-13 00:16:50,476 - INFO - --------------------------------------------------
2024-10-13 00:16:50,476 - INFO - Fetching KSE symbols...
2024-10-13 00:16:51,331 - INFO - Retrieved 0 index symbols.
2024-10-13 00:16:51,332 - ERROR - Failed to retrieve KSE symbols.
2024-10-13 00:16:51,332 - INFO - --------------------------------------------------
2024-10-13 00:16:51,332 - INFO - Fetching market watch data...
2024-10-13 00:16:53,252 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:16:53,254 - INFO - Successfully retrieved market watch data.
2024-10-13 00:16:53,256 - INFO - Sample Market Watch Data: [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}]
2024-10-13 00:16:53,258 - INFO - --------------------------------------------------
2024-10-13 00:16:53,258 - INFO - Fetching ticker market details...
2024-10-13 00:16:54,223 - INFO - Retrieved 6 constituents for index 'JSGBKTI'.
2024-10-13 00:16:54,223 - INFO - Successfully retrieved market details for index 'JSGBKTI'
2024-10-13 00:16:54,223 - INFO - Sample Market Details: [{'SYMBOL': 'BAFL', 'NAME': 'Bank Alfalah Limited', 'LDCP': 66.98, 'CURRENT': 67.86, 'CHANGE': 0.88, 'CHANGE (%)': 1.314, 'IDX WTG (%)': '15.66%', 'IDX POINT': 48.5466, 'VOLUME': 278476, 'FREEFLOAT (M)': 1311284881.0, 'MARKET CAP (M)': 88983792024.66}, {'SYMBOL': 'BAHL', 'NAME': 'Bank AL Habib Limited', 'LDCP': 108.56, 'CURRENT': 108.61, 'CHANGE': 0.05, 'CHANGE (%)': 0.046, 'IDX WTG (%)': '15.19%', 'IDX POINT': 1.6725, 'VOLUME': 228606, 'FREEFLOAT (M)': 795093578.0, 'MARKET CAP (M)': 86355113506.58}, {'SYMBOL': 'HBL', 'NAME': 'Habib Bank Limited', 'LDCP': 137.64, 'CURRENT': 136.05, 'CHANGE': -1.59, 'CHANGE (%)': -1.155, 'IDX WTG (%)': '17.22%', 'IDX POINT': -48.1043, 'VOLUME': 4278696, 'FREEFLOAT (M)': 719129224.0, 'MARKET CAP (M)': 97837530925.20001}, {'SYMBOL': 'MCB', 'NAME': 'MCB Bank Limited', 'LDCP': 255.18, 'CURRENT': 257.42, 'CHANGE': 2.24, 'CHANGE (%)': 0.878, 'IDX WTG (%)': '17.80%', 'IDX POINT': 37.0251, 'VOLUME': 111653, 'FREEFLOAT (M)': 392888722.0, 'MARKET CAP (M)': 101137414817.24}, {'SYMBOL': 'MEBL', 'NAME': 'Meezan Bank Limited', 'LDCP': 240.95, 'CURRENT': 240.62, 'CHANGE': -0.33, 'CHANGE (%)': -0.13699999999999998, 'IDX WTG (%)': '15.77%', 'IDX POINT': -5.1728, 'VOLUME': 431871, 'FREEFLOAT (M)': 372586982.0, 'MARKET CAP (M)': 89651879608.84}]
2024-10-13 00:16:54,223 - INFO - --------------------------------------------------
2024-10-13 00:16:54,223 - INFO - Fetching index historical data...
2024-10-13 00:16:55,397 - INFO - Retrieved 268 historical data points for index 'JSGBKTI'.
2024-10-13 00:16:55,398 - INFO - Successfully retrieved historical data for index 'JSGBKTI'
2024-10-13 00:16:55,398 - INFO - Sample Historical Data: [[1728644400, 23910.2946, 6295789, 23834.4742], [1728558000, 23847.6234, 4476378, 24008.3819], [1728471600, 23988.239, 9972756, 23865.3907], [1728385200, 23804.1322, 16575084, 23058.9327], [1728298800, 23059.2174, 16509979, 22818.46]]
2024-10-13 00:16:55,398 - INFO - --------------------------------------------------
2024-10-13 00:16:55,398 - INFO - Fetching listings data...
2024-10-13 00:16:57,453 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:16:57,454 - INFO - Successfully retrieved listings data.
2024-10-13 00:16:57,456 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-13 00:16:57,458 - INFO - --------------------------------------------------
2024-10-13 00:16:57,460 - INFO - Fetching defaulters data...
2024-10-13 00:16:58,484 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:16:58,485 - INFO - Successfully retrieved defaulters list.
2024-10-13 00:16:58,485 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-13 00:16:58,485 - INFO - --------------------------------------------------
2024-10-13 00:16:58,485 - INFO - Merging market watch, listings, and defaulters data...
2024-10-13 00:16:58,486 - INFO - Successfully merged data.
2024-10-13 00:16:58,486 - INFO - Sample Merged Data (with Defaulter flag): [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'UPP9', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761, 'NAME': 'The Hub Power Company Limited', 'SHARES': 1297154400, 'FREE FLOAT': 972865790, 'DEFAULTER': False}, {'SYMBOL': 'PTC', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'KSE100', 'LDCP': 14.52, 'OPEN': 14.75, 'HIGH': 15.97, 'LOW': 13.96, 'CURRENT': 15.7, 'CHANGE': 1.18, 'CHANGE (%)': 8.13, 'VOLUME': 51351566, 'NAME': 'Pakistan Telecommunication Company Ltd', 'SHARES': 3774000000, 'FREE FLOAT': 593190667, 'DEFAULTER': False}, {'SYMBOL': 'WTL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 1.2, 'OPEN': 1.21, 'HIGH': 1.21, 'LOW': 1.18, 'CURRENT': 1.18, 'CHANGE': -0.02, 'CHANGE (%)': -1.67, 'VOLUME': 45693545, 'NAME': 'Worldcall Telecom Limited', 'SHARES': 4982289186, 'FREE FLOAT': 3736716890, 'DEFAULTER': False}, {'SYMBOL': 'HUMNL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 12.33, 'OPEN': 12.5, 'HIGH': 13.56, 'LOW': 12.02, 'CURRENT': 13.56, 'CHANGE': 1.23, 'CHANGE (%)': 9.98, 'VOLUME': 32955417, 'NAME': 'Hum Network Limited', 'SHARES': 1134000000, 'FREE FLOAT': 567000000, 'DEFAULTER': False}, {'SYMBOL': 'KOSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'KSE100', 'LDCP': 8.02, 'OPEN': 8.0, 'HIGH': 8.0, 'LOW': 7.02, 'CURRENT': 7.07, 'CHANGE': -0.95, 'CHANGE (%)': -11.85, 'VOLUME': 25957843, 'NAME': 'Kohinoor Spinning Mills Limited', 'SHARES': 412106785, 'FREE FLOAT': 226658732, 'DEFAULTER': False}]
2024-10-13 00:16:58,487 - INFO - --------------------------------------------------
2024-10-13 00:16:58,487 - INFO - 001: Altaf Adam Securities (Pvt.) Ltd.
2024-10-13 00:16:58,487 - INFO - 006: Sherman Securities (Pvt.) Ltd.
2024-10-13 00:16:58,487 - INFO - 008: Optimus Capital Management (Pvt.) Ltd.
2024-10-13 00:16:58,488 - INFO - 010: Sakarwala Capital Securities (Pvt.) Ltd.
2024-10-13 00:16:58,488 - INFO - 017: Summit Capital (Pvt.) Ltd.
2024-10-13 00:16:58,488 - INFO - 018: Ismail Iqbal Securities (Pvt.) Ltd.
2024-10-13 00:16:58,488 - INFO - 019: AKD Securities Ltd.
2024-10-13 00:16:58,489 - INFO - 021: Alpha Capital (Pvt.) Ltd.
2024-10-13 00:16:58,489 - INFO - 022: BMA Capital Management Ltd.
2024-10-13 00:16:58,489 - INFO - 025: Vector Securities (Pvt.) Ltd.
2024-10-13 00:16:58,489 - INFO - 027: Habib Metropolitan Financial Services
2024-10-13 00:16:58,489 - INFO - 037: H.H. Misbah Securities (Pvt.) Ltd.
2024-10-13 00:16:58,489 - INFO - 038: A.H.M. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,489 - INFO - 044: IGI Finex Securities Ltd.
2024-10-13 00:16:58,491 - INFO - 046: Fortune Securities Ltd.
2024-10-13 00:16:58,491 - INFO - 047: Zillion Capital Securities (Pvt.) Ltd.
2024-10-13 00:16:58,491 - INFO - 048: Next Capital Ltd.
2024-10-13 00:16:58,492 - INFO - 049: Multiline Securities Ltd.
2024-10-13 00:16:58,492 - INFO - 050: Arif Habib Ltd.
2024-10-13 00:16:58,492 - INFO - 058: Dawood Equities Ltd.
2024-10-13 00:16:58,492 - INFO - 062: WE Financial Services Ltd.
2024-10-13 00:16:58,492 - INFO - 063: Al-Habib Capital Markets (Pvt.) Ltd.
2024-10-13 00:16:58,492 - INFO - 068: Zafar Securities (Pvt.) Ltd.
2024-10-13 00:16:58,492 - INFO - 077: Bawany Securities (Pvt.) Ltd.
2024-10-13 00:16:58,492 - INFO - 084: Munir Khanani Securities Ltd.
2024-10-13 00:16:58,492 - INFO - 088: Fawad Yusuf Securities (Pvt.) Ltd.
2024-10-13 00:16:58,492 - INFO - 090: Darson Securities Private Limited.
2024-10-13 00:16:58,492 - INFO - 091: Intermarket Securities Ltd.
2024-10-13 00:16:58,493 - INFO - 092: Memon Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 094: FDM Capital Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 096: Msmaniar Financials (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 102: Growth Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 107: Seven Star Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 108: AZEE Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 112: Standard Capital Securities (Pvt.) Ltd.
2024-10-13 00:16:58,493 - INFO - 119: Axis Global Ltd.
2024-10-13 00:16:58,494 - INFO - 120: Alfalah Securities (Pvt.) Ltd.
2024-10-13 00:16:58,494 - INFO - 124: EFG Hermes Pakistan Ltd.
2024-10-13 00:16:58,494 - INFO - 129: Taurus Securities Ltd.
2024-10-13 00:16:58,494 - INFO - 140: M.M. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,494 - INFO - 142: Foundation Securities (Pvt.) Ltd.
2024-10-13 00:16:58,494 - INFO - 145: Adam Securities Ltd.
2024-10-13 00:16:58,494 - INFO - 149: JS Global Capital Ltd.
2024-10-13 00:16:58,495 - INFO - 159: Rafi Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 162: Aba Ali Habib Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 163: Friendly Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 164: Interactive Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 166: Topline Securities Ltd.
2024-10-13 00:16:58,495 - INFO - 169: Pearl Securities Ltd.
2024-10-13 00:16:58,495 - INFO - 173: Spectrum Securities Ltd.
2024-10-13 00:16:58,495 - INFO - 175: First National Equities Ltd.
2024-10-13 00:16:58,495 - INFO - 183: R.T. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 194: MRA Securities Ltd.
2024-10-13 00:16:58,495 - INFO - 199: Insight Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 248: Ktrade Securites Ltd.
2024-10-13 00:16:58,495 - INFO - 254: ShajarPak Securities (Pvt.) Ltd.
2024-10-13 00:16:58,495 - INFO - 275: Rahat Securities Ltd.
2024-10-13 00:16:58,496 - INFO - 293: Integrated Equities Ltd.
2024-10-13 00:16:58,496 - INFO - 311: Abbasi & Company (Pvt.) Ltd.
2024-10-13 00:16:58,496 - INFO - 332: Trust Securities & Brokerage Ltd.
2024-10-13 00:16:58,496 - INFO - 410: Zahid Latif Khan Securities (Pvt.) Ltd.
2024-10-13 00:16:58,496 - INFO - 524: Akik Capital (Pvt.) Ltd.
2024-10-13 00:16:58,496 - INFO - 525: Adam Usman Securities (Pvt.) Ltd.
2024-10-13 00:16:58,496 - INFO - 526: Chase Securities Pakistan (Pvt.) Ltd.
2024-10-13 00:16:58,497 - INFO - 528: H.G Markets (Private) Limited
2024-10-13 00:16:58,497 - INFO - 529: Orbit Securities (Pvt.) Ltd.
2024-10-13 00:16:58,497 - INFO - 531: T&G Securities Private Limited.
2024-10-13 00:16:58,497 - INFO - 601: JSK Securities Limited
2024-10-13 00:16:58,497 - INFO - 602: ZLK Islamic Financial Services Pvt.Ltd.
2024-10-13 00:16:58,497 - INFO - 603: Enrichers Securities (Pvt) Ltd.
2024-10-13 00:16:58,497 - INFO - 932: Ahsam Securities (Pvt.) Ltd.
2024-10-13 00:16:58,497 - INFO - 934: Falki Capital (Pvt.) Ltd.
2024-10-13 00:16:58,497 - INFO - 935: Salim Sozer Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 936: Saya Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 937: ASA Stocks (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 938: Margalla Financial (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 941: A.I. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 942: M. Salim Kasmani Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 943: Z.A. Ghaffar Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 951: K.H.S. Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 957: 128 Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 961: KP Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 963: Yasir Mahmood Securities (Pvt.) Ltd.
2024-10-13 00:16:58,498 - INFO - 967: High Land Securities (Pvt.) Ltd.
2024-10-13 00:16:58,499 - INFO - 972: Pasha Securities (Pvt.) Ltd.
2024-10-13 00:16:58,499 - INFO - 973: Stocxinvest Securities (Pvt) Ltd
2024-10-13 00:16:58,500 - INFO - 975: Adeel Nadeem Securities Ltd.
2024-10-13 00:16:58,500 - INFO - 977: Gul Dhami Securities Pvt Ltd
2024-10-13 00:16:58,500 - INFO - 978: Dosslani's Securities Private Limited
2024-10-13 00:16:58,500 - INFO - 986: Progressive Securities Pvt Ltd.
2024-10-13 00:16:58,500 - INFO - 987: CMA Securities Pvt Ltd.
2024-10-13 00:16:58,500 - INFO - 988: Javed Iqbal Securities Pvt Ltd.
2024-10-13 00:16:58,500 - INFO - 992: Vector Securities Private Limited
2024-10-13 00:16:58,500 - INFO - 994: Unex Securities (Private) Limited
2024-10-13 00:16:58,501 - INFO - 995: Syed Faraz Equities (Private) Limited
2024-10-13 00:19:15,694 - INFO - Initializing in-memory database for testing...
2024-10-13 00:19:15,695 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-13 00:19:15,695 - INFO - ---- Portfolio Management ----
2024-10-13 00:19:15,696 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:19:17,217 - INFO - Inserted or updated 544 records in the database.
2024-10-13 00:19:17,219 - INFO - Search results for company 'Al-Abbas': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:19:17,219 - INFO - Search results for symbol 'AABS': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:19:17,220 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-13 00:19:17,220 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-13 00:19:17,220 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 00:19:17,222 - INFO - Existing Portfolios:
2024-10-13 00:19:17,223 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-13 00:19:17,223 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:19:17,223 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:19:17,228 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:19:17,229 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:19:17,229 - INFO - Retrieved 0 portfolios from the database.
2024-10-13 00:19:17,229 - INFO - Portfolios after deletion:
2024-10-13 00:19:17,229 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-13 00:19:18,083 - INFO - CSV data fetched successfully.
2024-10-13 00:19:18,106 - INFO - Inserting transaction data for 2024-10-11 into the database...
2024-10-13 00:19:18,106 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-13 00:19:18,113 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-13 00:19:18,113 - INFO - Fetching table structure for 'Transactions'...
2024-10-13 00:19:18,114 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-13 00:19:18,114 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-13 00:19:18,114 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-13 00:19:18,114 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-13 00:19:18,115 - INFO - Fetching transaction data from 2024-10-11 to 2024-10-11 from the database...
2024-10-13 00:19:18,115 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-13 00:19:18,115 - INFO - Fetching transactions for date: 2024-10-11
2024-10-13 00:19:18,115 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:19:18,134 - INFO - Fetched Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:19:18,135 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12 from the database...
2024-10-13 00:19:18,135 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-13 00:19:18,135 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-13 00:19:18,135 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:19:18,192 - INFO - Fetched Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:19:18,192 - INFO - Inserting market watch data into the database...
2024-10-13 00:19:18,192 - INFO - Fetching market watch data...
2024-10-13 00:19:20,304 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:19:20,305 - INFO - Fetched 960 market watch records.
2024-10-13 00:19:20,320 - INFO - Inserting batch 1 with 100 records.
2024-10-13 00:19:20,324 - INFO - Inserting batch 2 with 100 records.
2024-10-13 00:19:20,326 - INFO - Inserting batch 3 with 100 records.
2024-10-13 00:19:20,329 - INFO - Inserting batch 4 with 100 records.
2024-10-13 00:19:20,330 - INFO - Inserting batch 5 with 100 records.
2024-10-13 00:19:20,331 - INFO - Inserting batch 6 with 100 records.
2024-10-13 00:19:20,346 - INFO - Inserting batch 7 with 100 records.
2024-10-13 00:19:20,346 - INFO - Inserting batch 8 with 100 records.
2024-10-13 00:19:20,366 - INFO - Inserting batch 9 with 100 records.
2024-10-13 00:19:20,367 - INFO - Inserting batch 10 with 60 records.
2024-10-13 00:19:20,368 - INFO - Successfully inserted/updated 960 records for market watch data.
2024-10-13 00:19:20,368 - INFO - Total records in the MarketWatch table: 960
2024-10-13 00:19:20,370 - INFO - Successfully inserted 960 market watch records into the database.
2024-10-13 00:19:20,373 - INFO - Fetching top 10 advancers...
2024-10-13 00:19:20,377 - INFO - Top 10 Advancers:
2024-10-13 00:19:20,377 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-13 00:19:20,378 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-13 00:19:20,378 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:19:20,378 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:19:20,378 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-13 00:19:20,378 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-13 00:19:20,379 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-13 00:19:20,379 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:19:20,379 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:19:20,379 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:19:20,379 - INFO - --------------------------------------------------
2024-10-13 00:19:20,380 - INFO - Fetching top 10 decliners...
2024-10-13 00:19:20,380 - INFO - Top 10 Decliners:
2024-10-13 00:19:20,380 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:19:20,380 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:19:20,380 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:19:20,381 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-13 00:19:20,381 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-13 00:19:20,381 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:19:20,381 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:19:20,381 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:19:20,381 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:19:20,381 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:19:20,382 - INFO - --------------------------------------------------
2024-10-13 00:19:20,382 - INFO - Fetching top 10 most active stocks...
2024-10-13 00:19:20,386 - INFO - Top 10 Most Active Stocks:
2024-10-13 00:19:20,387 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,387 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,387 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,388 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,388 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,388 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,389 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,389 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,389 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,390 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:19:20,390 - INFO - --------------------------------------------------
2024-10-13 00:19:20,390 - INFO - Fetching listings data...
2024-10-13 00:19:21,578 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:19:21,579 - INFO - Successfully retrieved 453 listings records.
2024-10-13 00:19:21,579 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-13 00:19:21,581 - INFO - --------------------------------------------------
2024-10-13 00:19:21,581 - INFO - Fetching defaulters data...
2024-10-13 00:19:22,598 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:19:22,599 - INFO - Successfully retrieved 96 defaulters records.
2024-10-13 00:19:22,599 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-13 00:19:22,599 - INFO - --------------------------------------------------
2024-10-13 00:19:22,599 - INFO - Merging market watch, listings, and defaulters data...
2024-10-13 00:20:21,838 - INFO - --------------------------------------------------
2024-10-13 00:20:21,838 - INFO - Fetching PSX constituent data for 2024-10-11...
2024-10-13 00:20:21,838 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:20:23,348 - INFO - Fetched 544 rows of PSX constituent data.
2024-10-13 00:20:23,349 - INFO - Sample PSX Constituent Data:
[{'ISIN': 'PK0061101017', 'SYMBOL': '786', 'COMPANY': '786 Investments Limited', 'PRICE': 6.0, 'IDX WT %': 0.0008053619738181293, 'FF BASED SHARES': 5240813, 'FF BASED MCAP': 31444878.0, 'ORD SHARES': 14973750, 'ORD SHARES MCAP': 89842500.0, 'VOLUME': 26}, {'ISIN': 'PK0050501011', 'SYMBOL': 'AABS', 'COMPANY': 'Al-Abbas Sugar Mills Limited', 'PRICE': 610.67, 'IDX WT %': 0.09504365582042357, 'FF BASED SHARES': 1736230, 'FF BASED MCAP': 1060263574.1, 'ORD SHARES': 17362300, 'ORD SHARES MCAP': 10602635741.0, 'VOLUME': 468}, {'ISIN': 'PK0015401018', 'SYMBOL': 'AAL', 'COMPANY': 'Agro Allianz Limited', 'PRICE': 16.0, 'IDX WT %': 0.00016970218547731608, 'FF BASED SHARES': 0, 'FF BASED MCAP': 0.0, 'ORD SHARES': 1183200, 'ORD SHARES MCAP': 18931200.0, 'VOLUME': 0}, {'ISIN': 'PK0036101019', 'SYMBOL': 'AASM', 'COMPANY': 'Al-Abid Silk Mills Limited', 'PRICE': 3.49, 'IDX WT %': 0.0004195163801039042, 'FF BASED SHARES': 2681910, 'FF BASED MCAP': 9359865.9, 'ORD SHARES': 13409550, 'ORD SHARES MCAP': 46799329.5, 'VOLUME': 0}, {'ISIN': 'PK0011501019', 'SYMBOL': 'AATM', 'COMPANY': 'Ali Asghar Textile Mills Limited', 'PRICE': 57.77, 'IDX WT %': 0.023006770260956922, 'FF BASED SHARES': 926222, 'FF BASED MCAP': 53507844.94, 'ORD SHARES': 44426694, 'ORD SHARES MCAP': 2566530112.38, 'VOLUME': 1214}]
2024-10-13 00:20:23,349 - INFO - --------------------------------------------------
2024-10-13 00:20:23,349 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-13 00:20:24,214 - INFO - CSV data fetched successfully.
2024-10-13 00:20:24,235 - INFO - Fetched 39 rows of transaction data.
2024-10-13 00:20:24,258 - INFO - Sample Transaction Data:
         Date Settlement Date  ... Buyer Code Seller Code
0  2024-10-11      2024-10-15  ...       None        None
1  2024-10-11      2024-10-15  ...       None        None
2  2024-10-11      2024-10-14  ...       None        None
3  2024-10-11      2024-10-15  ...       None        None
4  2024-10-11      2024-10-14  ...       None        None

[5 rows x 11 columns]
2024-10-13 00:20:24,258 - INFO - Fetching stock data...
2024-10-13 00:20:25,156 - INFO - Retrieved 248 records for ticker 'MCB'.
2024-10-13 00:20:25,156 - INFO - Successfully retrieved stock data for 'MCB' from 01 Jan 2022 to 31 Dec 2022
2024-10-13 00:20:25,156 - INFO - Sample Stock Data: [{'Date_': '2022-01-03T00:00:00', 'Open': 152.8, 'High': 154.2, 'Low': 152.4, 'Close': 154.06, 'Change': 0.7099915, 'change_valueP': 0.46298758437956006, 'ChangeP': 0.46298758437956006, 'Volume': 502411.0}, {'Date_': '2022-01-04T00:00:00', 'Open': 154.0, 'High': 154.49, 'Low': 153.5, 'Close': 153.69, 'Change': -0.3699951, 'change_valueP': -0.2401629960846338, 'ChangeP': -0.2401629960846338, 'Volume': 233074.0}, {'Date_': '2022-01-05T00:00:00', 'Open': 153.7, 'High': 154.45, 'Low': 153.0, 'Close': 153.91, 'Change': 0.2200012, 'change_valueP': 0.14314607438203716, 'ChangeP': 0.14314607438203716, 'Volume': 345748.0}, {'Date_': '2022-01-06T00:00:00', 'Open': 154.4, 'High': 154.4, 'Low': 153.07, 'Close': 154.13, 'Change': 0.2200012, 'change_valueP': 0.14294146040887373, 'ChangeP': 0.14294146040887373, 'Volume': 301734.0}, {'Date_': '2022-01-07T00:00:00', 'Open': 154.5, 'High': 155.7, 'Low': 154.0, 'Close': 154.94, 'Change': 0.8099976, 'change_valueP': 0.5255288311083554, 'ChangeP': 0.5255288311083554, 'Volume': 296075.0}]
2024-10-13 00:20:25,156 - INFO - --------------------------------------------------
2024-10-13 00:20:25,156 - INFO - Fetching KSE symbols...
2024-10-13 00:20:26,538 - INFO - Retrieved 855 index symbols.
2024-10-13 00:20:26,539 - INFO - Successfully retrieved 855 KSE symbols.
2024-10-13 00:20:26,539 - INFO - Sample KSE Symbols: [{'symbol': 'AKBLTFC6', 'name': 'Askari Bank(TFC6)', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}, {'symbol': 'AKBLTFC7', 'name': 'Askari Bank(TFC7)', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}, {'symbol': 'BAFLTFC6', 'name': 'Bank Al-Falah(TFC6', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}, {'symbol': 'BAFLTFC8', 'name': 'Bank Alfalah(TFC8)', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}, {'symbol': 'BAHLTFC10', 'name': 'BANK AL HABIB LTD. (10TH ISSUE)', 'sectorName': 'BILLS AND BONDS', 'isETF': False, 'isDebt': True}]
2024-10-13 00:20:26,539 - INFO - --------------------------------------------------
2024-10-13 00:20:26,539 - INFO - Fetching market watch data...
2024-10-13 00:20:28,031 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:20:28,032 - INFO - Successfully retrieved market watch data.
2024-10-13 00:20:28,032 - INFO - Sample Market Watch Data: [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}, {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761}]
2024-10-13 00:20:28,032 - INFO - --------------------------------------------------
2024-10-13 00:20:28,034 - INFO - Fetching ticker market details...
2024-10-13 00:20:29,271 - INFO - Retrieved 6 constituents for index 'JSGBKTI'.
2024-10-13 00:20:29,272 - INFO - Successfully retrieved market details for index 'JSGBKTI'
2024-10-13 00:20:29,272 - INFO - Sample Market Details: [{'SYMBOL': 'BAFL', 'NAME': 'Bank Alfalah Limited', 'LDCP': 66.98, 'CURRENT': 67.86, 'CHANGE': 0.88, 'CHANGE (%)': 1.314, 'IDX WTG (%)': '15.66%', 'IDX POINT': 48.5466, 'VOLUME': 278476, 'FREEFLOAT (M)': 1311284881.0, 'MARKET CAP (M)': 88983792024.66}, {'SYMBOL': 'BAHL', 'NAME': 'Bank AL Habib Limited', 'LDCP': 108.56, 'CURRENT': 108.61, 'CHANGE': 0.05, 'CHANGE (%)': 0.046, 'IDX WTG (%)': '15.19%', 'IDX POINT': 1.6725, 'VOLUME': 228606, 'FREEFLOAT (M)': 795093578.0, 'MARKET CAP (M)': 86355113506.58}, {'SYMBOL': 'HBL', 'NAME': 'Habib Bank Limited', 'LDCP': 137.64, 'CURRENT': 136.05, 'CHANGE': -1.59, 'CHANGE (%)': -1.155, 'IDX WTG (%)': '17.22%', 'IDX POINT': -48.1043, 'VOLUME': 4278696, 'FREEFLOAT (M)': 719129224.0, 'MARKET CAP (M)': 97837530925.20001}, {'SYMBOL': 'MCB', 'NAME': 'MCB Bank Limited', 'LDCP': 255.18, 'CURRENT': 257.42, 'CHANGE': 2.24, 'CHANGE (%)': 0.878, 'IDX WTG (%)': '17.80%', 'IDX POINT': 37.0251, 'VOLUME': 111653, 'FREEFLOAT (M)': 392888722.0, 'MARKET CAP (M)': 101137414817.24}, {'SYMBOL': 'MEBL', 'NAME': 'Meezan Bank Limited', 'LDCP': 240.95, 'CURRENT': 240.62, 'CHANGE': -0.33, 'CHANGE (%)': -0.13699999999999998, 'IDX WTG (%)': '15.77%', 'IDX POINT': -5.1728, 'VOLUME': 431871, 'FREEFLOAT (M)': 372586982.0, 'MARKET CAP (M)': 89651879608.84}]
2024-10-13 00:20:29,272 - INFO - --------------------------------------------------
2024-10-13 00:20:29,272 - INFO - Fetching index historical data...
2024-10-13 00:20:31,587 - INFO - Retrieved 268 historical data points for index 'JSGBKTI'.
2024-10-13 00:20:31,588 - INFO - Successfully retrieved historical data for index 'JSGBKTI'
2024-10-13 00:20:31,588 - INFO - Sample Historical Data: [[1728644400, 23910.2946, 6295789, 23834.4742], [1728558000, 23847.6234, 4476378, 24008.3819], [1728471600, 23988.239, 9972756, 23865.3907], [1728385200, 23804.1322, 16575084, 23058.9327], [1728298800, 23059.2174, 16509979, 22818.46]]
2024-10-13 00:20:31,588 - INFO - --------------------------------------------------
2024-10-13 00:20:31,588 - INFO - Fetching listings data...
2024-10-13 00:20:32,992 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:20:32,993 - INFO - Successfully retrieved listings data.
2024-10-13 00:20:32,993 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-13 00:20:32,999 - INFO - --------------------------------------------------
2024-10-13 00:20:33,003 - INFO - Fetching defaulters data...
2024-10-13 00:20:34,017 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:20:34,021 - INFO - Successfully retrieved defaulters list.
2024-10-13 00:20:34,021 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-13 00:20:34,021 - INFO - --------------------------------------------------
2024-10-13 00:20:34,022 - INFO - Merging market watch, listings, and defaulters data...
2024-10-13 00:20:34,022 - INFO - Successfully merged data.
2024-10-13 00:20:34,023 - INFO - Sample Merged Data (with Defaulter flag): [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'UPP9', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761, 'NAME': 'The Hub Power Company Limited', 'SHARES': 1297154400, 'FREE FLOAT': 972865790, 'DEFAULTER': False}, {'SYMBOL': 'PTC', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'KSE100', 'LDCP': 14.52, 'OPEN': 14.75, 'HIGH': 15.97, 'LOW': 13.96, 'CURRENT': 15.7, 'CHANGE': 1.18, 'CHANGE (%)': 8.13, 'VOLUME': 51351566, 'NAME': 'Pakistan Telecommunication Company Ltd', 'SHARES': 3774000000, 'FREE FLOAT': 593190667, 'DEFAULTER': False}, {'SYMBOL': 'WTL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 1.2, 'OPEN': 1.21, 'HIGH': 1.21, 'LOW': 1.18, 'CURRENT': 1.18, 'CHANGE': -0.02, 'CHANGE (%)': -1.67, 'VOLUME': 45693545, 'NAME': 'Worldcall Telecom Limited', 'SHARES': 4982289186, 'FREE FLOAT': 3736716890, 'DEFAULTER': False}, {'SYMBOL': 'HUMNL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 12.33, 'OPEN': 12.5, 'HIGH': 13.56, 'LOW': 12.02, 'CURRENT': 13.56, 'CHANGE': 1.23, 'CHANGE (%)': 9.98, 'VOLUME': 32955417, 'NAME': 'Hum Network Limited', 'SHARES': 1134000000, 'FREE FLOAT': 567000000, 'DEFAULTER': False}, {'SYMBOL': 'KOSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'KSE100', 'LDCP': 8.02, 'OPEN': 8.0, 'HIGH': 8.0, 'LOW': 7.02, 'CURRENT': 7.07, 'CHANGE': -0.95, 'CHANGE (%)': -11.85, 'VOLUME': 25957843, 'NAME': 'Kohinoor Spinning Mills Limited', 'SHARES': 412106785, 'FREE FLOAT': 226658732, 'DEFAULTER': False}]
2024-10-13 00:20:34,023 - INFO - --------------------------------------------------
2024-10-13 00:20:34,023 - INFO - 001: Altaf Adam Securities (Pvt.) Ltd.
2024-10-13 00:20:34,023 - INFO - 006: Sherman Securities (Pvt.) Ltd.
2024-10-13 00:20:34,023 - INFO - 008: Optimus Capital Management (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 010: Sakarwala Capital Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 017: Summit Capital (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 018: Ismail Iqbal Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 019: AKD Securities Ltd.
2024-10-13 00:20:34,024 - INFO - 021: Alpha Capital (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 022: BMA Capital Management Ltd.
2024-10-13 00:20:34,024 - INFO - 025: Vector Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 027: Habib Metropolitan Financial Services
2024-10-13 00:20:34,024 - INFO - 037: H.H. Misbah Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 038: A.H.M. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 044: IGI Finex Securities Ltd.
2024-10-13 00:20:34,024 - INFO - 046: Fortune Securities Ltd.
2024-10-13 00:20:34,024 - INFO - 047: Zillion Capital Securities (Pvt.) Ltd.
2024-10-13 00:20:34,024 - INFO - 048: Next Capital Ltd.
2024-10-13 00:20:34,025 - INFO - 049: Multiline Securities Ltd.
2024-10-13 00:20:34,025 - INFO - 050: Arif Habib Ltd.
2024-10-13 00:20:34,025 - INFO - 058: Dawood Equities Ltd.
2024-10-13 00:20:34,025 - INFO - 062: WE Financial Services Ltd.
2024-10-13 00:20:34,025 - INFO - 063: Al-Habib Capital Markets (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 068: Zafar Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 077: Bawany Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 084: Munir Khanani Securities Ltd.
2024-10-13 00:20:34,025 - INFO - 088: Fawad Yusuf Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 090: Darson Securities Private Limited.
2024-10-13 00:20:34,025 - INFO - 091: Intermarket Securities Ltd.
2024-10-13 00:20:34,025 - INFO - 092: Memon Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 094: FDM Capital Securities (Pvt.) Ltd.
2024-10-13 00:20:34,025 - INFO - 096: Msmaniar Financials (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 102: Growth Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 107: Seven Star Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 108: AZEE Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 112: Standard Capital Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 119: Axis Global Ltd.
2024-10-13 00:20:34,026 - INFO - 120: Alfalah Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 124: EFG Hermes Pakistan Ltd.
2024-10-13 00:20:34,026 - INFO - 129: Taurus Securities Ltd.
2024-10-13 00:20:34,026 - INFO - 140: M.M. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 142: Foundation Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 145: Adam Securities Ltd.
2024-10-13 00:20:34,026 - INFO - 149: JS Global Capital Ltd.
2024-10-13 00:20:34,026 - INFO - 159: Rafi Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 162: Aba Ali Habib Securities (Pvt.) Ltd.
2024-10-13 00:20:34,026 - INFO - 163: Friendly Securities (Pvt.) Ltd.
2024-10-13 00:20:34,027 - INFO - 164: Interactive Securities (Pvt.) Ltd.
2024-10-13 00:20:34,027 - INFO - 166: Topline Securities Ltd.
2024-10-13 00:20:34,027 - INFO - 169: Pearl Securities Ltd.
2024-10-13 00:20:34,027 - INFO - 173: Spectrum Securities Ltd.
2024-10-13 00:20:34,027 - INFO - 175: First National Equities Ltd.
2024-10-13 00:20:34,027 - INFO - 183: R.T. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,027 - INFO - 194: MRA Securities Ltd.
2024-10-13 00:20:34,027 - INFO - 199: Insight Securities (Pvt.) Ltd.
2024-10-13 00:20:34,027 - INFO - 248: Ktrade Securites Ltd.
2024-10-13 00:20:34,027 - INFO - 254: ShajarPak Securities (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 275: Rahat Securities Ltd.
2024-10-13 00:20:34,028 - INFO - 293: Integrated Equities Ltd.
2024-10-13 00:20:34,028 - INFO - 311: Abbasi & Company (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 332: Trust Securities & Brokerage Ltd.
2024-10-13 00:20:34,028 - INFO - 410: Zahid Latif Khan Securities (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 524: Akik Capital (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 525: Adam Usman Securities (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 526: Chase Securities Pakistan (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 528: H.G Markets (Private) Limited
2024-10-13 00:20:34,028 - INFO - 529: Orbit Securities (Pvt.) Ltd.
2024-10-13 00:20:34,028 - INFO - 531: T&G Securities Private Limited.
2024-10-13 00:20:34,028 - INFO - 601: JSK Securities Limited
2024-10-13 00:20:34,028 - INFO - 602: ZLK Islamic Financial Services Pvt.Ltd.
2024-10-13 00:20:34,029 - INFO - 603: Enrichers Securities (Pvt) Ltd.
2024-10-13 00:20:34,029 - INFO - 932: Ahsam Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 934: Falki Capital (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 935: Salim Sozer Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 936: Saya Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 937: ASA Stocks (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 938: Margalla Financial (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 941: A.I. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 942: M. Salim Kasmani Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 943: Z.A. Ghaffar Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 951: K.H.S. Securities (Pvt.) Ltd.
2024-10-13 00:20:34,029 - INFO - 957: 128 Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 961: KP Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 963: Yasir Mahmood Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 967: High Land Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 972: Pasha Securities (Pvt.) Ltd.
2024-10-13 00:20:34,030 - INFO - 973: Stocxinvest Securities (Pvt) Ltd
2024-10-13 00:20:34,030 - INFO - 975: Adeel Nadeem Securities Ltd.
2024-10-13 00:20:34,031 - INFO - 977: Gul Dhami Securities Pvt Ltd
2024-10-13 00:20:34,031 - INFO - 978: Dosslani's Securities Private Limited
2024-10-13 00:20:34,031 - INFO - 986: Progressive Securities Pvt Ltd.
2024-10-13 00:20:34,031 - INFO - 987: CMA Securities Pvt Ltd.
2024-10-13 00:20:34,031 - INFO - 988: Javed Iqbal Securities Pvt Ltd.
2024-10-13 00:20:34,031 - INFO - 992: Vector Securities Private Limited
2024-10-13 00:20:34,032 - INFO - 994: Unex Securities (Private) Limited
2024-10-13 00:20:34,032 - INFO - 995: Syed Faraz Equities (Private) Limited
2024-10-13 00:20:51,320 - INFO - Initializing in-memory database for testing...
2024-10-13 00:20:51,321 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-13 00:20:51,322 - INFO - ---- Portfolio Management ----
2024-10-13 00:20:51,322 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:20:53,257 - INFO - Inserted or updated 544 records in the database.
2024-10-13 00:20:53,257 - INFO - Search results for company 'Al-Abbas': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:20:53,257 - INFO - Search results for symbol 'AABS': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:20:53,258 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-13 00:20:53,258 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-13 00:20:53,259 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 00:20:53,259 - INFO - Existing Portfolios:
2024-10-13 00:20:53,259 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-13 00:20:53,259 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:20:53,260 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:20:53,260 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:20:53,260 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:20:53,260 - INFO - Retrieved 0 portfolios from the database.
2024-10-13 00:20:53,260 - INFO - Portfolios after deletion:
2024-10-13 00:20:53,260 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-13 00:20:54,165 - INFO - CSV data fetched successfully.
2024-10-13 00:20:54,189 - INFO - Inserting transaction data for 2024-10-11 into the database...
2024-10-13 00:20:54,189 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-13 00:20:54,192 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-13 00:20:54,192 - INFO - Fetching table structure for 'Transactions'...
2024-10-13 00:20:54,193 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-13 00:20:54,193 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-13 00:20:54,193 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-13 00:20:54,193 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:20:54,193 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:20:54,194 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-13 00:20:54,194 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-13 00:20:54,194 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-13 00:20:54,194 - INFO - Fetching transaction data from 2024-10-11 to 2024-10-11 from the database...
2024-10-13 00:20:54,195 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-13 00:20:54,195 - INFO - Fetching transactions for date: 2024-10-11
2024-10-13 00:20:54,195 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:20:54,220 - INFO - Fetched Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:20:54,220 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12 from the database...
2024-10-13 00:20:54,220 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-13 00:20:54,221 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-13 00:20:54,221 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:20:54,248 - INFO - Fetched Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:20:54,248 - INFO - Inserting market watch data into the database...
2024-10-13 00:20:54,249 - INFO - Fetching market watch data...
2024-10-13 00:20:55,894 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:20:55,895 - INFO - Fetched 960 market watch records.
2024-10-13 00:20:55,908 - INFO - Inserting batch 1 with 100 records.
2024-10-13 00:20:55,911 - INFO - Inserting batch 2 with 100 records.
2024-10-13 00:20:55,911 - INFO - Inserting batch 3 with 100 records.
2024-10-13 00:20:55,913 - INFO - Inserting batch 4 with 100 records.
2024-10-13 00:20:55,916 - INFO - Inserting batch 5 with 100 records.
2024-10-13 00:20:55,922 - INFO - Inserting batch 6 with 100 records.
2024-10-13 00:20:55,923 - INFO - Inserting batch 7 with 100 records.
2024-10-13 00:20:55,923 - INFO - Inserting batch 8 with 100 records.
2024-10-13 00:20:55,924 - INFO - Inserting batch 9 with 100 records.
2024-10-13 00:20:55,925 - INFO - Inserting batch 10 with 60 records.
2024-10-13 00:20:55,926 - INFO - Successfully inserted/updated 960 records for market watch data.
2024-10-13 00:20:55,928 - INFO - Total records in the MarketWatch table: 960
2024-10-13 00:20:55,929 - INFO - Successfully inserted 960 market watch records into the database.
2024-10-13 00:20:55,929 - INFO - Fetching top 10 advancers...
2024-10-13 00:20:55,931 - INFO - Top 10 Advancers:
2024-10-13 00:20:55,931 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-13 00:20:55,932 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-13 00:20:55,932 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:20:55,934 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:20:55,934 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-13 00:20:55,938 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-13 00:20:55,938 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-13 00:20:55,938 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:20:55,938 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:20:55,940 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:20:55,940 - INFO - --------------------------------------------------
2024-10-13 00:20:55,940 - INFO - Fetching top 10 decliners...
2024-10-13 00:20:55,941 - INFO - Top 10 Decliners:
2024-10-13 00:20:55,941 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:20:55,942 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:20:55,942 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:20:55,943 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-13 00:20:55,943 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-13 00:20:55,943 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:20:55,943 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:20:55,943 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:20:55,944 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:20:55,944 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:20:55,944 - INFO - --------------------------------------------------
2024-10-13 00:20:55,944 - INFO - Fetching top 10 most active stocks...
2024-10-13 00:20:55,944 - INFO - Top 10 Most Active Stocks:
2024-10-13 00:20:55,945 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,945 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,945 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,945 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,946 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,946 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,947 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,948 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,949 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,950 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:20:55,951 - INFO - --------------------------------------------------
2024-10-13 00:20:55,951 - INFO - Fetching listings data...
2024-10-13 00:20:58,130 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:20:58,130 - INFO - Successfully retrieved 453 listings records.
2024-10-13 00:20:58,131 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-13 00:20:58,132 - INFO - --------------------------------------------------
2024-10-13 00:20:58,134 - INFO - Fetching defaulters data...
2024-10-13 00:21:00,062 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:21:00,063 - INFO - Successfully retrieved 96 defaulters records.
2024-10-13 00:21:00,066 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-13 00:21:00,067 - INFO - --------------------------------------------------
2024-10-13 00:21:00,067 - INFO - Merging market watch, listings, and defaulters data...
2024-10-13 00:26:47,330 - INFO - Initializing in-memory database for testing...
2024-10-13 00:26:47,331 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-13 00:26:47,332 - INFO - In-memory database initialized successfully.
2024-10-13 00:26:47,333 - INFO - Fetching PSX constituents data for date: 2024-10-11
2024-10-13 00:26:47,333 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:26:49,395 - INFO - Inserted or updated 544 PSX constituent records into the database.
2024-10-13 00:26:49,395 - INFO - Performing search operations on PSX constituents.
2024-10-13 00:26:49,396 - INFO - Search results for company 'Al-Abbas': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:26:49,396 - INFO - Search results for symbol 'AABS': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:26:49,397 - INFO - ---- Portfolio Management Operations ----
2024-10-13 00:26:49,397 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-13 00:26:49,397 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-13 00:26:49,397 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 00:26:49,397 - INFO - Existing Portfolios:
2024-10-13 00:26:49,398 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-13 00:26:49,398 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:26:49,398 - INFO - Portfolio ID '1' updated successfully to 'Tech Leaders'.
2024-10-13 00:26:49,398 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:26:49,398 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:26:49,398 - INFO - Retrieved 0 portfolios from the database.
2024-10-13 00:26:49,398 - INFO - No portfolios remaining after deletion.
2024-10-13 00:26:49,399 - INFO - ---- End of Portfolio Management Operations ----
2024-10-13 00:26:49,399 - INFO - Fetching PSX transaction data for date: 2024-10-11
2024-10-13 00:26:50,168 - INFO - CSV data fetched successfully.
2024-10-13 00:26:50,187 - ERROR - An unexpected error occurred: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Traceback (most recent call last):
  File "d:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 1079, in main
    if transaction_data:
       ^^^^^^^^^^^^^^^^
  File "C:\Users\imran\AppData\Roaming\Python\Python312\site-packages\pandas\core\generic.py", line 1577, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
2024-10-13 00:26:50,236 - INFO - In-memory database connection closed.
2024-10-13 00:38:39,449 - INFO - Initializing in-memory database for testing...
2024-10-13 00:38:39,456 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-13 00:38:39,457 - INFO - In-memory database initialized successfully.
2024-10-13 00:38:39,457 - INFO - Fetching PSX constituents data for date: 2024-10-11
2024-10-13 00:38:39,457 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-13 00:38:40,918 - INFO - Inserted or updated 544 PSX constituent records into the database.
2024-10-13 00:38:40,918 - INFO - Performing search operations on PSX constituents.
2024-10-13 00:38:40,918 - INFO - Search results for company 'Al-Abbas': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:38:40,918 - INFO - Search results for symbol 'AABS': [('PK0050501011', 'AABS', 'Al-Abbas Sugar Mills Limited', 610.67, 0.09504365582042357, 1736230, 1060263574.1, 17362300, 10602635741.0, 468)]
2024-10-13 00:38:40,918 - INFO - ---- Portfolio Management Operations ----
2024-10-13 00:38:40,919 - INFO - Portfolio 'Tech Giants' created with stocks: AAPL,GOOGL,MSFT,AMZN,FB.
2024-10-13 00:38:40,919 - INFO - Portfolio 'Tech Giants' created successfully.
2024-10-13 00:38:40,919 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 00:38:40,919 - INFO - Existing Portfolios:
2024-10-13 00:38:40,919 - INFO - ID: 1, Name: Tech Giants, Stocks: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'FB']
2024-10-13 00:38:40,919 - INFO - Portfolio ID '1' updated successfully.
2024-10-13 00:38:40,920 - INFO - Portfolio ID '1' updated successfully to 'Tech Leaders'.
2024-10-13 00:38:40,920 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:38:40,920 - INFO - Portfolio ID '1' deleted successfully.
2024-10-13 00:38:40,920 - INFO - Retrieved 0 portfolios from the database.
2024-10-13 00:38:40,921 - INFO - No portfolios remaining after deletion.
2024-10-13 00:38:40,921 - INFO - ---- End of Portfolio Management Operations ----
2024-10-13 00:38:40,921 - INFO - Fetching PSX transaction data for date: 2024-10-11
2024-10-13 00:38:42,183 - INFO - CSV data fetched successfully.
2024-10-13 00:38:42,201 - INFO - Inserting transaction data for 2024-10-11 into the database.
2024-10-13 00:38:42,201 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-13 00:38:42,205 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-13 00:38:42,205 - INFO - Fetching table structure for 'Transactions'...
2024-10-13 00:38:42,205 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-13 00:38:42,205 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-13 00:38:42,206 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-13 00:38:42,206 - INFO - Inserted 39 transaction records into the database.
2024-10-13 00:38:42,207 - INFO - Retrieving transaction data for date: 2024-10-11
2024-10-13 00:38:42,207 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-13 00:38:42,207 - INFO - Fetching transactions for date: 2024-10-11
2024-10-13 00:38:42,207 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:38:42,226 - INFO - Fetched Transaction Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:38:42,227 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12.
2024-10-13 00:38:42,227 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-13 00:38:42,227 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-13 00:38:42,227 - INFO - Retrieved 33 records from Transactions table.
2024-10-13 00:38:42,243 - INFO - Fetched Transaction Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-13 00:38:42,243 - INFO - Inserting market watch data into the database.
2024-10-13 00:38:42,244 - INFO - Fetching market watch data...
2024-10-13 00:38:43,924 - INFO - Retrieved 960 records from market watch.
2024-10-13 00:38:43,925 - INFO - Fetched 960 market watch records.
2024-10-13 00:38:43,933 - INFO - Inserting batch 1 with 100 records.
2024-10-13 00:38:43,935 - INFO - Inserting batch 2 with 100 records.
2024-10-13 00:38:43,936 - INFO - Inserting batch 3 with 100 records.
2024-10-13 00:38:43,937 - INFO - Inserting batch 4 with 100 records.
2024-10-13 00:38:43,938 - INFO - Inserting batch 5 with 100 records.
2024-10-13 00:38:43,941 - INFO - Inserting batch 6 with 100 records.
2024-10-13 00:38:43,943 - INFO - Inserting batch 7 with 100 records.
2024-10-13 00:38:43,945 - INFO - Inserting batch 8 with 100 records.
2024-10-13 00:38:43,947 - INFO - Inserting batch 9 with 100 records.
2024-10-13 00:38:43,948 - INFO - Inserting batch 10 with 60 records.
2024-10-13 00:38:43,952 - INFO - Successfully inserted/updated 960 records for market watch data.
2024-10-13 00:38:43,952 - INFO - Total records in the MarketWatch table: 960
2024-10-13 00:38:43,953 - INFO - Successfully inserted/updated 960 market watch records into the database.
2024-10-13 00:38:43,953 - INFO - ---- Market Insights ----
2024-10-13 00:38:43,954 - INFO - Fetching top 10 advancers.
2024-10-13 00:38:43,954 - INFO - Top 10 Advancers:
2024-10-13 00:38:43,955 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-13 00:38:43,955 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-13 00:38:43,955 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:38:43,955 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-13 00:38:43,955 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-13 00:38:43,956 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-13 00:38:43,956 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-13 00:38:43,957 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:38:43,957 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:38:43,957 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-13 00:38:43,957 - INFO - --------------------------------------------------
2024-10-13 00:38:43,959 - INFO - Fetching top 10 decliners.
2024-10-13 00:38:43,960 - INFO - Top 10 Decliners:
2024-10-13 00:38:43,960 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:38:43,961 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:38:43,961 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-13 00:38:43,961 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-13 00:38:43,962 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-13 00:38:43,962 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:38:43,962 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:38:43,962 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-13 00:38:43,963 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:38:43,963 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-13 00:38:43,963 - INFO - --------------------------------------------------
2024-10-13 00:38:43,963 - INFO - Fetching top 10 most active stocks.
2024-10-13 00:38:43,964 - INFO - Top 10 Most Active Stocks:
2024-10-13 00:38:43,964 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,965 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,965 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,965 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,965 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,966 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,966 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,968 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,968 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,969 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-13 00:38:43,969 - INFO - --------------------------------------------------
2024-10-13 00:38:43,970 - INFO - Fetching listings data.
2024-10-13 00:38:45,315 - INFO - Retrieved 453 records from listings data.
2024-10-13 00:38:45,315 - INFO - Successfully retrieved 453 listings records.
2024-10-13 00:38:45,316 - INFO - --------------------------------------------------
2024-10-13 00:38:45,318 - INFO - Fetching defaulters data.
2024-10-13 00:38:46,253 - INFO - Retrieved 96 records from defaulters list.
2024-10-13 00:38:46,254 - INFO - Successfully retrieved 96 defaulters records.
2024-10-13 00:38:46,254 - INFO - --------------------------------------------------
2024-10-13 00:38:46,255 - INFO - Merging market watch, listings, and defaulters data.
2024-10-13 00:38:46,257 - INFO - Successfully merged data into 554 records.
2024-10-13 00:38:46,258 - INFO - --------------------------------------------------
2024-10-13 00:38:46,259 - INFO - In-memory database connection closed.
2024-10-13 00:47:12,683 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 00:47:20,648 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 00:47:20,653 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 00:47:20,655 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-13 00:47:21,383 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-13 00:47:21,384 - ERROR - Failed to retrieve data for ticker 'ABL'.
2024-10-13 00:47:21,386 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-13 00:47:21,851 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-13 00:47:21,853 - ERROR - Failed to retrieve data for ticker 'AIRLINK'.
2024-10-13 00:47:21,855 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-13 00:47:22,361 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-13 00:47:22,364 - ERROR - Failed to retrieve data for ticker 'FATIMA'.
2024-10-13 00:47:22,366 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-13 00:47:22,808 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-13 00:47:22,810 - ERROR - Failed to retrieve data for ticker 'HUBC'.
2024-10-13 00:47:22,814 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-13 00:47:23,279 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-13 00:47:23,281 - ERROR - Failed to retrieve data for ticker 'MCB'.
2024-10-13 00:47:23,283 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-13 00:47:23,773 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-13 00:47:23,774 - ERROR - Failed to retrieve data for ticker 'OGDC'.
2024-10-13 00:47:23,775 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-13 00:47:24,223 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-13 00:47:24,224 - ERROR - Failed to retrieve data for ticker 'PPL'.
2024-10-13 00:47:24,226 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-13 00:47:24,674 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-13 00:47:24,675 - ERROR - Failed to retrieve data for ticker 'PSO'.
2024-10-13 00:47:24,677 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-13 00:47:25,192 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-13 00:47:25,193 - ERROR - Failed to retrieve data for ticker 'PTC'.
2024-10-13 00:47:25,195 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-13 00:47:25,616 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-13 00:47:25,617 - ERROR - Failed to retrieve data for ticker 'SEARL'.
2024-10-13 00:47:25,619 - INFO - Database synchronization complete.
2024-10-13 00:59:05,099 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 00:59:25,415 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:04:37,132 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:04:58,542 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:05:00,296 - INFO - Retrieved 960 records from market watch.
2024-10-13 01:16:47,088 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:16:54,830 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:16:56,755 - INFO - Retrieved 855 index symbols.
2024-10-13 01:20:48,743 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:20:54,099 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:20:54,142 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:20:54,234 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-13 01:20:54,913 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-13 01:20:54,928 - ERROR - Failed to retrieve data for ticker 'ABL'.
2024-10-13 01:20:54,932 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-13 01:20:55,376 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-13 01:20:55,385 - ERROR - Failed to retrieve data for ticker 'AIRLINK'.
2024-10-13 01:20:55,402 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-13 01:20:55,925 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-13 01:20:55,982 - ERROR - Failed to retrieve data for ticker 'FATIMA'.
2024-10-13 01:20:55,994 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-13 01:20:56,425 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-13 01:20:56,466 - ERROR - Failed to retrieve data for ticker 'HUBC'.
2024-10-13 01:20:56,470 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-13 01:20:56,951 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-13 01:20:56,952 - ERROR - Failed to retrieve data for ticker 'MCB'.
2024-10-13 01:20:56,954 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-13 01:20:57,411 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-13 01:20:57,412 - ERROR - Failed to retrieve data for ticker 'OGDC'.
2024-10-13 01:20:57,414 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-13 01:20:57,886 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-13 01:20:57,899 - ERROR - Failed to retrieve data for ticker 'PPL'.
2024-10-13 01:20:57,937 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-13 01:20:58,411 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-13 01:20:58,413 - ERROR - Failed to retrieve data for ticker 'PSO'.
2024-10-13 01:20:58,417 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-13 01:20:58,879 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-13 01:20:58,888 - ERROR - Failed to retrieve data for ticker 'PTC'.
2024-10-13 01:20:58,896 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-13 01:20:59,402 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-13 01:20:59,403 - ERROR - Failed to retrieve data for ticker 'SEARL'.
2024-10-13 01:20:59,406 - INFO - Database synchronization complete.
2024-10-13 01:21:07,359 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:07,368 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:22,211 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:22,284 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:33,989 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:34,109 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:35,650 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:35,674 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:37,103 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:37,112 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:38,114 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:38,135 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:38,650 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:38,667 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:39,138 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:39,160 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:39,576 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:39,600 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:40,182 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:40,199 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:40,982 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:41,018 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:41,773 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:41,790 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:44,405 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:44,418 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:21:44,475 - INFO - Portfolio 'alpha' created with stocks: HUBC,FATIMA,AIRLINK,ABL,OGDC,PSO,SEARL,PTC,PPL,MCB.
2024-10-13 01:21:44,516 - INFO - Portfolio 'alpha' created with tickers: ['HUBC', 'FATIMA', 'AIRLINK', 'ABL', 'OGDC', 'PSO', 'SEARL', 'PTC', 'PPL', 'MCB'].
2024-10-13 01:21:52,445 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:21:52,475 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:22:04,606 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:22:13,035 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:22:13,062 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:22:18,181 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:22:18,199 - INFO - Retrieved 1 portfolios from the database.
2024-10-13 01:37:03,978 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:15,324 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:16,743 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:16,801 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:16,974 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-13 01:37:17,667 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-13 01:37:17,668 - ERROR - Failed to retrieve data for ticker 'ABL'.
2024-10-13 01:37:17,669 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-13 01:37:18,163 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-13 01:37:18,169 - ERROR - Failed to retrieve data for ticker 'AIRLINK'.
2024-10-13 01:37:18,177 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-13 01:37:18,626 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-13 01:37:18,629 - ERROR - Failed to retrieve data for ticker 'FATIMA'.
2024-10-13 01:37:18,638 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-13 01:37:19,096 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-13 01:37:19,109 - ERROR - Failed to retrieve data for ticker 'HUBC'.
2024-10-13 01:37:19,159 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-13 01:37:19,593 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-13 01:37:19,594 - ERROR - Failed to retrieve data for ticker 'MCB'.
2024-10-13 01:37:19,598 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-13 01:37:20,038 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-13 01:37:20,038 - ERROR - Failed to retrieve data for ticker 'OGDC'.
2024-10-13 01:37:20,041 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-13 01:37:20,453 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-13 01:37:20,454 - ERROR - Failed to retrieve data for ticker 'PPL'.
2024-10-13 01:37:20,455 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-13 01:37:20,966 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-13 01:37:20,971 - ERROR - Failed to retrieve data for ticker 'PSO'.
2024-10-13 01:37:20,975 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-13 01:37:21,472 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-13 01:37:21,476 - ERROR - Failed to retrieve data for ticker 'PTC'.
2024-10-13 01:37:21,490 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-13 01:37:21,973 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-13 01:37:21,974 - ERROR - Failed to retrieve data for ticker 'SEARL'.
2024-10-13 01:37:21,976 - INFO - Database synchronization complete.
2024-10-13 01:37:25,326 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:25,340 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:31,069 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:31,077 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:32,317 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:32,348 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:32,750 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:32,758 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:33,230 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:33,241 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:35,007 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:35,017 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:35,020 - ERROR - Failed to create portfolio 'alpha': UNIQUE constraint failed: Portfolios.Name
2024-10-13 01:37:35,025 - ERROR - Failed to create portfolio 'alpha'.
2024-10-13 01:37:44,405 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:44,413 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:44,487 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:44,496 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:37:44,509 - INFO - Portfolio 'beta' created with stocks: FATIMA,MCB,PSO.
2024-10-13 01:37:44,525 - INFO - Portfolio 'beta' created with tickers: ['FATIMA', 'MCB', 'PSO'].
2024-10-13 01:37:57,889 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:37:57,895 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:38:03,044 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:38:03,048 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:38:03,056 - INFO - Retrieved 2 portfolios from the database.
2024-10-13 01:38:03,061 - INFO - Retrieved portfolio 'alpha' with ID 1.
2024-10-13 01:38:03,064 - INFO - Selected Portfolio 'alpha' with tickers: [].
2024-10-13 01:38:06,383 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:38:06,402 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:38:06,412 - INFO - Retrieved 2 portfolios from the database.
2024-10-13 01:38:06,413 - INFO - Retrieved portfolio 'beta' with ID 2.
2024-10-13 01:38:06,461 - INFO - Selected Portfolio 'beta' with tickers: [].
2024-10-13 01:38:11,734 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:38:11,747 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:38:11,850 - INFO - Retrieved 2 portfolios from the database.
2024-10-13 01:38:11,952 - INFO - Retrieved portfolio 'alpha' with ID 1.
2024-10-13 01:38:12,004 - INFO - Selected Portfolio 'alpha' with tickers: [].
2024-10-13 01:38:18,840 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:38:18,846 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:50:20,317 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:50:28,288 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:50:28,293 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:50:28,296 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-13 01:50:28,790 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-13 01:50:28,792 - ERROR - Failed to retrieve data for ticker 'ABL'.
2024-10-13 01:50:28,793 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-13 01:50:29,235 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-13 01:50:29,237 - ERROR - Failed to retrieve data for ticker 'AIRLINK'.
2024-10-13 01:50:29,238 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-13 01:50:29,680 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-13 01:50:29,681 - ERROR - Failed to retrieve data for ticker 'FATIMA'.
2024-10-13 01:50:29,682 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-13 01:50:30,113 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-13 01:50:30,114 - ERROR - Failed to retrieve data for ticker 'HUBC'.
2024-10-13 01:50:30,115 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-13 01:50:30,553 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-13 01:50:30,555 - ERROR - Failed to retrieve data for ticker 'MCB'.
2024-10-13 01:50:30,558 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-13 01:50:31,011 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-13 01:50:31,013 - ERROR - Failed to retrieve data for ticker 'OGDC'.
2024-10-13 01:50:31,015 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-13 01:50:31,500 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-13 01:50:31,502 - ERROR - Failed to retrieve data for ticker 'PPL'.
2024-10-13 01:50:31,505 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-13 01:50:31,983 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-13 01:50:31,984 - ERROR - Failed to retrieve data for ticker 'PSO'.
2024-10-13 01:50:31,988 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-13 01:50:32,771 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-13 01:50:32,772 - ERROR - Failed to retrieve data for ticker 'PTC'.
2024-10-13 01:50:32,773 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-13 01:50:33,224 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-13 01:50:33,225 - ERROR - Failed to retrieve data for ticker 'SEARL'.
2024-10-13 01:50:33,227 - INFO - Database synchronization complete.
2024-10-13 01:50:38,478 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:50:38,801 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:50:41,450 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:50:41,453 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:50:42,454 - INFO - Analysis for ticker 'ABL' completed successfully.
2024-10-13 01:50:42,501 - INFO - Analysis for ticker 'AIRLINK' completed successfully.
2024-10-13 01:50:42,552 - INFO - Analysis for ticker 'FATIMA' completed successfully.
2024-10-13 01:50:42,619 - INFO - Analysis for ticker 'HUBC' completed successfully.
2024-10-13 01:50:42,659 - INFO - Analysis for ticker 'MCB' completed successfully.
2024-10-13 01:50:42,705 - INFO - Analysis for ticker 'OGDC' completed successfully.
2024-10-13 01:50:42,752 - INFO - Analysis for ticker 'PPL' completed successfully.
2024-10-13 01:50:42,791 - INFO - Analysis for ticker 'PSO' completed successfully.
2024-10-13 01:50:42,836 - INFO - Analysis for ticker 'PTC' completed successfully.
2024-10-13 01:50:42,880 - INFO - Analysis for ticker 'SEARL' completed successfully.
2024-10-13 01:50:52,376 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:34,569 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:34,692 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:34,699 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:51:35,490 - INFO - Retrieved 1182 records for ticker 'HUMNL'.
2024-10-13 01:51:35,518 - INFO - Prepared 1182 valid records for insertion for ticker 'HUMNL'.
2024-10-13 01:51:35,518 - INFO - Inserting batch 1 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,527 - INFO - Batch 1 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,529 - INFO - Inserting batch 2 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,534 - INFO - Batch 2 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,534 - INFO - Inserting batch 3 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,538 - INFO - Batch 3 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,552 - INFO - Inserting batch 4 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,561 - INFO - Batch 4 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,565 - INFO - Inserting batch 5 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,568 - INFO - Batch 5 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,576 - INFO - Inserting batch 6 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,579 - INFO - Batch 6 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,581 - INFO - Inserting batch 7 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,584 - INFO - Batch 7 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,585 - INFO - Inserting batch 8 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,591 - INFO - Batch 8 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,598 - INFO - Inserting batch 9 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,602 - INFO - Batch 9 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,608 - INFO - Inserting batch 10 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,614 - INFO - Batch 10 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,616 - INFO - Inserting batch 11 for ticker 'HUMNL' with 100 records.
2024-10-13 01:51:35,620 - INFO - Batch 11 inserted 100 records (may include ignored records).
2024-10-13 01:51:35,625 - INFO - Inserting batch 12 for ticker 'HUMNL' with 82 records.
2024-10-13 01:51:35,629 - INFO - Batch 12 inserted 82 records (may include ignored records).
2024-10-13 01:51:35,630 - INFO - Added 1182 records for ticker 'HUMNL'.
2024-10-13 01:51:35,631 - INFO - Total records in the database for ticker 'HUMNL': 1182
2024-10-13 01:51:35,633 - INFO - Added 1182 records for ticker 'HUMNL'.
2024-10-13 01:51:42,659 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:42,673 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:51:44,385 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-13 01:51:44,389 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-13 01:51:44,436 - INFO - Analysis for ticker 'ABL' completed successfully.
2024-10-13 01:51:44,501 - INFO - Analysis for ticker 'AIRLINK' completed successfully.
2024-10-13 01:51:44,588 - INFO - Analysis for ticker 'FATIMA' completed successfully.
2024-10-13 01:51:44,637 - INFO - Analysis for ticker 'HUBC' completed successfully.
2024-10-13 01:51:44,703 - INFO - Analysis for ticker 'HUMNL' completed successfully.
2024-10-13 01:51:44,772 - INFO - Analysis for ticker 'MCB' completed successfully.
2024-10-13 01:51:44,820 - INFO - Analysis for ticker 'OGDC' completed successfully.
2024-10-13 01:51:44,889 - INFO - Analysis for ticker 'PPL' completed successfully.
2024-10-13 01:51:44,938 - INFO - Analysis for ticker 'PSO' completed successfully.
2024-10-13 01:51:44,982 - INFO - Analysis for ticker 'PTC' completed successfully.
2024-10-13 01:51:45,033 - INFO - Analysis for ticker 'SEARL' completed successfully.
2024-10-14 16:54:46,029 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 16:54:50,400 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 16:54:58,808 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 16:54:58,987 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 16:55:07,065 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 16:55:25,113 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 16:55:30,988 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 16:55:34,907 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 16:55:35,108 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 16:55:38,275 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 17:01:23,897 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 17:23:29,146 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 17:23:29,701 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 17:23:31,677 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 17:23:31,698 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 17:23:32,942 - INFO - Analysis for ticker 'ABL' completed successfully.
2024-10-14 17:23:32,984 - INFO - Analysis for ticker 'AIRLINK' completed successfully.
2024-10-14 17:23:33,037 - INFO - Analysis for ticker 'FATIMA' completed successfully.
2024-10-14 17:23:33,094 - INFO - Analysis for ticker 'HUBC' completed successfully.
2024-10-14 17:23:33,141 - INFO - Analysis for ticker 'HUMNL' completed successfully.
2024-10-14 17:23:33,180 - INFO - Analysis for ticker 'MCB' completed successfully.
2024-10-14 17:23:33,222 - INFO - Analysis for ticker 'OGDC' completed successfully.
2024-10-14 17:23:33,263 - INFO - Analysis for ticker 'PPL' completed successfully.
2024-10-14 17:23:33,306 - INFO - Analysis for ticker 'PSO' completed successfully.
2024-10-14 17:23:33,352 - INFO - Analysis for ticker 'PTC' completed successfully.
2024-10-14 17:23:33,392 - INFO - Analysis for ticker 'SEARL' completed successfully.
2024-10-14 17:38:14,246 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 17:42:00,084 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 17:43:28,077 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 17:43:28,095 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 17:43:28,096 - INFO - Fetching market watch data...
2024-10-14 17:43:29,678 - INFO - Retrieved 978 records from market watch.
2024-10-14 17:43:29,679 - INFO - Fetched 2 market watch records.
2024-10-14 17:43:29,680 - ERROR - An unexpected error occurred during synchronization: 'bool' object is not subscriptable
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 981, in synchronize_database
    success, records_added = insert_market_watch_data_into_db(conn)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 287, in insert_market_watch_data_into_db
    symbol = record['SYMBOL']
             ~~~~~~^^^^^^^^^^
TypeError: 'bool' object is not subscriptable
2024-10-14 17:43:29,683 - INFO - Database synchronization completed.
2024-10-14 17:49:39,356 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at data/tick_data.db.
2024-10-14 17:50:31,061 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 17:50:31,120 - INFO - Fetching market watch data...
2024-10-14 17:50:32,834 - INFO - Retrieved 978 records from market watch.
2024-10-14 17:50:32,838 - INFO - Fetched 2 market watch records.
2024-10-14 17:50:32,838 - ERROR - Exception during Market Watch synchronization: 'bool' object is not subscriptable
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 982, in synchronize_database
    success, records_added = insert_market_watch_data_into_db(conn)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 287, in insert_market_watch_data_into_db
    symbol = record['SYMBOL']
             ~~~~~~^^^^^^^^^^
TypeError: 'bool' object is not subscriptable
2024-10-14 17:50:32,840 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 17:50:32,841 - ERROR - Exception during PSX Constituents synchronization: name 'timedelta' is not defined
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 999, in synchronize_database
    date = (datetime.today() - timedelta(days=1)).strftime('%Y-%m-%d')
                               ^^^^^^^^^
NameError: name 'timedelta' is not defined
2024-10-14 17:50:32,844 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 17:50:32,845 - ERROR - Exception during PSX Transaction synchronization: name 'timedelta' is not defined
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 1019, in synchronize_database
    transaction_date = (datetime.today() - timedelta(days=1)).strftime('%Y-%m-%d')
                                           ^^^^^^^^^
NameError: name 'timedelta' is not defined
2024-10-14 17:50:32,852 - INFO - Database synchronization completed.
2024-10-14 17:53:49,692 - INFO - Database initialized with necessary tables at data/tick_data.db.
2024-10-14 17:54:33,439 - INFO - Database initialized with necessary tables at data/tick_data.db.
2024-10-14 17:54:33,456 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 17:54:33,457 - INFO - Fetching market watch data...
2024-10-14 17:54:35,769 - INFO - Retrieved 978 records from market watch.
2024-10-14 17:54:35,770 - INFO - Fetched 2 market watch records.
2024-10-14 17:54:35,770 - ERROR - Exception during Market Watch synchronization: 'bool' object is not subscriptable
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 378, in synchronize_database
    success, records_added = insert_market_watch_data_into_db(conn)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 174, in insert_market_watch_data_into_db
    symbol = record['SYMBOL']
             ~~~~~~^^^^^^^^^^
TypeError: 'bool' object is not subscriptable
2024-10-14 17:54:35,771 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 17:54:35,772 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-13.xls
2024-10-14 17:54:36,700 - ERROR - Error fetching PSX data: 404 Client Error: Not Found for url: https://dps.psx.com.pk/download/indhist/2024-10-13.xls
2024-10-14 17:54:36,706 - WARNING - No PSX Constituents data fetched.
2024-10-14 17:54:36,707 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 17:54:37,605 - ERROR - Failed to fetch CSV data: 404 Client Error: Not Found for url: https://dps.psx.com.pk/download/omts/2024-10-13.csv
2024-10-14 17:54:37,606 - WARNING - No PSX Transaction data fetched.
2024-10-14 17:54:37,607 - INFO - Database synchronization completed.
2024-10-14 18:29:32,868 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 18:29:32,869 - INFO - Fetching market watch data...
2024-10-14 18:29:32,869 - ERROR - Exception during Market Watch synchronization: fetch_kse_market_watch() takes 1 positional argument but 2 were given
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 998, in synchronize_database
    success, records_added = insert_market_watch_data_into_db(conn, date)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 263, in insert_market_watch_data_into_db
    market_data = fetch_kse_market_watch(SECTOR_MAPPING, date)  # Assuming fetch_kse_market_watch accepts a date parameter
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: fetch_kse_market_watch() takes 1 positional argument but 2 were given
2024-10-14 18:29:32,872 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 18:29:32,872 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 18:29:34,829 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 18:29:34,833 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 18:29:34,834 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 18:29:35,696 - INFO - CSV data fetched successfully.
2024-10-14 18:29:35,715 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 18:29:35,726 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 18:29:35,729 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 18:29:35,736 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 18:29:35,742 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 18:29:35,743 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-14 18:29:35,743 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 18:29:35,744 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 18:29:35,744 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 18:29:35,744 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 18:29:35,744 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 18:29:35,745 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 18:29:35,746 - INFO - Database synchronization completed.
2024-10-14 18:42:19,080 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 18:42:19,085 - INFO - Fetching market watch data...
2024-10-14 18:42:19,597 - ERROR - Failed to fetch market watch data: HTTPSConnectionPool(host='api.kse.com', port=443): Max retries exceeded with url: /market_watch (Caused by SSLError(SSLError(1, '[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:1000)')))
2024-10-14 18:42:19,597 - ERROR - Failed to fetch market watch data.
2024-10-14 18:42:19,597 - ERROR - Failed to synchronize Market Watch data.
2024-10-14 18:42:19,597 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 18:42:19,598 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 18:42:21,559 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 18:42:21,560 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 18:42:21,560 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 18:42:22,912 - INFO - CSV data fetched successfully.
2024-10-14 18:42:22,934 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 18:42:22,943 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 18:42:22,943 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 18:42:22,944 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 18:42:22,951 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 18:42:22,952 - INFO - Data in 'Transactions' table after insertion (44 rows):
2024-10-14 18:42:22,952 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 18:42:22,953 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 18:42:22,955 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 18:42:22,955 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 18:42:22,956 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 18:42:22,956 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 18:42:22,958 - INFO - Database synchronization completed.
2024-10-14 18:53:54,516 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 18:53:54,518 - INFO - Fetching market watch data...
2024-10-14 18:53:54,518 - ERROR - Exception during Market Watch synchronization: fetch_kse_market_watch() missing 1 required positional argument: 'SECTOR_MAPPING'
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 991, in synchronize_database
    success, records_added = insert_market_watch_data_into_db(conn)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 256, in insert_market_watch_data_into_db
    market_data = fetch_kse_market_watch()  # Assuming fetch_kse_market_watch accepts a date parameter
                  ^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: fetch_kse_market_watch() missing 1 required positional argument: 'SECTOR_MAPPING'
2024-10-14 18:53:54,521 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 18:53:54,521 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 18:53:56,618 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 18:53:56,620 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 18:53:56,621 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 18:53:57,592 - INFO - CSV data fetched successfully.
2024-10-14 18:53:57,612 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 18:53:57,619 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 18:53:57,623 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 18:53:57,623 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 18:53:57,624 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 18:53:57,625 - INFO - Data in 'Transactions' table after insertion (55 rows):
2024-10-14 18:53:57,626 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 18:53:57,626 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 18:53:57,627 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 18:53:57,628 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 18:53:57,628 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 18:53:57,628 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 18:53:57,629 - INFO - Database synchronization completed.
2024-10-14 18:57:28,960 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 18:57:28,961 - INFO - Fetching market watch data...
2024-10-14 18:57:30,887 - INFO - Fetched and processed 443 market watch records.
2024-10-14 18:57:30,888 - INFO - Fetched 443 market watch records.
2024-10-14 18:57:30,891 - INFO - Inserting batch 1 with 100 records.
2024-10-14 18:57:30,903 - INFO - Inserting batch 2 with 100 records.
2024-10-14 18:57:30,908 - INFO - Inserting batch 3 with 100 records.
2024-10-14 18:57:30,919 - INFO - Inserting batch 4 with 100 records.
2024-10-14 18:57:30,927 - INFO - Inserting batch 5 with 43 records.
2024-10-14 18:57:30,932 - INFO - Successfully inserted/updated 443 records for market watch data.
2024-10-14 18:57:30,957 - INFO - Total records in the MarketWatch table: 443
2024-10-14 18:57:30,961 - INFO - Successfully synchronized Market Watch data with 443 records added/updated.
2024-10-14 18:57:30,962 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 18:57:30,962 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 18:57:32,724 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 18:57:32,724 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 18:57:32,725 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 18:57:33,653 - INFO - CSV data fetched successfully.
2024-10-14 18:57:33,677 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 18:57:33,687 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 18:57:33,688 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 18:57:33,689 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 18:57:33,689 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 18:57:33,689 - INFO - Data in 'Transactions' table after insertion (66 rows):
2024-10-14 18:57:33,690 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 18:57:33,690 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 18:57:33,691 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 18:57:33,691 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 18:57:33,691 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 18:57:33,691 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 18:57:33,693 - INFO - Database synchronization completed.
2024-10-14 19:01:44,622 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 19:14:26,564 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 19:14:26,566 - INFO - Fetching market watch data...
2024-10-14 19:14:28,094 - INFO - Fetched and processed 443 market watch records.
2024-10-14 19:14:28,096 - INFO - Fetched 443 market watch records.
2024-10-14 19:14:28,101 - INFO - Inserting batch 1 with 100 records.
2024-10-14 19:14:28,110 - INFO - Inserting batch 2 with 100 records.
2024-10-14 19:14:28,121 - INFO - Inserting batch 3 with 100 records.
2024-10-14 19:14:28,136 - INFO - Inserting batch 4 with 100 records.
2024-10-14 19:14:28,145 - INFO - Inserting batch 5 with 100 records.
2024-10-14 19:14:28,154 - INFO - Inserting batch 6 with 100 records.
2024-10-14 19:14:28,165 - INFO - Inserting batch 7 with 100 records.
2024-10-14 19:14:28,177 - INFO - Inserting batch 8 with 100 records.
2024-10-14 19:14:28,191 - INFO - Inserting batch 9 with 100 records.
2024-10-14 19:14:28,201 - INFO - Inserting batch 10 with 71 records.
2024-10-14 19:14:28,214 - INFO - Successfully inserted/updated 971 records for market watch data.
2024-10-14 19:14:28,215 - INFO - Total records in the MarketWatch table: 1248
2024-10-14 19:14:28,217 - INFO - Successfully synchronized Market Watch data with 971 records added/updated.
2024-10-14 19:14:28,218 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 19:14:28,222 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 19:14:29,799 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 19:14:29,799 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 19:14:29,800 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 19:14:30,578 - INFO - CSV data fetched successfully.
2024-10-14 19:14:30,598 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 19:14:30,607 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 19:14:30,610 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 19:14:30,611 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 19:14:30,611 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 19:14:30,612 - INFO - Data in 'Transactions' table after insertion (77 rows):
2024-10-14 19:14:30,612 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 19:14:30,613 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 19:14:30,613 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 19:14:30,613 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 19:14:30,613 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 19:14:30,614 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 19:14:30,615 - INFO - Database synchronization completed.
2024-10-14 19:23:42,078 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 19:23:42,080 - INFO - Deleting previous MarketWatch data...
2024-10-14 19:23:42,086 - INFO - Previous MarketWatch data deleted.
2024-10-14 19:23:42,093 - INFO - Fetching market watch data...
2024-10-14 19:23:43,671 - INFO - Fetched and processed 443 market watch records.
2024-10-14 19:23:43,672 - INFO - Fetched 443 market watch records.
2024-10-14 19:23:43,675 - INFO - Inserting batch 1 with 100 records.
2024-10-14 19:23:43,683 - INFO - Inserting batch 2 with 100 records.
2024-10-14 19:23:43,718 - INFO - Inserting batch 3 with 100 records.
2024-10-14 19:23:43,732 - INFO - Inserting batch 4 with 100 records.
2024-10-14 19:23:43,769 - INFO - Inserting batch 5 with 100 records.
2024-10-14 19:23:43,803 - INFO - Inserting batch 6 with 100 records.
2024-10-14 19:23:43,821 - INFO - Inserting batch 7 with 100 records.
2024-10-14 19:23:43,842 - INFO - Inserting batch 8 with 100 records.
2024-10-14 19:23:43,868 - INFO - Inserting batch 9 with 100 records.
2024-10-14 19:23:43,932 - INFO - Inserting batch 10 with 71 records.
2024-10-14 19:23:43,968 - INFO - Successfully inserted/updated 971 records for market watch data.
2024-10-14 19:23:43,975 - INFO - Total records in the MarketWatch table: 971
2024-10-14 19:23:43,982 - INFO - Successfully synchronized Market Watch data with 971 records added/updated.
2024-10-14 19:23:43,984 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 19:23:43,984 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 19:23:48,403 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 19:23:48,758 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 19:23:48,800 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 19:23:49,699 - INFO - CSV data fetched successfully.
2024-10-14 19:23:49,784 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 19:23:49,829 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 19:23:49,901 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 19:23:50,006 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 19:23:50,080 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 19:23:50,118 - INFO - Data in 'Transactions' table after insertion (88 rows):
2024-10-14 19:23:50,137 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 19:23:50,153 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 19:23:50,176 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 19:23:50,189 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 19:23:50,208 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 19:23:50,214 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 19:23:50,228 - INFO - Database synchronization completed.
2024-10-14 19:49:29,112 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 19:49:29,113 - INFO - Deleting previous MarketWatch data...
2024-10-14 19:49:29,125 - INFO - Previous MarketWatch data deleted.
2024-10-14 19:49:29,144 - INFO - Fetching market watch data...
2024-10-14 19:49:31,525 - INFO - Fetched and processed 443 market watch records.
2024-10-14 19:49:31,526 - INFO - Fetched 443 market watch records.
2024-10-14 19:49:31,526 - INFO - Fetching defaulters data...
2024-10-14 19:49:32,709 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 19:49:32,713 - INFO - Inserting batch 1 with 100 records.
2024-10-14 19:49:32,718 - INFO - Inserting batch 2 with 100 records.
2024-10-14 19:49:32,725 - INFO - Inserting batch 3 with 100 records.
2024-10-14 19:49:32,751 - INFO - Inserting batch 4 with 100 records.
2024-10-14 19:49:32,812 - INFO - Inserting batch 5 with 100 records.
2024-10-14 19:49:32,819 - INFO - Inserting batch 6 with 100 records.
2024-10-14 19:49:32,831 - INFO - Inserting batch 7 with 100 records.
2024-10-14 19:49:32,846 - INFO - Inserting batch 8 with 100 records.
2024-10-14 19:49:32,860 - INFO - Inserting batch 9 with 100 records.
2024-10-14 19:49:32,869 - INFO - Inserting batch 10 with 71 records.
2024-10-14 19:49:32,878 - INFO - Successfully inserted/updated 971 records for market watch data.
2024-10-14 19:49:32,879 - INFO - Total records in the MarketWatch table: 971
2024-10-14 19:49:32,880 - INFO - Successfully synchronized Market Watch data with 971 records added/updated.
2024-10-14 19:49:32,880 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 19:49:32,880 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 19:49:34,436 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 19:49:34,436 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 19:49:34,436 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 19:49:35,259 - INFO - CSV data fetched successfully.
2024-10-14 19:49:35,283 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 19:49:35,292 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 19:49:35,294 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 19:49:35,295 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 19:49:35,295 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 19:49:35,297 - INFO - Data in 'Transactions' table after insertion (99 rows):
2024-10-14 19:49:35,298 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 19:49:35,298 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 19:49:35,299 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 19:49:35,299 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 19:49:35,299 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 19:49:35,300 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 19:49:35,301 - INFO - Database synchronization completed.
2024-10-14 19:56:58,233 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 19:56:59,077 - INFO - Retrieved 789 records for ticker 'JUBS'.
2024-10-14 19:56:59,101 - INFO - Prepared 786 valid records for insertion for ticker 'JUBS'.
2024-10-14 19:56:59,102 - INFO - Inserting batch 1 for ticker 'JUBS' with 100 records.
2024-10-14 19:56:59,112 - INFO - Batch 1 inserted 100 records (may include ignored records).
2024-10-14 19:56:59,130 - INFO - Inserting batch 2 for ticker 'JUBS' with 100 records.
2024-10-14 19:56:59,137 - INFO - Batch 2 inserted 100 records (may include ignored records).
2024-10-14 19:56:59,146 - INFO - Inserting batch 3 for ticker 'JUBS' with 100 records.
2024-10-14 19:56:59,158 - INFO - Batch 3 inserted 100 records (may include ignored records).
2024-10-14 19:56:59,163 - INFO - Inserting batch 4 for ticker 'JUBS' with 100 records.
2024-10-14 19:56:59,169 - INFO - Batch 4 inserted 100 records (may include ignored records).
2024-10-14 19:56:59,185 - INFO - Inserting batch 5 for ticker 'JUBS' with 100 records.
2024-10-14 19:56:59,194 - INFO - Batch 5 inserted 100 records (may include ignored records).
2024-10-14 19:56:59,213 - INFO - Inserting batch 6 for ticker 'JUBS' with 100 records.
2024-10-14 19:56:59,219 - INFO - Batch 6 inserted 100 records (may include ignored records).
2024-10-14 19:56:59,225 - INFO - Inserting batch 7 for ticker 'JUBS' with 100 records.
2024-10-14 19:56:59,230 - INFO - Batch 7 inserted 100 records (may include ignored records).
2024-10-14 19:56:59,232 - INFO - Inserting batch 8 for ticker 'JUBS' with 86 records.
2024-10-14 19:56:59,236 - INFO - Batch 8 inserted 86 records (may include ignored records).
2024-10-14 19:56:59,242 - INFO - Added 786 records for ticker 'JUBS'.
2024-10-14 19:56:59,242 - INFO - Total records in the database for ticker 'JUBS': 786
2024-10-14 19:56:59,245 - INFO - Added 786 records for ticker 'JUBS'.
2024-10-14 19:57:15,671 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'JUBS', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 19:57:21,332 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'JUBS', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 19:57:22,371 - INFO - Analysis for ticker 'ABL' completed successfully.
2024-10-14 19:57:22,414 - INFO - Analysis for ticker 'AIRLINK' completed successfully.
2024-10-14 19:57:22,489 - INFO - Analysis for ticker 'FATIMA' completed successfully.
2024-10-14 19:57:22,535 - INFO - Analysis for ticker 'HUBC' completed successfully.
2024-10-14 19:57:22,578 - INFO - Analysis for ticker 'HUMNL' completed successfully.
2024-10-14 19:57:22,627 - INFO - Analysis for ticker 'JUBS' completed successfully.
2024-10-14 19:57:22,665 - INFO - Analysis for ticker 'MCB' completed successfully.
2024-10-14 19:57:22,702 - INFO - Analysis for ticker 'OGDC' completed successfully.
2024-10-14 19:57:22,769 - INFO - Analysis for ticker 'PPL' completed successfully.
2024-10-14 19:57:22,853 - INFO - Analysis for ticker 'PSO' completed successfully.
2024-10-14 19:57:22,906 - INFO - Analysis for ticker 'PTC' completed successfully.
2024-10-14 19:57:22,953 - INFO - Analysis for ticker 'SEARL' completed successfully.
2024-10-14 20:09:11,443 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 20:09:11,499 - ERROR - Exception during Market Watch synchronization: insert_market_watch_data_into_db() missing 1 required positional argument: 'date'
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 1037, in synchronize_database
    success, records_added = insert_market_watch_data_into_db(conn)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: insert_market_watch_data_into_db() missing 1 required positional argument: 'date'
2024-10-14 20:09:11,555 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 20:09:11,635 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 20:09:13,766 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 20:09:13,842 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 20:09:13,887 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 20:09:14,816 - INFO - CSV data fetched successfully.
2024-10-14 20:09:14,909 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 20:09:14,969 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 20:09:15,022 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 20:09:15,067 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 20:09:15,106 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 20:09:15,219 - INFO - Data in 'Transactions' table after insertion (110 rows):
2024-10-14 20:09:15,327 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 20:09:15,394 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 20:09:15,422 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 20:09:15,455 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 20:09:15,494 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 20:09:15,506 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 20:09:15,527 - INFO - Database synchronization completed.
2024-10-14 20:17:14,119 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 20:17:14,120 - INFO - Deleting previous MarketWatch data...
2024-10-14 20:17:14,142 - INFO - Previous MarketWatch data deleted.
2024-10-14 20:17:14,144 - INFO - Fetching market watch data...
2024-10-14 20:17:16,485 - INFO - Fetched and processed 443 market watch records.
2024-10-14 20:17:16,486 - INFO - Fetched 443 market watch records.
2024-10-14 20:17:16,487 - INFO - Fetching defaulters data...
2024-10-14 20:17:17,729 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 20:17:17,730 - INFO - Fetching PSX constituents data for date: 2024-10-14...
2024-10-14 20:17:17,731 - ERROR - Error fetching PSX data: name 'datetime' is not defined
2024-10-14 20:17:17,743 - INFO - Inserting batch 1 with 100 records.
2024-10-14 20:17:17,744 - ERROR - Failed to insert market watch data into database: table MarketWatch has no column named PRICE
2024-10-14 20:17:17,745 - ERROR - Failed to synchronize Market Watch data.
2024-10-14 20:17:17,745 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 20:17:17,745 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 20:17:19,357 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 20:17:19,361 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 20:17:19,361 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 20:17:19,362 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 20:17:20,138 - INFO - CSV data fetched successfully.
2024-10-14 20:17:20,161 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 20:17:20,173 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 20:17:20,175 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 20:17:20,176 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 20:17:20,177 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 20:17:20,178 - INFO - Data in 'Transactions' table after insertion (121 rows):
2024-10-14 20:17:20,180 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 20:17:20,182 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 20:17:20,182 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 20:17:20,182 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 20:17:20,183 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 20:17:20,183 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 20:17:20,185 - INFO - Database synchronization completed.
2024-10-14 20:25:33,768 - INFO - MarketWatch table dropped.
2024-10-14 20:31:03,863 - INFO - MarketWatch table dropped.
2024-10-14 20:31:03,928 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 20:31:03,932 - INFO - Deleting previous MarketWatch data...
2024-10-14 20:31:03,939 - INFO - Previous MarketWatch data deleted.
2024-10-14 20:31:03,965 - INFO - Fetching market watch data...
2024-10-14 20:31:05,605 - INFO - Fetched and processed 443 market watch records.
2024-10-14 20:31:05,607 - INFO - Fetched 443 market watch records.
2024-10-14 20:31:05,607 - INFO - Fetching defaulters data...
2024-10-14 20:31:06,618 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 20:31:06,618 - INFO - Fetching PSX constituents data for date: 2024-10-14...
2024-10-14 20:31:06,619 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-14.xls
2024-10-14 20:31:08,144 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 20:31:08,152 - INFO - Inserting batch 1 with 100 records.
2024-10-14 20:31:08,157 - INFO - Inserting batch 2 with 100 records.
2024-10-14 20:31:08,165 - INFO - Inserting batch 3 with 100 records.
2024-10-14 20:31:08,170 - INFO - Inserting batch 4 with 100 records.
2024-10-14 20:31:08,180 - INFO - Inserting batch 5 with 100 records.
2024-10-14 20:31:08,190 - INFO - Inserting batch 6 with 100 records.
2024-10-14 20:31:08,199 - INFO - Inserting batch 7 with 100 records.
2024-10-14 20:31:08,204 - INFO - Inserting batch 8 with 100 records.
2024-10-14 20:31:08,211 - INFO - Inserting batch 9 with 100 records.
2024-10-14 20:31:08,221 - INFO - Inserting batch 10 with 100 records.
2024-10-14 20:31:08,227 - INFO - Inserting batch 11 with 67 records.
2024-10-14 20:31:08,238 - INFO - Successfully inserted/updated 1067 records for market watch data.
2024-10-14 20:31:08,239 - INFO - Total records in the MarketWatch table: 1067
2024-10-14 20:31:08,239 - INFO - Successfully synchronized Market Watch data with 1067 records added/updated.
2024-10-14 20:31:08,239 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 20:31:08,242 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-11.xls
2024-10-14 20:31:10,180 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 20:31:10,184 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 20:31:10,184 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 20:31:10,185 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 20:31:10,957 - INFO - CSV data fetched successfully.
2024-10-14 20:31:10,979 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 20:31:10,988 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 20:31:10,990 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 20:31:10,990 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 20:31:10,990 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 20:31:10,991 - INFO - Data in 'Transactions' table after insertion (132 rows):
2024-10-14 20:31:10,991 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 20:31:10,992 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 20:31:10,993 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 20:31:10,993 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 20:31:10,994 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 20:31:10,994 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 20:31:10,995 - INFO - Database synchronization completed.
2024-10-14 20:31:16,556 - INFO - MarketWatch table dropped.
2024-10-14 20:31:17,697 - INFO - MarketWatch table dropped.
2024-10-14 20:31:17,724 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 20:31:17,725 - INFO - Deleting previous MarketWatch data...
2024-10-14 20:31:17,728 - INFO - Previous MarketWatch data deleted.
2024-10-14 20:31:17,733 - INFO - Fetching market watch data...
2024-10-14 20:31:19,447 - INFO - Fetched and processed 443 market watch records.
2024-10-14 20:31:19,448 - INFO - Fetched 443 market watch records.
2024-10-14 20:31:19,449 - INFO - Fetching defaulters data...
2024-10-14 20:31:20,540 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 20:31:20,541 - INFO - Fetching PSX constituents data for date: 2024-10-14...
2024-10-14 20:31:20,542 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-14.xls
2024-10-14 20:31:22,445 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 20:31:22,456 - INFO - Inserting batch 1 with 100 records.
2024-10-14 20:31:22,465 - INFO - Inserting batch 2 with 100 records.
2024-10-14 20:31:22,470 - INFO - Inserting batch 3 with 100 records.
2024-10-14 20:31:22,479 - INFO - Inserting batch 4 with 100 records.
2024-10-14 20:31:22,485 - INFO - Inserting batch 5 with 100 records.
2024-10-14 20:31:22,494 - INFO - Inserting batch 6 with 100 records.
2024-10-14 20:31:22,501 - INFO - Inserting batch 7 with 100 records.
2024-10-14 20:31:22,508 - INFO - Inserting batch 8 with 100 records.
2024-10-14 20:31:22,516 - INFO - Inserting batch 9 with 100 records.
2024-10-14 20:31:22,525 - INFO - Inserting batch 10 with 100 records.
2024-10-14 20:31:22,531 - INFO - Inserting batch 11 with 67 records.
2024-10-14 20:31:22,537 - INFO - Successfully inserted/updated 1067 records for market watch data.
2024-10-14 20:31:22,538 - INFO - Total records in the MarketWatch table: 1067
2024-10-14 20:31:22,539 - INFO - Successfully synchronized Market Watch data with 1067 records added/updated.
2024-10-14 20:31:22,539 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 20:31:22,539 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-13.xls
2024-10-14 20:31:23,438 - ERROR - Error fetching PSX data: 404 Client Error: Not Found for url: https://dps.psx.com.pk/download/indhist/2024-10-13.xls
2024-10-14 20:31:23,438 - WARNING - No PSX Constituents data fetched.
2024-10-14 20:31:23,438 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 20:31:23,439 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-13.csv
2024-10-14 20:31:24,789 - ERROR - Failed to fetch CSV data: 404 Client Error: Not Found for url: https://dps.psx.com.pk/download/omts/2024-10-13.csv
2024-10-14 20:31:24,790 - WARNING - No PSX Transaction data fetched.
2024-10-14 20:31:24,791 - INFO - Database synchronization completed.
2024-10-14 20:34:03,411 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 20:34:03,413 - INFO - Deleting previous MarketWatch data...
2024-10-14 20:34:03,418 - INFO - Previous MarketWatch data deleted.
2024-10-14 20:34:03,424 - INFO - Fetching market watch data...
2024-10-14 20:34:05,383 - INFO - Fetched and processed 443 market watch records.
2024-10-14 20:34:05,385 - INFO - Fetched 443 market watch records.
2024-10-14 20:34:05,385 - INFO - Fetching defaulters data...
2024-10-14 20:34:06,463 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 20:34:06,466 - INFO - Fetching PSX constituents data for date: 2024-10-14...
2024-10-14 20:34:06,467 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-14.xls
2024-10-14 20:34:08,024 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 20:34:08,033 - INFO - Inserting batch 1 with 100 records.
2024-10-14 20:34:08,038 - INFO - Inserting batch 2 with 100 records.
2024-10-14 20:34:08,047 - INFO - Inserting batch 3 with 100 records.
2024-10-14 20:34:08,054 - INFO - Inserting batch 4 with 100 records.
2024-10-14 20:34:08,063 - INFO - Inserting batch 5 with 100 records.
2024-10-14 20:34:08,072 - INFO - Inserting batch 6 with 100 records.
2024-10-14 20:34:08,081 - INFO - Inserting batch 7 with 100 records.
2024-10-14 20:34:08,088 - INFO - Inserting batch 8 with 100 records.
2024-10-14 20:34:08,096 - INFO - Inserting batch 9 with 100 records.
2024-10-14 20:34:08,102 - INFO - Inserting batch 10 with 100 records.
2024-10-14 20:34:08,111 - INFO - Inserting batch 11 with 67 records.
2024-10-14 20:34:08,119 - INFO - Successfully inserted/updated 1067 records for market watch data.
2024-10-14 20:34:08,121 - INFO - Total records in the MarketWatch table: 1067
2024-10-14 20:34:08,123 - INFO - Successfully synchronized Market Watch data with 1067 records added/updated.
2024-10-14 20:34:08,129 - INFO - Starting synchronization: Fetching and Inserting PSX Constituents data.
2024-10-14 20:34:08,129 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-14.xls
2024-10-14 20:34:09,943 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 20:34:09,952 - INFO - Successfully synchronized PSX Constituents data with 544 records inserted/updated.
2024-10-14 20:34:09,953 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 20:34:09,954 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-14.csv
2024-10-14 20:34:11,268 - INFO - CSV data fetched successfully.
2024-10-14 20:34:11,284 - INFO - Starting insertion of 65 records into the Transactions table.
2024-10-14 20:34:11,294 - INFO - Inserted 56 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 20:34:11,297 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 20:34:11,298 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 20:34:11,298 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 20:34:11,299 - INFO - Data in 'Transactions' table after insertion (188 rows):
2024-10-14 20:34:11,300 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 20:34:11,302 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 20:34:11,302 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 20:34:11,302 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 20:34:11,302 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 20:34:11,303 - INFO - Successfully synchronized PSX Transaction data with 65 records inserted.
2024-10-14 20:34:11,304 - INFO - Database synchronization completed.
2024-10-14 22:01:38,702 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 22:01:38,703 - INFO - Deleting previous MarketWatch data...
2024-10-14 22:01:38,719 - INFO - Previous MarketWatch data deleted.
2024-10-14 22:01:38,724 - INFO - Fetching market watch data...
2024-10-14 22:01:41,264 - INFO - Fetched and processed 443 market watch records.
2024-10-14 22:01:41,265 - INFO - Fetched 443 market watch records.
2024-10-14 22:01:41,265 - INFO - Fetching defaulters data...
2024-10-14 22:01:42,408 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 22:01:42,410 - INFO - Fetching PSX constituents data for date: 2024-10-14...
2024-10-14 22:01:42,410 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-14.xls
2024-10-14 22:01:43,876 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 22:01:43,884 - INFO - Inserting batch 1 with 100 records.
2024-10-14 22:01:43,891 - INFO - Inserting batch 2 with 100 records.
2024-10-14 22:01:43,897 - INFO - Inserting batch 3 with 100 records.
2024-10-14 22:01:43,909 - INFO - Inserting batch 4 with 100 records.
2024-10-14 22:01:43,915 - INFO - Inserting batch 5 with 100 records.
2024-10-14 22:01:43,920 - INFO - Inserting batch 6 with 100 records.
2024-10-14 22:01:43,932 - INFO - Inserting batch 7 with 100 records.
2024-10-14 22:01:43,939 - INFO - Inserting batch 8 with 100 records.
2024-10-14 22:01:43,947 - INFO - Inserting batch 9 with 100 records.
2024-10-14 22:01:43,952 - INFO - Inserting batch 10 with 100 records.
2024-10-14 22:01:43,963 - INFO - Inserting batch 11 with 67 records.
2024-10-14 22:01:43,968 - INFO - Successfully inserted/updated 1067 records for market watch data.
2024-10-14 22:01:43,973 - INFO - Total records in the MarketWatch table: 1067
2024-10-14 22:01:43,975 - INFO - Successfully synchronized Market Watch data with 1067 records added/updated.
2024-10-14 22:01:43,978 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 22:01:43,980 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 22:01:45,460 - INFO - CSV data fetched successfully.
2024-10-14 22:01:45,479 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 22:01:45,491 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 22:01:45,494 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 22:01:45,494 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 22:01:45,495 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 22:01:45,496 - INFO - Data in 'Transactions' table after insertion (199 rows):
2024-10-14 22:01:45,496 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 22:01:45,497 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 22:01:45,497 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 22:01:45,498 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 22:01:45,498 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 22:01:45,498 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 22:01:45,500 - INFO - Database synchronization completed.
2024-10-14 22:08:00,307 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 22:08:00,308 - INFO - Deleting previous MarketWatch data...
2024-10-14 22:08:00,326 - INFO - Previous MarketWatch data deleted.
2024-10-14 22:08:00,338 - INFO - Fetching market watch data...
2024-10-14 22:08:02,450 - INFO - Fetched and processed 443 market watch records.
2024-10-14 22:08:02,451 - INFO - Fetched 443 market watch records.
2024-10-14 22:08:02,451 - INFO - Fetching defaulters data...
2024-10-14 22:08:04,293 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 22:08:04,295 - INFO - Fetching PSX constituents data for date: 2024-10-14...
2024-10-14 22:08:04,296 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-14.xls
2024-10-14 22:08:06,190 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 22:08:06,199 - INFO - Inserting batch 1 with 100 records.
2024-10-14 22:08:06,208 - INFO - Inserting batch 2 with 100 records.
2024-10-14 22:08:06,215 - INFO - Inserting batch 3 with 100 records.
2024-10-14 22:08:06,293 - INFO - Inserting batch 4 with 100 records.
2024-10-14 22:08:06,309 - INFO - Inserting batch 5 with 100 records.
2024-10-14 22:08:06,332 - INFO - Inserting batch 6 with 100 records.
2024-10-14 22:08:06,357 - INFO - Inserting batch 7 with 100 records.
2024-10-14 22:08:06,390 - INFO - Inserting batch 8 with 100 records.
2024-10-14 22:08:06,412 - INFO - Inserting batch 9 with 100 records.
2024-10-14 22:08:06,425 - INFO - Inserting batch 10 with 100 records.
2024-10-14 22:08:06,450 - INFO - Inserting batch 11 with 67 records.
2024-10-14 22:08:06,489 - INFO - Successfully inserted/updated 1067 records for market watch data.
2024-10-14 22:08:06,504 - INFO - Total records in the MarketWatch table: 1067
2024-10-14 22:08:06,505 - INFO - Successfully synchronized Market Watch data with 1067 records added/updated.
2024-10-14 22:08:06,505 - INFO - Starting synchronization: Synchronizing all tickers.
2024-10-14 22:08:06,507 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'JUBS', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 22:08:06,507 - INFO - Found 12 tickers to synchronize.
2024-10-14 22:08:06,507 - INFO - Synchronizing ticker 1/12: ABL
2024-10-14 22:08:06,507 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-14 22:08:06,508 - ERROR - Exception during Ticker synchronization: name 'fetch_ticker_data' is not defined
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 1075, in synchronize_database
    new_data = fetch_ticker_data(ticker, since=latest_date)
               ^^^^^^^^^^^^^^^^^
NameError: name 'fetch_ticker_data' is not defined
2024-10-14 22:08:06,515 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 22:08:06,515 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 22:08:07,397 - INFO - CSV data fetched successfully.
2024-10-14 22:08:07,417 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 22:08:07,428 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 22:08:07,428 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 22:08:07,429 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 22:08:07,429 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 22:08:07,431 - INFO - Data in 'Transactions' table after insertion (210 rows):
2024-10-14 22:08:07,431 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 22:08:07,432 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 22:08:07,432 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 22:08:07,432 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 22:08:07,432 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 22:08:07,432 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 22:08:07,433 - INFO - Database synchronization completed.
2024-10-14 22:18:46,024 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 22:18:46,025 - INFO - Deleting previous MarketWatch data...
2024-10-14 22:18:46,038 - INFO - Previous MarketWatch data deleted.
2024-10-14 22:18:46,051 - INFO - Fetching market watch data...
2024-10-14 22:18:48,363 - INFO - Fetched and processed 443 market watch records.
2024-10-14 22:18:48,369 - INFO - Fetched 443 market watch records.
2024-10-14 22:18:48,370 - INFO - Fetching defaulters data...
2024-10-14 22:18:49,519 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 22:18:49,520 - INFO - Fetching PSX constituents data for date: 2024-10-14...
2024-10-14 22:18:49,520 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-14.xls
2024-10-14 22:18:51,272 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 22:18:51,280 - INFO - Inserting batch 1 with 100 records.
2024-10-14 22:18:51,289 - INFO - Inserting batch 2 with 100 records.
2024-10-14 22:18:51,297 - INFO - Inserting batch 3 with 100 records.
2024-10-14 22:18:51,314 - INFO - Inserting batch 4 with 100 records.
2024-10-14 22:18:51,328 - INFO - Inserting batch 5 with 100 records.
2024-10-14 22:18:51,341 - INFO - Inserting batch 6 with 100 records.
2024-10-14 22:18:51,350 - INFO - Inserting batch 7 with 100 records.
2024-10-14 22:18:51,361 - INFO - Inserting batch 8 with 100 records.
2024-10-14 22:18:51,370 - INFO - Inserting batch 9 with 100 records.
2024-10-14 22:18:51,376 - INFO - Inserting batch 10 with 100 records.
2024-10-14 22:18:51,381 - INFO - Inserting batch 11 with 67 records.
2024-10-14 22:18:51,385 - INFO - Successfully inserted/updated 1067 records for market watch data.
2024-10-14 22:18:51,389 - INFO - Total records in the MarketWatch table: 1067
2024-10-14 22:18:51,391 - INFO - Successfully synchronized Market Watch data with 1067 records added/updated.
2024-10-14 22:18:51,392 - INFO - Starting synchronization: Synchronizing all tickers.
2024-10-14 22:18:51,394 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'JUBS', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 22:18:51,394 - INFO - Found 12 tickers to synchronize.
2024-10-14 22:18:51,394 - INFO - Synchronizing ticker 1/12: ABL
2024-10-14 22:18:51,395 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-14 22:18:51,395 - ERROR - Exception during Ticker synchronization: name 'get_stock_data' is not defined
Traceback (most recent call last):
  File "D:\$REPOs\stock exchange psx\ticker_analyst\stock_analysis_app\utils\db_manager.py", line 1094, in synchronize_database
    new_data = get_stock_data(ticker, date_from_str, date_to_str)
               ^^^^^^^^^^^^^^
NameError: name 'get_stock_data' is not defined
2024-10-14 22:18:51,404 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 22:18:51,404 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 22:18:52,603 - INFO - CSV data fetched successfully.
2024-10-14 22:18:52,621 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 22:18:52,629 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 22:18:52,630 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 22:18:52,631 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 22:18:52,631 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 22:18:52,633 - INFO - Data in 'Transactions' table after insertion (221 rows):
2024-10-14 22:18:52,633 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 22:18:52,636 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 22:18:52,636 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 22:18:52,637 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 22:18:52,637 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 22:18:52,637 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 22:18:52,639 - INFO - Database synchronization completed.
2024-10-14 22:24:11,324 - INFO - Starting synchronization: Inserting/Updating Market Watch data.
2024-10-14 22:24:11,326 - INFO - Deleting previous MarketWatch data...
2024-10-14 22:24:11,343 - INFO - Previous MarketWatch data deleted.
2024-10-14 22:24:11,349 - INFO - Fetching market watch data...
2024-10-14 22:24:13,008 - INFO - Fetched and processed 443 market watch records.
2024-10-14 22:24:13,011 - INFO - Fetched 443 market watch records.
2024-10-14 22:24:13,011 - INFO - Fetching defaulters data...
2024-10-14 22:24:14,546 - INFO - Retrieved 96 records from defaulters list.
2024-10-14 22:24:14,548 - INFO - Fetching PSX constituents data for date: 2024-10-14...
2024-10-14 22:24:14,548 - INFO - Fetching PSX data from https://dps.psx.com.pk/download/indhist/2024-10-14.xls
2024-10-14 22:24:16,135 - INFO - Fetched 544 records from PSX constituents.
2024-10-14 22:24:16,142 - INFO - Inserting batch 1 with 100 records.
2024-10-14 22:24:16,149 - INFO - Inserting batch 2 with 100 records.
2024-10-14 22:24:16,157 - INFO - Inserting batch 3 with 100 records.
2024-10-14 22:24:16,160 - INFO - Inserting batch 4 with 100 records.
2024-10-14 22:24:16,166 - INFO - Inserting batch 5 with 100 records.
2024-10-14 22:24:16,175 - INFO - Inserting batch 6 with 100 records.
2024-10-14 22:24:16,180 - INFO - Inserting batch 7 with 100 records.
2024-10-14 22:24:16,185 - INFO - Inserting batch 8 with 100 records.
2024-10-14 22:24:16,193 - INFO - Inserting batch 9 with 100 records.
2024-10-14 22:24:16,202 - INFO - Inserting batch 10 with 100 records.
2024-10-14 22:24:16,214 - INFO - Inserting batch 11 with 67 records.
2024-10-14 22:24:16,228 - INFO - Successfully inserted/updated 1067 records for market watch data.
2024-10-14 22:24:16,231 - INFO - Total records in the MarketWatch table: 1067
2024-10-14 22:24:16,233 - INFO - Successfully synchronized Market Watch data with 1067 records added/updated.
2024-10-14 22:24:16,239 - INFO - Starting synchronization: Synchronizing all tickers.
2024-10-14 22:24:16,241 - INFO - Retrieved tickers from DB: ['ABL', 'AIRLINK', 'FATIMA', 'HUBC', 'HUMNL', 'JUBS', 'MCB', 'OGDC', 'PPL', 'PSO', 'PTC', 'SEARL']
2024-10-14 22:24:16,246 - INFO - Found 12 tickers to synchronize.
2024-10-14 22:24:16,248 - INFO - Synchronizing ticker 1/12: ABL
2024-10-14 22:24:16,265 - INFO - Latest date for ticker 'ABL': 2024-10-11
2024-10-14 22:24:18,562 - INFO - Retrieved 0 records for ticker 'ABL'.
2024-10-14 22:24:18,562 - INFO - No new data fetched for ticker 'ABL'.
2024-10-14 22:24:18,562 - INFO - Synchronizing ticker 2/12: AIRLINK
2024-10-14 22:24:18,564 - INFO - Latest date for ticker 'AIRLINK': 2024-10-11
2024-10-14 22:24:20,697 - INFO - Retrieved 0 records for ticker 'AIRLINK'.
2024-10-14 22:24:20,698 - INFO - No new data fetched for ticker 'AIRLINK'.
2024-10-14 22:24:20,698 - INFO - Synchronizing ticker 3/12: FATIMA
2024-10-14 22:24:20,700 - INFO - Latest date for ticker 'FATIMA': 2024-10-11
2024-10-14 22:24:22,884 - INFO - Retrieved 0 records for ticker 'FATIMA'.
2024-10-14 22:24:22,885 - INFO - No new data fetched for ticker 'FATIMA'.
2024-10-14 22:24:22,885 - INFO - Synchronizing ticker 4/12: HUBC
2024-10-14 22:24:22,887 - INFO - Latest date for ticker 'HUBC': 2024-10-11
2024-10-14 22:24:25,238 - INFO - Retrieved 0 records for ticker 'HUBC'.
2024-10-14 22:24:25,238 - INFO - No new data fetched for ticker 'HUBC'.
2024-10-14 22:24:25,239 - INFO - Synchronizing ticker 5/12: HUMNL
2024-10-14 22:24:25,240 - INFO - Latest date for ticker 'HUMNL': 2024-10-11
2024-10-14 22:24:27,351 - INFO - Retrieved 0 records for ticker 'HUMNL'.
2024-10-14 22:24:27,352 - INFO - No new data fetched for ticker 'HUMNL'.
2024-10-14 22:24:27,353 - INFO - Synchronizing ticker 6/12: JUBS
2024-10-14 22:24:27,354 - INFO - Latest date for ticker 'JUBS': 2024-10-14
2024-10-14 22:24:30,850 - INFO - Retrieved 0 records for ticker 'JUBS'.
2024-10-14 22:24:30,851 - INFO - No new data fetched for ticker 'JUBS'.
2024-10-14 22:24:30,851 - INFO - Synchronizing ticker 7/12: MCB
2024-10-14 22:24:30,852 - INFO - Latest date for ticker 'MCB': 2024-10-11
2024-10-14 22:24:39,611 - INFO - Retrieved 0 records for ticker 'MCB'.
2024-10-14 22:24:39,612 - INFO - No new data fetched for ticker 'MCB'.
2024-10-14 22:24:39,612 - INFO - Synchronizing ticker 8/12: OGDC
2024-10-14 22:24:39,613 - INFO - Latest date for ticker 'OGDC': 2024-10-11
2024-10-14 22:24:41,758 - INFO - Retrieved 0 records for ticker 'OGDC'.
2024-10-14 22:24:41,758 - INFO - No new data fetched for ticker 'OGDC'.
2024-10-14 22:24:41,758 - INFO - Synchronizing ticker 9/12: PPL
2024-10-14 22:24:41,760 - INFO - Latest date for ticker 'PPL': 2024-10-11
2024-10-14 22:24:43,637 - INFO - Retrieved 0 records for ticker 'PPL'.
2024-10-14 22:24:43,637 - INFO - No new data fetched for ticker 'PPL'.
2024-10-14 22:24:43,638 - INFO - Synchronizing ticker 10/12: PSO
2024-10-14 22:24:43,639 - INFO - Latest date for ticker 'PSO': 2024-10-11
2024-10-14 22:24:48,885 - INFO - Retrieved 0 records for ticker 'PSO'.
2024-10-14 22:24:48,885 - INFO - No new data fetched for ticker 'PSO'.
2024-10-14 22:24:48,886 - INFO - Synchronizing ticker 11/12: PTC
2024-10-14 22:24:48,887 - INFO - Latest date for ticker 'PTC': 2024-10-11
2024-10-14 22:24:50,906 - INFO - Retrieved 0 records for ticker 'PTC'.
2024-10-14 22:24:50,907 - INFO - No new data fetched for ticker 'PTC'.
2024-10-14 22:24:50,907 - INFO - Synchronizing ticker 12/12: SEARL
2024-10-14 22:24:50,908 - INFO - Latest date for ticker 'SEARL': 2024-10-11
2024-10-14 22:24:53,101 - INFO - Retrieved 0 records for ticker 'SEARL'.
2024-10-14 22:24:53,101 - INFO - No new data fetched for ticker 'SEARL'.
2024-10-14 22:24:53,101 - INFO - Starting synchronization: Fetching and Inserting PSX Transaction data.
2024-10-14 22:24:53,102 - INFO - Fetching PSX CSV data from https://dps.psx.com.pk/download/omts/2024-10-11.csv
2024-10-14 22:24:53,945 - INFO - CSV data fetched successfully.
2024-10-14 22:24:53,963 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-14 22:24:53,972 - INFO - Inserted 11 records of 'Off Market & Cross Transactions' into the database.
2024-10-14 22:24:53,974 - INFO - Fetching table structure for 'Transactions'...
2024-10-14 22:24:53,974 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-14 22:24:53,975 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-14 22:24:53,976 - INFO - Data in 'Transactions' table after insertion (232 rows):
2024-10-14 22:24:53,976 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 22:24:53,977 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-14 22:24:53,977 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-14 22:24:53,977 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-14 22:24:53,977 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-14 22:24:53,978 - INFO - Successfully synchronized PSX Transaction data with 39 records inserted.
2024-10-14 22:24:53,980 - INFO - Database synchronization completed.
