2024-10-12 19:57:39,833 - INFO - Initializing in-memory database for testing...
2024-10-12 19:57:39,835 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-12 19:57:39,836 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-12 19:57:40,769 - INFO - CSV data fetched successfully.
2024-10-12 19:57:40,787 - INFO - Inserting transaction data for 2024-10-11 into the database...
2024-10-12 19:57:40,788 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-12 19:57:40,792 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-12 19:57:40,794 - INFO - Fetching table structure for 'Transactions'...
2024-10-12 19:57:40,794 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-12 19:57:40,794 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-12 19:57:40,794 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-12 19:57:40,794 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-12 19:57:40,794 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-12 19:57:40,794 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-12 19:57:40,795 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-12 19:57:40,795 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-12 19:57:40,795 - INFO - Fetching transaction data from 2024-10-11 to 2024-10-11 from the database...
2024-10-12 19:57:40,795 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-12 19:57:40,795 - INFO - Fetching transactions for date: 2024-10-11
2024-10-12 19:57:40,795 - INFO - Retrieved 33 records from Transactions table.
2024-10-12 19:57:40,811 - INFO - Fetched Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-12 19:57:40,812 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12 from the database...
2024-10-12 19:57:40,812 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-12 19:57:40,812 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-12 19:57:40,812 - INFO - Retrieved 33 records from Transactions table.
2024-10-12 19:57:40,824 - INFO - Fetched Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-12 19:57:40,824 - INFO - Fetching market watch data...
2024-10-12 19:57:42,530 - INFO - Retrieved 960 records from market watch.
2024-10-12 19:57:42,530 - INFO - Fetched 960 market watch records.
2024-10-12 19:57:42,530 - INFO - Inserting market watch data into the database...
2024-10-12 19:57:42,540 - INFO - Prepared 960 valid records for market watch insertion.
2024-10-12 19:57:42,540 - INFO - Inserting batch 1 with 100 records.
2024-10-12 19:57:42,540 - INFO - Batch 1 inserted 100 records (may include updates).
2024-10-12 19:57:42,541 - INFO - Inserting batch 2 with 100 records.
2024-10-12 19:57:42,541 - INFO - Batch 2 inserted 100 records (may include updates).
2024-10-12 19:57:42,542 - INFO - Inserting batch 3 with 100 records.
2024-10-12 19:57:42,543 - INFO - Batch 3 inserted 100 records (may include updates).
2024-10-12 19:57:42,544 - INFO - Inserting batch 4 with 100 records.
2024-10-12 19:57:42,544 - INFO - Batch 4 inserted 100 records (may include updates).
2024-10-12 19:57:42,544 - INFO - Inserting batch 5 with 100 records.
2024-10-12 19:57:42,546 - INFO - Batch 5 inserted 100 records (may include updates).
2024-10-12 19:57:42,546 - INFO - Inserting batch 6 with 100 records.
2024-10-12 19:57:42,548 - INFO - Batch 6 inserted 100 records (may include updates).
2024-10-12 19:57:42,548 - INFO - Inserting batch 7 with 100 records.
2024-10-12 19:57:42,549 - INFO - Batch 7 inserted 100 records (may include updates).
2024-10-12 19:57:42,549 - INFO - Inserting batch 8 with 100 records.
2024-10-12 19:57:42,549 - INFO - Batch 8 inserted 100 records (may include updates).
2024-10-12 19:57:42,550 - INFO - Inserting batch 9 with 100 records.
2024-10-12 19:57:42,550 - INFO - Batch 9 inserted 100 records (may include updates).
2024-10-12 19:57:42,550 - INFO - Inserting batch 10 with 60 records.
2024-10-12 19:57:42,551 - INFO - Batch 10 inserted 60 records (may include updates).
2024-10-12 19:57:42,551 - INFO - Added 960 records for market watch data.
2024-10-12 19:57:42,566 - INFO - Total records in the MarketWatch table: 960
2024-10-12 19:57:42,581 - INFO - Successfully inserted 960 market watch records into the database.
2024-10-12 19:57:42,588 - INFO - Fetching top 10 advancers...
2024-10-12 19:57:42,589 - INFO - Top 10 Advancers:
2024-10-12 19:57:42,589 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-12 19:57:42,590 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-12 19:57:42,590 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-12 19:57:42,591 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-12 19:57:42,592 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-12 19:57:42,593 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-12 19:57:42,594 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-12 19:57:42,595 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 19:57:42,595 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 19:57:42,596 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 19:57:42,597 - INFO - --------------------------------------------------
2024-10-12 19:57:42,598 - INFO - Fetching top 10 decliners...
2024-10-12 19:57:42,599 - INFO - Top 10 Decliners:
2024-10-12 19:57:42,599 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 19:57:42,617 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 19:57:42,618 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 19:57:42,619 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-12 19:57:42,621 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-12 19:57:42,622 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 19:57:42,622 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 19:57:42,622 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 19:57:42,623 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-12 19:57:42,623 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-12 19:57:42,623 - INFO - --------------------------------------------------
2024-10-12 19:57:42,623 - INFO - Fetching top 10 most active stocks...
2024-10-12 19:57:42,624 - INFO - Top 10 Most Active Stocks:
2024-10-12 19:57:42,624 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,624 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,624 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,625 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,625 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,625 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,625 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,625 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,625 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,625 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:57:42,626 - INFO - --------------------------------------------------
2024-10-12 19:57:42,626 - INFO - Fetching listings data...
2024-10-12 19:57:44,352 - INFO - Retrieved 453 records from listings data.
2024-10-12 19:57:44,352 - INFO - Successfully retrieved 453 listings records.
2024-10-12 19:57:44,353 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-12 19:57:44,354 - INFO - --------------------------------------------------
2024-10-12 19:57:44,355 - INFO - Fetching defaulters data...
2024-10-12 19:57:45,560 - INFO - Retrieved 96 records from defaulters list.
2024-10-12 19:57:45,561 - INFO - Successfully retrieved 96 defaulters records.
2024-10-12 19:57:45,561 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-12 19:57:45,561 - INFO - --------------------------------------------------
2024-10-12 19:57:45,561 - INFO - Merging market watch, listings, and defaulters data...
2024-10-12 19:57:45,563 - INFO - Successfully merged data into 551 records.
2024-10-12 19:57:45,563 - INFO - Sample Merged Data (Defaulter Info Included): [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'UPP9', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761, 'NAME': 'The Hub Power Company Limited', 'SHARES': 1297154400, 'FREE FLOAT': 972865790, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'PTC', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'KSE100', 'LDCP': 14.52, 'OPEN': 14.75, 'HIGH': 15.97, 'LOW': 13.96, 'CURRENT': 15.7, 'CHANGE': 1.18, 'CHANGE (%)': 8.13, 'VOLUME': 51351566, 'NAME': 'Pakistan Telecommunication Company Ltd', 'SHARES': 3774000000, 'FREE FLOAT': 593190667, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'WTL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 1.2, 'OPEN': 1.21, 'HIGH': 1.21, 'LOW': 1.18, 'CURRENT': 1.18, 'CHANGE': -0.02, 'CHANGE (%)': -1.67, 'VOLUME': 45693545, 'NAME': 'Worldcall Telecom Limited', 'SHARES': 4982289186, 'FREE FLOAT': 3736716890, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'HUMNL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 12.33, 'OPEN': 12.5, 'HIGH': 13.56, 'LOW': 12.02, 'CURRENT': 13.56, 'CHANGE': 1.23, 'CHANGE (%)': 9.98, 'VOLUME': 32955417, 'NAME': 'Hum Network Limited', 'SHARES': 1134000000, 'FREE FLOAT': 567000000, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'KOSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'KSE100', 'LDCP': 8.02, 'OPEN': 8.0, 'HIGH': 8.0, 'LOW': 7.02, 'CURRENT': 7.07, 'CHANGE': -0.95, 'CHANGE (%)': -11.85, 'VOLUME': 25957843, 'NAME': 'Kohinoor Spinning Mills Limited', 'SHARES': 412106785, 'FREE FLOAT': 226658732, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}]
2024-10-12 19:57:45,564 - INFO - --------------------------------------------------
2024-10-12 19:57:45,564 - INFO - In-memory database closed after testing.
2024-10-12 19:58:29,046 - INFO - Initializing in-memory database for testing...
2024-10-12 19:58:29,048 - INFO - Database initialized with Ticker and MarketWatch and Transactions table tables at :memory:.
2024-10-12 19:58:29,048 - INFO - Fetching PSX transaction data for 2024-10-11...
2024-10-12 19:58:29,872 - INFO - CSV data fetched successfully.
2024-10-12 19:58:29,891 - INFO - Inserting transaction data for 2024-10-11 into the database...
2024-10-12 19:58:29,892 - INFO - Starting insertion of 39 records into the Transactions table.
2024-10-12 19:58:29,897 - INFO - Inserted 33 records of 'Off Market & Cross Transactions' into the database.
2024-10-12 19:58:29,897 - INFO - Fetching table structure for 'Transactions'...
2024-10-12 19:58:29,897 - INFO - Transactions Table Structure: [(0, 'Date', 'TEXT', 0, None, 1), (1, 'Settlement_Date', 'TEXT', 0, None, 0), (2, 'Buyer_Code', 'TEXT', 0, None, 3), (3, 'Seller_Code', 'TEXT', 0, None, 4), (4, 'Symbol_Code', 'TEXT', 0, None, 2), (5, 'Company', 'TEXT', 0, None, 0), (6, 'Turnover', 'INTEGER', 0, None, 0), (7, 'Rate', 'REAL', 0, None, 0), (8, 'Value', 'REAL', 0, None, 0), (9, 'Transaction_Type', 'TEXT', 0, None, 0)]
2024-10-12 19:58:29,897 - INFO - Fetching all data from 'Transactions' table to verify insertion...
2024-10-12 19:58:29,898 - INFO - Data in 'Transactions' table after insertion (33 rows):
2024-10-12 19:58:29,898 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-12 19:58:29,898 - INFO - ('2024-10-11', '2024-10-15', None, None, 'CWSM', 'Chakwal Spinning', 5000, 40.0, 200000.0, 'B2B')
2024-10-12 19:58:29,898 - INFO - ('2024-10-11', '2024-10-14', None, None, 'JSBL', 'JS Bank Ltd', 48899000, 8.41, 411240590.0, 'B2B')
2024-10-12 19:58:29,898 - INFO - ('2024-10-11', '2024-10-15', None, None, 'NBP', 'National BankXD', 1000000, 63.0, 63000000.0, 'B2B')
2024-10-12 19:58:29,898 - INFO - ('2024-10-11', '2024-10-14', None, None, 'CWSM', 'Chakwal Spinning', 2000, 45.0, 90000.0, 'B2B')
2024-10-12 19:58:29,898 - INFO - Fetching transaction data from 2024-10-11 to 2024-10-11 from the database...
2024-10-12 19:58:29,898 - INFO - Executing query: SELECT * FROM Transactions WHERE Date = ?;
2024-10-12 19:58:29,898 - INFO - Fetching transactions for date: 2024-10-11
2024-10-12 19:58:29,900 - INFO - Retrieved 33 records from Transactions table.
2024-10-12 19:58:29,919 - INFO - Fetched Data for 2024-10-11:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-12 19:58:29,919 - INFO - Fetching transaction data from 2024-10-10 to 2024-10-12 from the database...
2024-10-12 19:58:29,919 - INFO - Executing query: SELECT * FROM Transactions WHERE Date BETWEEN ? AND ?;
2024-10-12 19:58:29,919 - INFO - Fetching transactions from 2024-10-10 to 2024-10-12
2024-10-12 19:58:29,919 - INFO - Retrieved 33 records from Transactions table.
2024-10-12 19:58:29,939 - INFO - Fetched Data from 2024-10-10 to 2024-10-12:
         Date Settlement_Date Buyer_Code  ...    Rate      Value Transaction_Type
0  2024-10-11      2024-10-15        526  ...   10.50  1050000.0              I2I
1  2024-10-11      2024-10-14        006  ...  146.05  1460500.0              I2I
2  2024-10-11      2024-10-16        091  ...  143.50  7175000.0              I2I
3  2024-10-11      2024-10-11        159  ...  100.00     5000.0              I2I
4  2024-10-11      2024-10-15       None  ...   40.00   200000.0              B2B

[5 rows x 10 columns]
2024-10-12 19:58:29,939 - INFO - Fetching market watch data...
2024-10-12 19:58:32,351 - INFO - Retrieved 960 records from market watch.
2024-10-12 19:58:32,352 - INFO - Fetched 960 market watch records.
2024-10-12 19:58:32,352 - INFO - Inserting market watch data into the database...
2024-10-12 19:58:32,359 - INFO - Prepared 960 valid records for market watch insertion.
2024-10-12 19:58:32,359 - INFO - Inserting batch 1 with 100 records.
2024-10-12 19:58:32,361 - INFO - Batch 1 inserted 100 records (may include updates).
2024-10-12 19:58:32,362 - INFO - Inserting batch 2 with 100 records.
2024-10-12 19:58:32,362 - INFO - Batch 2 inserted 100 records (may include updates).
2024-10-12 19:58:32,362 - INFO - Inserting batch 3 with 100 records.
2024-10-12 19:58:32,363 - INFO - Batch 3 inserted 100 records (may include updates).
2024-10-12 19:58:32,363 - INFO - Inserting batch 4 with 100 records.
2024-10-12 19:58:32,364 - INFO - Batch 4 inserted 100 records (may include updates).
2024-10-12 19:58:32,364 - INFO - Inserting batch 5 with 100 records.
2024-10-12 19:58:32,365 - INFO - Batch 5 inserted 100 records (may include updates).
2024-10-12 19:58:32,365 - INFO - Inserting batch 6 with 100 records.
2024-10-12 19:58:32,366 - INFO - Batch 6 inserted 100 records (may include updates).
2024-10-12 19:58:32,366 - INFO - Inserting batch 7 with 100 records.
2024-10-12 19:58:32,367 - INFO - Batch 7 inserted 100 records (may include updates).
2024-10-12 19:58:32,367 - INFO - Inserting batch 8 with 100 records.
2024-10-12 19:58:32,368 - INFO - Batch 8 inserted 100 records (may include updates).
2024-10-12 19:58:32,369 - INFO - Inserting batch 9 with 100 records.
2024-10-12 19:58:32,369 - INFO - Batch 9 inserted 100 records (may include updates).
2024-10-12 19:58:32,370 - INFO - Inserting batch 10 with 60 records.
2024-10-12 19:58:32,370 - INFO - Batch 10 inserted 60 records (may include updates).
2024-10-12 19:58:32,371 - INFO - Added 960 records for market watch data.
2024-10-12 19:58:32,372 - INFO - Total records in the MarketWatch table: 960
2024-10-12 19:58:32,372 - INFO - Successfully inserted 960 market watch records into the database.
2024-10-12 19:58:32,372 - INFO - Fetching top 10 advancers...
2024-10-12 19:58:32,373 - INFO - Top 10 Advancers:
2024-10-12 19:58:32,373 - INFO - 1. {'SYMBOL': 'DWTM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 14.67, 'CURRENT': 6.88, 'VOLUME': 950826}
2024-10-12 19:58:32,374 - INFO - 2. {'SYMBOL': 'DEL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.75, 'CURRENT': 7.99, 'VOLUME': 291286}
2024-10-12 19:58:32,374 - INFO - 3. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-12 19:58:32,374 - INFO - 4. {'SYMBOL': 'FFLM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 11.6, 'CURRENT': 2.79, 'VOLUME': 1554}
2024-10-12 19:58:32,374 - INFO - 5. {'SYMBOL': 'SLL', 'SECTOR': 'LEASING COMPANIES', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.88, 'CURRENT': 2.14, 'VOLUME': 7505}
2024-10-12 19:58:32,374 - INFO - 6. {'SYMBOL': 'PKGI', 'SECTOR': 'INSURANCE', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.36, 'CURRENT': 9.69, 'VOLUME': 78982}
2024-10-12 19:58:32,375 - INFO - 7. {'SYMBOL': 'JKSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.01, 'CURRENT': 45.49, 'VOLUME': 2958}
2024-10-12 19:58:32,375 - INFO - 8. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 19:58:32,375 - INFO - 9. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 19:58:32,375 - INFO - 10. {'SYMBOL': 'ATLH', 'SECTOR': 'AUTOMOBILE ASSEMBLER', 'LISTED IN': 'KSE100', 'CHANGE (%)': 10.0, 'CURRENT': 751.93, 'VOLUME': 58921}
2024-10-12 19:58:32,375 - INFO - --------------------------------------------------
2024-10-12 19:58:32,379 - INFO - Fetching top 10 decliners...
2024-10-12 19:58:32,379 - INFO - Top 10 Decliners:
2024-10-12 19:58:32,380 - INFO - 1. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 19:58:32,380 - INFO - 2. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 19:58:32,380 - INFO - 3. {'SYMBOL': 'CNERGY', 'SECTOR': 'REFINERY', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 3.81, 'VOLUME': 11069120}
2024-10-12 19:58:32,380 - INFO - 4. {'SYMBOL': 'HIFA', 'SECTOR': 'CLOSE - END MUTUAL FUND', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 2.7, 'VOLUME': 217519}
2024-10-12 19:58:32,380 - INFO - 5. {'SYMBOL': 'OLPL', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 30.5, 'VOLUME': 193411}
2024-10-12 19:58:32,380 - INFO - 6. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 19:58:32,380 - INFO - 7. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 19:58:32,381 - INFO - 8. {'SYMBOL': 'FHAM', 'SECTOR': 'MODARABAS', 'LISTED IN': 'KSE100', 'CHANGE (%)': None, 'CURRENT': 15.2, 'VOLUME': 78224}
2024-10-12 19:58:32,381 - INFO - 9. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'ALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-12 19:58:32,381 - INFO - 10. {'SYMBOL': 'ICL', 'SECTOR': 'CHEMICAL', 'LISTED IN': 'KMIALLSHR', 'CHANGE (%)': None, 'CURRENT': 46.0, 'VOLUME': 30988}
2024-10-12 19:58:32,381 - INFO - --------------------------------------------------
2024-10-12 19:58:32,381 - INFO - Fetching top 10 most active stocks...
2024-10-12 19:58:32,382 - INFO - Top 10 Most Active Stocks:
2024-10-12 19:58:32,382 - INFO - 1. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'ALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,382 - INFO - 2. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMI30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,382 - INFO - 3. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KMIALLSHR', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,382 - INFO - 4. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE100', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,382 - INFO - 5. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'KSE30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,383 - INFO - 6. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MII30', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,383 - INFO - 7. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'MZNPI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,383 - INFO - 8. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NBPPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,383 - INFO - 9. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'NITPGI', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,383 - INFO - 10. {'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'PSXDIV20', 'VOLUME': 58159761, 'CURRENT': 106.9, 'CHANGE (%)': -5.17}
2024-10-12 19:58:32,384 - INFO - --------------------------------------------------
2024-10-12 19:58:32,384 - INFO - Fetching listings data...
2024-10-12 19:58:34,053 - INFO - Retrieved 453 records from listings data.
2024-10-12 19:58:34,058 - INFO - Successfully retrieved 453 listings records.
2024-10-12 19:58:34,060 - INFO - Sample Listings Data: [{'SYMBOL': '786', 'NAME': '786 Investments Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'CLEARING TYPE': 'NC', 'SHARES': 14973750, 'FREE FLOAT': 5240813, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AABS', 'NAME': 'Al-Abbas Sugar Mills Limited', 'SECTOR': 'SUGAR & ALLIED INDUSTRIES', 'CLEARING TYPE': 'NC', 'SHARES': 17362300, 'FREE FLOAT': 1736230, 'LISTED IN': ['ALLSHR', 'KMIALLSHR']}, {'SYMBOL': 'AATM', 'NAME': 'Ali Asghar Textile Mills Limited', 'SECTOR': 'TEXTILE SPINNING', 'CLEARING TYPE': 'NC', 'SHARES': 44426694, 'FREE FLOAT': 926222, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABL', 'NAME': 'Allied Bank Limited', 'SECTOR': 'COMMERCIAL BANKS', 'CLEARING TYPE': 'NC', 'SHARES': 1145073830, 'FREE FLOAT': 114507383, 'LISTED IN': ['ALLSHR', 'KSE100']}, {'SYMBOL': 'ABOT', 'NAME': 'Abbott Laboratories (Pakistan) Limited', 'SECTOR': 'PHARMACEUTICALS', 'CLEARING TYPE': 'NC', 'SHARES': 97900302, 'FREE FLOAT': 21098617, 'LISTED IN': ['ALLSHR', 'KMIALLSHR', 'KSE100', 'MII30']}]
2024-10-12 19:58:34,060 - INFO - --------------------------------------------------
2024-10-12 19:58:34,060 - INFO - Fetching defaulters data...
2024-10-12 19:58:34,998 - INFO - Retrieved 96 records from defaulters list.
2024-10-12 19:58:34,999 - INFO - Successfully retrieved 96 defaulters records.
2024-10-12 19:58:34,999 - INFO - Sample Defaulters Data: [{'SYMBOL': 'AAL', 'NAME': 'Agro Allianz Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(b)(c)(d)(I)', 'CLEARING TYPE': 'NC', 'SHARES': 1183200, 'FREE FLOAT': 0, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AASM', 'NAME': 'Al-Abid Silk Mills Limited', 'SECTOR': 'SYNTHETIC & RAYON', 'DEFAULTING CLAUSE': '5.11.1(b)(i)(l)(m)', 'CLEARING TYPE': 'NC', 'SHARES': 13409550, 'FREE FLOAT': 2681910, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'ABSON', 'NAME': 'Abson Industries Limited', 'SECTOR': 'PAPER, BOARD & PACKAGING', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)m', 'CLEARING TYPE': 'NC', 'SHARES': 3100000, 'FREE FLOAT': 1395000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMSL', 'NAME': 'Al-Mal Securities & Services Limited', 'SECTOR': 'INV. BANKS / INV. COS. / SECURITIES COS.', 'DEFAULTING CLAUSE': '5.11.1.(c)(d)(e)(f)l', 'CLEARING TYPE': 'NC', 'SHARES': 5000000, 'FREE FLOAT': 1250000, 'LISTED IN': ['ALLSHR']}, {'SYMBOL': 'AMTEX', 'NAME': 'Amtex Limited', 'SECTOR': 'TEXTILE SPINNING', 'DEFAULTING CLAUSE': '5.11.1.(i)', 'CLEARING TYPE': 'NC', 'SHARES': 259430134, 'FREE FLOAT': 116743560, 'LISTED IN': ['ALLSHR']}]
2024-10-12 19:58:34,999 - INFO - --------------------------------------------------
2024-10-12 19:58:34,999 - INFO - Merging market watch, listings, and defaulters data...
2024-10-12 19:58:35,000 - INFO - Successfully merged data into 551 records.
2024-10-12 19:58:35,000 - INFO - Sample Merged Data (Defaulter Info Included): [{'SYMBOL': 'HUBC', 'SECTOR': 'POWER GENERATION & DISTRIBUTION', 'LISTED IN': 'UPP9', 'LDCP': 112.73, 'OPEN': 110.0, 'HIGH': 110.57, 'LOW': 101.46, 'CURRENT': 106.9, 'CHANGE': -5.83, 'CHANGE (%)': -5.17, 'VOLUME': 58159761, 'NAME': 'The Hub Power Company Limited', 'SHARES': 1297154400, 'FREE FLOAT': 972865790, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'PTC', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'KSE100', 'LDCP': 14.52, 'OPEN': 14.75, 'HIGH': 15.97, 'LOW': 13.96, 'CURRENT': 15.7, 'CHANGE': 1.18, 'CHANGE (%)': 8.13, 'VOLUME': 51351566, 'NAME': 'Pakistan Telecommunication Company Ltd', 'SHARES': 3774000000, 'FREE FLOAT': 593190667, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'WTL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 1.2, 'OPEN': 1.21, 'HIGH': 1.21, 'LOW': 1.18, 'CURRENT': 1.18, 'CHANGE': -0.02, 'CHANGE (%)': -1.67, 'VOLUME': 45693545, 'NAME': 'Worldcall Telecom Limited', 'SHARES': 4982289186, 'FREE FLOAT': 3736716890, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'HUMNL', 'SECTOR': 'TECHNOLOGY & COMMUNICATION', 'LISTED IN': 'ALLSHR', 'LDCP': 12.33, 'OPEN': 12.5, 'HIGH': 13.56, 'LOW': 12.02, 'CURRENT': 13.56, 'CHANGE': 1.23, 'CHANGE (%)': 9.98, 'VOLUME': 32955417, 'NAME': 'Hum Network Limited', 'SHARES': 1134000000, 'FREE FLOAT': 567000000, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}, {'SYMBOL': 'KOSM', 'SECTOR': 'TEXTILE SPINNING', 'LISTED IN': 'KSE100', 'LDCP': 8.02, 'OPEN': 8.0, 'HIGH': 8.0, 'LOW': 7.02, 'CURRENT': 7.07, 'CHANGE': -0.95, 'CHANGE (%)': -11.85, 'VOLUME': 25957843, 'NAME': 'Kohinoor Spinning Mills Limited', 'SHARES': 412106785, 'FREE FLOAT': 226658732, 'DEFAULTER': False, 'DEFAULTING_CLAUSE': None}]
2024-10-12 19:58:35,001 - INFO - --------------------------------------------------
2024-10-12 19:58:35,001 - INFO - In-memory database closed after testing.
